{"version":3,"sources":["./node_modules/bcdice/lib/bcdice/game_system/BeastBindTrinity.js"],"names":["require","Opal","modules","self","top","$nesting","nil","$$$","$$","$module","module","$hash2","hash2","$truthy","truthy","$base","$parent_nesting","concat","$eval$1","def","expr","$kwargs","round_type","$ret_or_1","$$is_hash","ArgumentError","$new","$$smap","$eval","$$arity","get_singleton_class","$rb_gt","lhs","rhs","$Format_comparison_operator$1","$Format_modifier$2","$module_function","$$comparison_operator","op","$case","$to_s","$$modifier","number","$Normalize_comparison_operator$1","$Normalize_target_number$2","$$target_number","val","$to_i","$rb_minus","$klass","klass","$super","$Table_from_i18n$1","$Table_initialize$2","$Table_roll$3","$Table_choice$4","$$prototype","times","sides","name","items","defs","$$from_i18n","key","locale","table","$t","$$initialize","type","m","$freeze","$match","$raise","$$roll","bcdice","value","$roll_sum","$choice","$$choice","index","$rb_plus","$rb_times","$D66GridTable_from_i18n$1","$D66GridTable_initialize$2","$D66GridTable_roll$3","randomizer","dice1","dice2","index1","index2","$roll_once","$rb_le","$rb_ge","$rb_lt","$send2","send2","$send","send","$require","$BeastBindTrinity_initialize$1","$BeastBindTrinity_eval_game_system_specific_command$17","const_set","command","$iter","$$p","$yield","find_super_dispatcher","d66_sort_type","$BBCommand_initialize$2","$BBCommand_roll$3","$BBCommand_parse$5","$BBCommand_parse_critical$6","$BBCommand_critical_from_humanity$7","$BBCommand_parse_fumble$8","$BBCommand_roll_with_dice_pool$9","$BBCommand_command_expr$10","$BBCommand_interim_expr$11","$BBCommand_dice_status$12","$BBCommand_fumble$ques$13","$BBCommand_critical$ques$14","$BBCommand_calc_total$15","$BBCommand_result_compare$16","parse_error","dice_pool","dice_num","modify_number","critical","fumble","cmp_op","target_number","dice_total","keep_value_on_fumble","$parse","$$4","dice_list_org","dice_list_filtered","total","dice_list_org_str","sequence","$roll_with_dice_pool","dice","$$s","dice_value_lower_limit","$max","$sort","$last","$inject","$calc_total","$join","$command_expr","$interim_expr","$dice_status","$result_compare","$compact","$private","$$parse","$a","$parse_critical","$parse_fumble","$split","$to_proc","$size","$pop","$comparison_operator","$$parse_critical","humanity","atmark","atmark_value","$critical_from_humanity","$min","$$critical_from_humanity","$$parse_fumble","sharp","sharp_value","$$roll_with_dice_pool","dice_times","dice_list","$roll_barabara","$$command_expr","modifier","$modifier","$$interim_expr","$$dice_status","$$calc_total","$$result_compare","$$eval_game_system_specific_command","ret","bb","$roll_tables","$roll","$register_prefix","$keys"],"mappings":"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","file":"default~BeastBindTrinity~index.js","sourcesContent":["require('./../opal');\n\n/* Generated by Opal 1.1.1 */\nOpal.modules[\"bcdice/arithmetic_evaluator\"] = function(Opal) {\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $hash2 = Opal.hash2, $truthy = Opal.truthy;\n\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'ArithmeticEvaluator');\n\n      var $nesting = [self].concat($parent_nesting);\n\n      (function(self, $parent_nesting) {\n        var $nesting = [self].concat($parent_nesting), $eval$1;\n\n        return (Opal.def(self, '$eval', $eval$1 = function(expr, $kwargs) {\n          var round_type, self = this, $ret_or_1 = nil;\n\n          \n          \n          if ($kwargs == null) {\n            $kwargs = $hash2([], {});\n          } else if (!$kwargs.$$is_hash) {\n            throw Opal.ArgumentError.$new('expected kwargs');\n          };\n          \n          round_type = $kwargs.$$smap[\"round_type\"];\n          if (round_type == null) {\n            round_type = $$$($$($nesting, 'RoundType'), 'FLOOR')\n          };\n          if ($truthy(expr)) {\n          } else {\n            return 0\n          };\n          if ($truthy(($ret_or_1 = $$($nesting, 'Arithmetic').$eval(expr, round_type)))) {\n            return $ret_or_1\n          } else {\n            return 0\n          };\n        }, $eval$1.$$arity = -2), nil) && 'eval'\n      })(Opal.get_singleton_class(self), $nesting)\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting)\n};\n\n/* Generated by Opal 1.1.1 */\nOpal.modules[\"bcdice/format\"] = function(Opal) {\n  function $rb_gt(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);\n  }\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $truthy = Opal.truthy;\n\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'Format');\n\n      var $nesting = [self].concat($parent_nesting), $Format_comparison_operator$1, $Format_modifier$2;\n\n      \n      self.$module_function();\n      \n      Opal.def(self, '$comparison_operator', $Format_comparison_operator$1 = function $$comparison_operator(op) {\n        var self = this, $case = nil;\n\n        return (function() {$case = op;\n        if (\"==\"['$===']($case)) {return \"=\"}\n        else if (\"!=\"['$===']($case)) {return \"<>\"}\n        else if ($$($nesting, 'Symbol')['$===']($case)) {return op.$to_s()}\n        else { return nil }})()\n      }, $Format_comparison_operator$1.$$arity = 1);\n      \n      Opal.def(self, '$modifier', $Format_modifier$2 = function $$modifier(number) {\n        var self = this;\n\n        if ($truthy(number['$nil?']())) {\n          return nil\n        } else if (number['$=='](0)) {\n          return \"\"\n        } else if ($truthy($rb_gt(number, 0))) {\n          return \"\" + \"+\" + (number)\n        } else {\n          return number.$to_s()\n        }\n      }, $Format_modifier$2.$$arity = 1);\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting)\n};\n\n/* Generated by Opal 1.1.1 */\nOpal.modules[\"bcdice/normalize\"] = function(Opal) {\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module;\n\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'Normalize');\n\n      var $nesting = [self].concat($parent_nesting), $Normalize_comparison_operator$1, $Normalize_target_number$2;\n\n      \n      self.$module_function();\n      \n      Opal.def(self, '$comparison_operator', $Normalize_comparison_operator$1 = function $$comparison_operator(op) {\n        var self = this, $case = nil;\n\n        return (function() {$case = op;\n        if (/<=|=</['$===']($case)) {return \"<=\"}\n        else if (/>=|=>/['$===']($case)) {return \">=\"}\n        else if (/<>|!=|=!/['$===']($case)) {return \"!=\"}\n        else if (/</['$===']($case)) {return \"<\"}\n        else if (/>/['$===']($case)) {return \">\"}\n        else if (/=/['$===']($case)) {return \"==\"}\n        else { return nil }})()\n      }, $Normalize_comparison_operator$1.$$arity = 1);\n      \n      Opal.def(self, '$target_number', $Normalize_target_number$2 = function $$target_number(val) {\n        var self = this;\n\n        if (val['$=='](\"?\")) {\n          return val\n        } else {\n          return val.$to_i()\n        }\n      }, $Normalize_target_number$2.$$arity = 1);\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting)\n};\n\n/* Generated by Opal 1.1.1 */\nOpal.modules[\"bcdice/dice_table/table\"] = function(Opal) {\n  function $rb_minus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);\n  }\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2, $truthy = Opal.truthy;\n\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'DiceTable');\n\n      var $nesting = [self].concat($parent_nesting);\n\n      (function($base, $super, $parent_nesting) {\n        var self = $klass($base, $super, 'Table');\n\n        var $nesting = [self].concat($parent_nesting), $Table_from_i18n$1, $Table_initialize$2, $Table_roll$3, $Table_choice$4;\n\n        self.$$prototype.times = self.$$prototype.sides = self.$$prototype.name = self.$$prototype.items = nil;\n        \n        Opal.defs(self, '$from_i18n', $Table_from_i18n$1 = function $$from_i18n(key, locale) {\n          var self = this, table = nil;\n\n          \n          table = $$($nesting, 'I18n').$t(key, $hash2([\"locale\"], {\"locale\": locale}));\n          return self.$new(table['$[]'](\"name\"), table['$[]'](\"type\"), table['$[]'](\"items\"));\n        }, $Table_from_i18n$1.$$arity = 2);\n        \n        Opal.def(self, '$initialize', $Table_initialize$2 = function $$initialize(name, type, items) {\n          var self = this, m = nil;\n\n          \n          self.name = name;\n          self.items = items.$freeze();\n          m = /(\\d+)D(\\d+)/i.$match(type);\n          if ($truthy(m)) {\n          } else {\n            self.$raise($$($nesting, 'ArgumentError'), \"\" + \"Unexpected table type: \" + (type))\n          };\n          self.times = m['$[]'](1).$to_i();\n          return (self.sides = m['$[]'](2).$to_i());\n        }, $Table_initialize$2.$$arity = 3);\n        \n        Opal.def(self, '$roll', $Table_roll$3 = function $$roll(bcdice) {\n          var self = this, value = nil;\n\n          \n          value = bcdice.$roll_sum(self.times, self.sides);\n          return self.$choice(value);\n        }, $Table_roll$3.$$arity = 1);\n        return (Opal.def(self, '$choice', $Table_choice$4 = function $$choice(value) {\n          var self = this, index = nil;\n\n          \n          index = $rb_minus(value, self.times);\n          return $$($nesting, 'RollResult').$new(self.name, value, self.items['$[]'](index));\n        }, $Table_choice$4.$$arity = 1), nil) && 'choice';\n      })($nesting[0], null, $nesting)\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting)\n};\n\n/* Generated by Opal 1.1.1 */\nOpal.modules[\"bcdice/dice_table/d66_grid_table\"] = function(Opal) {\n  function $rb_plus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);\n  }\n  function $rb_times(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs * rhs : lhs['$*'](rhs);\n  }\n  function $rb_minus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);\n  }\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2;\n\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'DiceTable');\n\n      var $nesting = [self].concat($parent_nesting);\n\n      (function($base, $super, $parent_nesting) {\n        var self = $klass($base, $super, 'D66GridTable');\n\n        var $nesting = [self].concat($parent_nesting), $D66GridTable_from_i18n$1, $D66GridTable_initialize$2, $D66GridTable_roll$3;\n\n        self.$$prototype.name = self.$$prototype.items = nil;\n        \n        Opal.defs(self, '$from_i18n', $D66GridTable_from_i18n$1 = function $$from_i18n(key, locale) {\n          var self = this, table = nil;\n\n          \n          table = $$($nesting, 'I18n').$t(key, $hash2([\"locale\", \"raise\"], {\"locale\": locale, \"raise\": true}));\n          return self.$new(table['$[]'](\"name\"), table['$[]'](\"items\"));\n        }, $D66GridTable_from_i18n$1.$$arity = 2);\n        \n        Opal.def(self, '$initialize', $D66GridTable_initialize$2 = function $$initialize(name, items) {\n          var self = this;\n\n          \n          self.name = name;\n          return (self.items = items.$freeze());\n        }, $D66GridTable_initialize$2.$$arity = 2);\n        return (Opal.def(self, '$roll', $D66GridTable_roll$3 = function $$roll(randomizer) {\n          var self = this, dice1 = nil, dice2 = nil, value = nil, index1 = nil, index2 = nil;\n\n          \n          dice1 = randomizer.$roll_once(6);\n          dice2 = randomizer.$roll_once(6);\n          value = $rb_plus($rb_times(dice1, 10), dice2);\n          index1 = $rb_minus(dice1, 1);\n          index2 = $rb_minus(dice2, 1);\n          return $$($nesting, 'RollResult').$new(self.name, value, self.items['$[]'](index1)['$[]'](index2));\n        }, $D66GridTable_roll$3.$$arity = 1), nil) && 'roll';\n      })($nesting[0], null, $nesting)\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting)\n};\n\n/* Generated by Opal 1.1.1 */\n(function(Opal) {\n  function $rb_gt(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);\n  }\n  function $rb_minus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);\n  }\n  function $rb_plus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);\n  }\n  function $rb_le(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs <= rhs : lhs['$<='](rhs);\n  }\n  function $rb_ge(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs >= rhs : lhs['$>='](rhs);\n  }\n  function $rb_lt(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);\n  }\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $klass = Opal.klass, $send2 = Opal.send2, $truthy = Opal.truthy, $send = Opal.send, $hash2 = Opal.hash2;\n\n  \n  self.$require(\"bcdice/arithmetic_evaluator\");\n  self.$require(\"bcdice/format\");\n  self.$require(\"bcdice/normalize\");\n  self.$require(\"bcdice/dice_table/table\");\n  self.$require(\"bcdice/dice_table/d66_grid_table\");\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'GameSystem');\n\n      var $nesting = [self].concat($parent_nesting);\n\n      (function($base, $super, $parent_nesting) {\n        var self = $klass($base, $super, 'BeastBindTrinity');\n\n        var $nesting = [self].concat($parent_nesting), $BeastBindTrinity_initialize$1, $BeastBindTrinity_eval_game_system_specific_command$17;\n\n        self.$$prototype.randomizer = nil;\n        \n        Opal.const_set($nesting[0], 'ID', \"BeastBindTrinity\");\n        Opal.const_set($nesting[0], 'NAME', \"ビーストバインド トリニティ\");\n        Opal.const_set($nesting[0], 'SORT_KEY', \"ひいすとはいんととりにてい\");\n        Opal.const_set($nesting[0], 'HELP_MESSAGE', \"\" + \"・判定　(nBB+m%w@x#y$z&v)\\n\" + \"　n個のD6を振り、出目の大きい2個から達成値を算出。修正mも可能。\\n\" + \"\\n\" + \"　%w、@x、#y、$z、&vはすべて省略可能。\\n\" + \"＞%w：現在の人間性が w であるとして、クリティカル値(C値)を計算。\\n\" + \"・省略した場合、C値=12として達成値を算出する。\\n\" + \"＞@x：クリティカル値修正。（加減式でも入力可能）\\n\" + \"・xに直接数字を書くと、C値をその数字に上書きする。\\n\" + \"　「絶対にクリティカルしない」状態は、@13など xを13以上に指定すること。\\n\" + \"・xの先頭が「+」か「-」なら、計算したC値にその値を加算。例）@-1、@+2\\n\" + \"　この方法でC値をプラスする場合、上限は12となる。\\n\" + \"＞#y、#Ay：ファンブル値修正。（加減式でも入力可能）\\n\" + \"・yに直接数字を書くと、ファンブル値をその数字に設定。\\n\" + \"・yの数字の先頭が「+」か「-」なら、ファンブル値=2にその数字を加算。例）#+2\\n\" + \"・※#Ayとすると、ファンブルしても達成値を通常通り算出。　例）#A+1\\n\" + \"＞$z：ダイスの出目をzに固定して判定する。複数指定可。\\n\" + \"　　　《運命歪曲》など「ダイスの１個を振り直す」効果等に使用する。\\n\" + \"　例）2BB$1 →ダイスを2個振る判定で、ダイス1個の出目を1で固定\\n\" + \"　例）2BB$16→ダイスを2個振る判定で、ダイスの出目を1と6で固定\\n\" + \"＞&v：出目がv未満のダイスがあれば、出目がvだったものとして達成値を計算する。\\n\" + \"　例）2BB&3 →出目3未満（→出目1、2）を出目3だったものとして計算。\\n\" + \"\\n\" + \"・D66ダイスあり\\n\" + \"・邂逅表：EMO\\n\" + \"・暴露表：EXPO_A\\n\" + \"・魔獣化暴露表：EXPO_B\\n\" + \"・アイドル専用暴露表：EXPO_I\\n\" + \"・アイドル専用魔獣化暴露表：EXPO_J\\n\" + \"・正体判明チャートA～C：FACE_A, FACE_B, FACE_C\\n\");\n        \n        Opal.def(self, '$initialize', $BeastBindTrinity_initialize$1 = function $$initialize(command) {\n          var $iter = $BeastBindTrinity_initialize$1.$$p, $yield = $iter || nil, self = this;\n\n          if ($iter) $BeastBindTrinity_initialize$1.$$p = null;\n          \n          $send2(self, Opal.find_super_dispatcher(self, 'initialize', $BeastBindTrinity_initialize$1, false, true), 'initialize', [command], null);\n          return (self.d66_sort_type = $$$($$($nesting, 'D66SortType'), 'ASC'));\n        }, $BeastBindTrinity_initialize$1.$$arity = 1);\n        (function($base, $super, $parent_nesting) {\n          var self = $klass($base, $super, 'BBCommand');\n\n          var $nesting = [self].concat($parent_nesting), $BBCommand_initialize$2, $BBCommand_roll$3, $BBCommand_parse$5, $BBCommand_parse_critical$6, $BBCommand_critical_from_humanity$7, $BBCommand_parse_fumble$8, $BBCommand_roll_with_dice_pool$9, $BBCommand_command_expr$10, $BBCommand_interim_expr$11, $BBCommand_dice_status$12, $BBCommand_fumble$ques$13, $BBCommand_critical$ques$14, $BBCommand_calc_total$15, $BBCommand_result_compare$16;\n\n          self.$$prototype.parse_error = self.$$prototype.command = self.$$prototype.dice_pool = self.$$prototype.dice_num = self.$$prototype.randomizer = self.$$prototype.modify_number = self.$$prototype.critical = self.$$prototype.fumble = self.$$prototype.cmp_op = self.$$prototype.target_number = self.$$prototype.dice_total = self.$$prototype.keep_value_on_fumble = nil;\n          \n          \n          Opal.def(self, '$initialize', $BBCommand_initialize$2 = function $$initialize(command) {\n            var self = this;\n\n            \n            self.command = command;\n            return self.$parse();\n          }, $BBCommand_initialize$2.$$arity = 1);\n          \n          Opal.def(self, '$roll', $BBCommand_roll$3 = function $$roll(randomizer) {\n            var $$4, self = this, dice_list_org = nil, dice_list_filtered = nil, total = nil, dice_list_org_str = nil, sequence = nil;\n\n            \n            if ($truthy(self.parse_error)) {\n              return nil};\n            self.randomizer = randomizer;\n            dice_list_org = self.$roll_with_dice_pool();\n            if ($truthy(dice_list_org['$empty?']())) {\n              return \"ERROR:振るダイスの数が0個です\"};\n            dice_list_filtered = $send(dice_list_org, 'map', [], ($$4 = function(dice){var self = $$4.$$s == null ? this : $$4.$$s;\n              if (self.dice_value_lower_limit == null) self.dice_value_lower_limit = nil;\n\n            \n              \n              if (dice == null) {\n                dice = nil;\n              };\n              return [dice, self.dice_value_lower_limit].$max();}, $$4.$$s = self, $$4.$$arity = 1, $$4)).$sort();\n            self.dice_total = dice_list_filtered.$last(2).$inject(0, \"+\");\n            total = self.$calc_total();\n            if ($truthy(dice_list_filtered['$!='](dice_list_org))) {\n              dice_list_org_str = \"\" + \"[\" + (dice_list_org.$join(\",\")) + \"]\"};\n            sequence = [self.$command_expr(), dice_list_org_str, self.$interim_expr(dice_list_filtered), self.$dice_status(), total.$to_s(), self.$result_compare(total)].$compact();\n            return sequence.$join(\" ＞ \");\n          }, $BBCommand_roll$3.$$arity = 1);\n          self.$private();\n          \n          Opal.def(self, '$parse', $BBCommand_parse$5 = function $$parse() {\n            var $a, self = this, m = nil;\n\n            \n            m = /^(\\d+)(?:R6|BB6?)((?:[+\\-]\\d+)+)?(?:%(-?\\d+))?(?:@([+\\-\\d]+))?(?:#(A)?([+\\-\\d]+))?(?:\\$([1-6]+))?(?:&([1-6]))?(?:([>=]+)(\\d+))?$/.$match(self.command);\n            if ($truthy(m)) {\n            } else {\n              \n              self.parse_error = true;\n              return nil;\n            };\n            self.dice_num = m['$[]'](1).$to_i();\n            self.modify_number = (function() {if ($truthy(m['$[]'](2))) {\n              return $$($nesting, 'ArithmeticEvaluator').$eval(m['$[]'](2))\n            } else {\n              return 0\n            }; return nil; })();\n            self.critical = self.$parse_critical(m['$[]'](3), m['$[]'](4));\n            self.keep_value_on_fumble = m['$[]'](5)['$nil?']()['$!']();\n            self.fumble = self.$parse_fumble(m['$[]'](6));\n            self.dice_pool = (function() {if ($truthy(m['$[]'](7))) {\n              return $send(m['$[]'](7).$split(\"\"), 'map', [], \"to_i\".$to_proc())\n            } else {\n              return []\n            }; return nil; })();\n            if ($truthy($rb_gt(self.dice_pool.$size(), self.dice_num))) {\n              self.dice_pool.$pop($rb_minus(self.dice_pool.$size(), self.dice_num))};\n            self.dice_value_lower_limit = m['$[]'](8).$to_i();\n            self.cmp_op = $$($nesting, 'Normalize').$comparison_operator(m['$[]'](9));\n            self.target_number = ($a = m['$[]'](10), ($a === nil || $a == null) ? nil : $send($a, 'to_i', []));\n            return (self.parse_error = false);\n          }, $BBCommand_parse$5.$$arity = 0);\n          \n          Opal.def(self, '$parse_critical', $BBCommand_parse_critical$6 = function $$parse_critical(humanity, atmark) {\n            var self = this, atmark_value = nil, critical = nil;\n\n            \n            humanity = (function() {if ($truthy(humanity)) {\n              return humanity.$to_i()\n            } else {\n              return 99\n            }; return nil; })();\n            atmark_value = (function() {if ($truthy(atmark)) {\n              return $$($nesting, 'ArithmeticEvaluator').$eval(atmark)\n            } else {\n              return 0\n            }; return nil; })();\n            critical = (function() {if ($truthy(/^[+-]/.$match(atmark))) {\n              return [$rb_plus(self.$critical_from_humanity(humanity), atmark_value), 12].$min()\n            } else if ($truthy(atmark)) {\n              return atmark_value\n            } else {\n              return self.$critical_from_humanity(humanity)\n            }; return nil; })();\n            return critical;\n          }, $BBCommand_parse_critical$6.$$arity = 2);\n          \n          Opal.def(self, '$critical_from_humanity', $BBCommand_critical_from_humanity$7 = function $$critical_from_humanity(humanity) {\n            var self = this;\n\n            if ($truthy($rb_le(humanity, 0))) {\n              return 9\n            } else if ($truthy($rb_le(humanity, 20))) {\n              return 10\n            } else if ($truthy($rb_le(humanity, 40))) {\n              return 11\n            } else {\n              return 12\n            }\n          }, $BBCommand_critical_from_humanity$7.$$arity = 1);\n          \n          Opal.def(self, '$parse_fumble', $BBCommand_parse_fumble$8 = function $$parse_fumble(sharp) {\n            var self = this, sharp_value = nil;\n\n            \n            sharp_value = (function() {if ($truthy(sharp)) {\n              return $$($nesting, 'ArithmeticEvaluator').$eval(sharp)\n            } else {\n              return 0\n            }; return nil; })();\n            if ($truthy(/^[+-]/.$match(sharp))) {\n              return $rb_plus(2, sharp_value)\n            } else if ($truthy(sharp)) {\n              return sharp_value\n            } else {\n              return 2\n            };\n          }, $BBCommand_parse_fumble$8.$$arity = 1);\n          \n          Opal.def(self, '$roll_with_dice_pool', $BBCommand_roll_with_dice_pool$9 = function $$roll_with_dice_pool() {\n            var self = this, dice_times = nil, dice_list = nil;\n\n            \n            dice_times = $rb_minus(self.dice_num, self.dice_pool.$size());\n            dice_list = $rb_plus(self.randomizer.$roll_barabara(dice_times, 6), self.dice_pool);\n            return dice_list.$sort();\n          }, $BBCommand_roll_with_dice_pool$9.$$arity = 0);\n          \n          Opal.def(self, '$command_expr', $BBCommand_command_expr$10 = function $$command_expr() {\n            var self = this, modifier = nil;\n\n            \n            modifier = $$($nesting, 'Format').$modifier(self.modify_number);\n            return \"\" + \"(\" + (self.dice_num) + \"BB\" + (modifier) + \"@\" + (self.critical) + \"#\" + (self.fumble) + (self.cmp_op) + (self.target_number) + \")\";\n          }, $BBCommand_command_expr$10.$$arity = 0);\n          \n          Opal.def(self, '$interim_expr', $BBCommand_interim_expr$11 = function $$interim_expr(dice_list) {\n            var self = this, expr = nil;\n\n            \n            expr = \"\" + (self.dice_total) + \"[\" + (dice_list.$join(\",\")) + \"]\" + ($$($nesting, 'Format').$modifier(self.modify_number));\n            if ($truthy(self['$critical?']())) {\n              expr = $rb_plus(expr, \"+20\")};\n            return expr;\n          }, $BBCommand_interim_expr$11.$$arity = 1);\n          \n          Opal.def(self, '$dice_status', $BBCommand_dice_status$12 = function $$dice_status() {\n            var self = this;\n\n            if ($truthy(self['$fumble?']())) {\n              return \"ファンブル\"\n            } else if ($truthy(self['$critical?']())) {\n              return \"クリティカル\"\n            } else {\n              return nil\n            }\n          }, $BBCommand_dice_status$12.$$arity = 0);\n          \n          Opal.def(self, '$fumble?', $BBCommand_fumble$ques$13 = function() {\n            var self = this;\n\n            return $rb_le(self.dice_total, self.fumble)\n          }, $BBCommand_fumble$ques$13.$$arity = 0);\n          \n          Opal.def(self, '$critical?', $BBCommand_critical$ques$14 = function() {\n            var self = this;\n\n            return $rb_ge(self.dice_total, self.critical)\n          }, $BBCommand_critical$ques$14.$$arity = 0);\n          \n          Opal.def(self, '$calc_total', $BBCommand_calc_total$15 = function $$calc_total() {\n            var self = this, total = nil;\n\n            \n            total = $rb_plus(self.dice_total, self.modify_number);\n            if ($truthy(self['$fumble?']())) {\n              if ($truthy(self.keep_value_on_fumble)) {\n              } else {\n                total = 0\n              }\n            } else if ($truthy(self['$critical?']())) {\n              total = $rb_plus(total, 20)};\n            if ($truthy($rb_lt(total, 0))) {\n              total = 0};\n            return total;\n          }, $BBCommand_calc_total$15.$$arity = 0);\n          return (Opal.def(self, '$result_compare', $BBCommand_result_compare$16 = function $$result_compare(total) {\n            var self = this;\n\n            if ($truthy(self.cmp_op)) {\n              if ($truthy(total.$send(self.cmp_op, self.target_number))) {\n                return \"成功\"\n              } else {\n                return \"失敗\"\n              }\n            } else {\n              return nil\n            }\n          }, $BBCommand_result_compare$16.$$arity = 1), nil) && 'result_compare';\n        })($nesting[0], null, $nesting);\n        \n        Opal.def(self, '$eval_game_system_specific_command', $BeastBindTrinity_eval_game_system_specific_command$17 = function $$eval_game_system_specific_command(command) {\n          var self = this, ret = nil, bb = nil;\n\n          \n          if ($truthy((ret = self.$roll_tables(command, $$($nesting, 'TABLES'))))) {\n            return ret};\n          bb = $$($nesting, 'BBCommand').$new(command);\n          return bb.$roll(self.randomizer);\n        }, $BeastBindTrinity_eval_game_system_specific_command$17.$$arity = 1);\n        Opal.const_set($nesting[0], 'TABLES', $hash2([\"EMO\", \"EXPO_A\", \"EXPO_B\", \"EXPO_I\", \"EXPO_J\", \"FACE_A\", \"FACE_B\", \"FACE_C\"], {\"EMO\": $$$($$($nesting, 'DiceTable'), 'D66GridTable').$new(\"邂逅表\", [[\"家族\", \"家族\", \"信頼\", \"信頼\", \"忘却\", \"忘却\"], [\"慈愛\", \"慈愛\", \"憧憬\", \"憧憬\", \"感銘\", \"感銘\"], [\"同志\", \"同志\", \"幼子\", \"幼子\", \"興味\", \"興味\"], [\"ビジネス\", \"ビジネス\", \"師事\", \"師事\", \"好敵手\", \"好敵手\"], [\"友情\", \"友情\", \"忠誠\", \"忠誠\", \"恐怖\", \"恐怖\"], [\"執着\", \"執着\", \"軽蔑\", \"軽蔑\", \"憎悪\", \"憎悪\"]]), \"EXPO_A\": $$$($$($nesting, 'DiceTable'), 'Table').$new(\"暴露表\", \"1D6\", [\"噂になるがすぐ忘れられる\", \"都市伝説として処理される\", \"ワイドショーをにぎわす\", \"シナリオ中［迫害状態］になる\", \"絆の対象ひとりに正体が知られる\", \"魔獣化暴露表へ\"]), \"EXPO_B\": $$$($$($nesting, 'DiceTable'), 'Table').$new(\"魔獣化暴露表\", \"1D6\", [\"トンデモ業界の伝説になる\", \"シナリオ中［迫害状態］になる\", \"シナリオ中［迫害状態］になる\", \"絆の対象ひとりに正体が知られる\", \"絆の対象ひとりに正体が知られる\", \"自衛隊退魔部隊×2D6体の襲撃\"]), \"EXPO_I\": $$$($$($nesting, 'DiceTable'), 'Table').$new(\"アイドル専用暴露表\", \"1D6\", [\"愉快な伝説として人気になる\", \"ワイドショーをにぎわす\", \"炎上。シナリオ中［迫害状態］\", \"所属事務所に2D6時間説教される\", \"絆の対象ひとりに正体が知られる\", \"アイドル専用魔獣化暴露表へ\"]), \"EXPO_J\": $$$($$($nesting, 'DiceTable'), 'Table').$new(\"アイドル専用魔獣化暴露表\", \"1D6\", [\"シナリオ中［迫害状態］になる\", \"シナリオ中［迫害状態］になる\", \"絆の対象ひとりに正体が知られる\", \"事務所から契約を解除される\", \"絆の対象ひとりに正体が知られる\", \"1D6本のレギュラー番組を失う\"]), \"FACE_A\": $$$($$($nesting, 'DiceTable'), 'Table').$new(\"正体判明チャートA\", \"1D6\", [\"あなたを受け入れてくれる\", \"あなたを受け入れてくれる\", \"絆が（拒絶）に書き換わる\", \"絆がエゴに書き換わる\", \"気絶しその事実を忘れる\", \"精神崩壊する\"]), \"FACE_B\": $$$($$($nesting, 'DiceTable'), 'Table').$new(\"正体判明チャートB\", \"1D6\", [\"あなたを受け入れてくれる\", \"狂乱し攻撃してくる\", \"退場。その場から逃亡。暴露表へ\", \"絆がエゴに書き換わる\", \"精神崩壊する\", \"精神崩壊する\"]), \"FACE_C\": $$$($$($nesting, 'DiceTable'), 'Table').$new(\"正体判明チャートC\", \"1D6\", [\"あなたを受け入れてくれる\", \"退場。その場から逃亡。暴露表へ\", \"退場。その場から逃亡。暴露表へ\", \"絆がエゴに書き換わる\", \"精神崩壊する\", \"精神崩壊する\"])}).$freeze());\n        return self.$register_prefix(\"\\\\d+BB\", \"\\\\d+R6\", $$($nesting, 'TABLES').$keys());\n      })($nesting[0], $$($nesting, 'Base'), $nesting)\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting);\n})(Opal);\n"],"sourceRoot":"webpack:///"}