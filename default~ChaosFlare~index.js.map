{"version":3,"sources":["./node_modules/bcdice/lib/bcdice/game_system/ChaosFlare.js"],"names":["require","Opal","$rb_le","lhs","rhs","$rb_minus","$rb_ge","$rb_divide","$rb_lt","$rb_plus","self","top","$nesting","nil","$$$","$$","$module","module","$klass","klass","$truthy","truthy","$send","send","$range","range","$hash2","hash2","$base","$parent_nesting","concat","$super","$ChaosFlare_result_2d6$1","$ChaosFlare_eval_game_system_specific_command$2","$ChaosFlare_roll_fate_table$3","$ChaosFlare_cf_roll$4","$ChaosFlare_difference$5","$$prototype","randomizer","cmd","const_set","$register_prefix","def","$$result_2d6","total","dice_total","_dice_list","cmp_op","target","sequence","result","$writer","$new","$push","to_a","$nothing","$join","$$arity","$$eval_game_system_specific_command","command","$roll_fate_table","$cf_roll","$private","$$roll_fate_table","m","num","dice1","dice2","$ret_or_1","index1","index2","$match","$to_i","$roll_once","$$cf_roll","parser","times","critical","$ret_or_2","fumble","$ret_or_3","$ret_or_4","dice_list","dice_list_text","is_critical","is_fumble","$round_type","$enable_critical","$enable_fumble","$parse","$command","$critical","$fumble","$cmp_op","$roll_barabara","$sum","$modify_number","$to_s","$target_number","$difference","$compact","$$difference","$freeze"],"mappings":"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","file":"default~ChaosFlare~index.js","sourcesContent":["require('./../opal');\n\n/* Generated by Opal 1.1.1 */\n(function(Opal) {\n  function $rb_le(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs <= rhs : lhs['$<='](rhs);\n  }\n  function $rb_minus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);\n  }\n  function $rb_ge(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs >= rhs : lhs['$>='](rhs);\n  }\n  function $rb_divide(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs / rhs : lhs['$/'](rhs);\n  }\n  function $rb_lt(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);\n  }\n  function $rb_plus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);\n  }\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send, $range = Opal.range, $hash2 = Opal.hash2;\n\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'GameSystem');\n\n      var $nesting = [self].concat($parent_nesting);\n\n      (function($base, $super, $parent_nesting) {\n        var self = $klass($base, $super, 'ChaosFlare');\n\n        var $nesting = [self].concat($parent_nesting), $ChaosFlare_result_2d6$1, $ChaosFlare_eval_game_system_specific_command$2, $ChaosFlare_roll_fate_table$3, $ChaosFlare_cf_roll$4, $ChaosFlare_difference$5;\n\n        self.$$prototype.randomizer = self.$$prototype.cmd = nil;\n        \n        Opal.const_set($nesting[0], 'ID', \"ChaosFlare\");\n        Opal.const_set($nesting[0], 'NAME', \"カオスフレア\");\n        Opal.const_set($nesting[0], 'SORT_KEY', \"かおすふれあ\");\n        Opal.const_set($nesting[0], 'HELP_MESSAGE', \"\" + \"判定\\n\" + \"CF\\n\" + \"  書式: [ダイスの数]CF[修正値][@クリティカル値][#ファンブル値][>=目標値]\\n\" + \"    CF以外は全て省略可能\\n\" + \"  例:\\n\" + \"  - CF 2D6,クリティカル値12,ファンブル値2で判定\\n\" + \"  - CF+10@10 修正値+10,クリティカル値10で判定\\n\" + \"  - CF+10#3 修正値+10,ファンブル値3で判定\\n\" + \"  - CF+10>=10 目標値を指定した場合、差分値も出力する\\n\" + \"  - 3CF+10@10#3>=10 3D6での判定\\n\" + \"  - CF@9#3+8>=10\\n\" + \"\\n\" + \"2D6\\n\" + \"  ファンブル値2で判定する。クリティカルの判定は行われない。\\n\" + \"  目標値が設定された場合、差分値を出力する。\\n\" + \"  - 2D6+4>=10\\n\" + \"\\n\" + \"各種表\\n\" + \"  FT: 因縁表\\n\" + \"  FTx: 数値を指定すると因果表の値を出力する\\n\" + \"  - FT -> 11から66の間でランダム決定\\n\" + \"  - FT23 -> 23の項目を出力\\n\" + \"  - FT0\\n\" + \"  - FT7\\n\");\n        self.$register_prefix(\"\\\\d*CF\", \"FT\");\n        \n        Opal.def(self, '$result_2d6', $ChaosFlare_result_2d6$1 = function $$result_2d6(total, dice_total, _dice_list, cmp_op, target) {\n          var self = this, sequence = nil, result = nil, $writer = nil;\n\n          \n          if (cmp_op['$=='](\">=\")) {\n          } else {\n            return nil\n          };\n          sequence = [];\n          result = $$($nesting, 'Result').$new();\n          if ($truthy($rb_le(dice_total, 2))) {\n            \n            total = $rb_minus(total, 20);\n            sequence.$push(\"ファンブル(-20)\");\n            \n            $writer = [true];\n            $send(result, 'fumble=', Opal.to_a($writer));\n            $writer[$rb_minus($writer[\"length\"], 1)];;};\n          if ($truthy(target['$!='](\"?\"))) {\n            \n            if ($truthy($rb_ge(total, target))) {\n              \n              sequence.$push(\"成功\");\n              \n              $writer = [true];\n              $send(result, 'success=', Opal.to_a($writer));\n              $writer[$rb_minus($writer[\"length\"], 1)];;\n            } else {\n              \n              sequence.$push(\"失敗\");\n              \n              $writer = [true];\n              $send(result, 'failure=', Opal.to_a($writer));\n              $writer[$rb_minus($writer[\"length\"], 1)];;\n            };\n            if ($truthy($rb_minus(total, target)['$!='](0))) {\n              sequence.$push(\"\" + \"差分値\" + ($rb_minus(total, target)))};};\n          if ($truthy(sequence['$empty?']())) {\n            return $$($nesting, 'Result').$nothing()};\n          \n          $writer = [sequence.$join(\" ＞ \")];\n          $send(result, 'text=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          return result;\n        }, $ChaosFlare_result_2d6$1.$$arity = 5);\n        \n        Opal.def(self, '$eval_game_system_specific_command', $ChaosFlare_eval_game_system_specific_command$2 = function $$eval_game_system_specific_command(command) {\n          var self = this;\n\n          if ($truthy(command['$start_with?'](\"FT\"))) {\n            return self.$roll_fate_table(command)\n          } else {\n            return self.$cf_roll(command)\n          }\n        }, $ChaosFlare_eval_game_system_specific_command$2.$$arity = 1);\n        self.$private();\n        \n        Opal.def(self, '$roll_fate_table', $ChaosFlare_roll_fate_table$3 = function $$roll_fate_table(command) {\n          var self = this, m = nil, num = nil, dice1 = nil, dice2 = nil, $ret_or_1 = nil, index1 = nil, index2 = nil;\n\n          \n          m = /^FT(\\d+)?/.$match(command);\n          if ($truthy(m['$[]'](1))) {\n            \n            num = m['$[]'](1).$to_i();\n            if ($truthy([0, 7]['$include?'](num))) {\n              return \"\" + \"因果表(\" + (num) + \") ＞ \" + ($$($nesting, 'FATE_TABLE')['$[]'](num)['$[]'](0))};\n            dice1 = $rb_divide(num, 10).$to_i();\n            dice2 = num['$%'](10);\n            if ($truthy((function() {if ($truthy(($ret_or_1 = $range(1, 6, false)['$include?'](dice1)['$!']()))) {\n              return $ret_or_1\n            } else {\n              return $range(1, 6, false)['$include?'](dice2)['$!']()\n            }; return nil; })())) {\n              return nil};\n          } else {\n            \n            dice1 = self.randomizer.$roll_once(6);\n            dice2 = self.randomizer.$roll_once(6);\n          };\n          index1 = dice1;\n          index2 = $rb_minus($rb_divide(dice2, 2).$to_i(), 1);\n          return \"\" + \"因果表(\" + (dice1) + (dice2) + \") ＞ \" + ($$($nesting, 'FATE_TABLE')['$[]'](index1)['$[]'](index2));\n        }, $ChaosFlare_roll_fate_table$3.$$arity = 1);\n        \n        Opal.def(self, '$cf_roll', $ChaosFlare_cf_roll$4 = function $$cf_roll(command) {\n          var self = this, parser = nil, times = nil, critical = nil, $ret_or_2 = nil, fumble = nil, $ret_or_3 = nil, $writer = nil, $ret_or_4 = nil, dice_list = nil, dice_total = nil, dice_list_text = nil, is_critical = nil, is_fumble = nil, total = nil, sequence = nil;\n\n          \n          parser = $$$($$($nesting, 'Command'), 'Parser').$new(/\\d*CF/, $hash2([\"round_type\"], {\"round_type\": self.$round_type()})).$enable_critical().$enable_fumble();\n          self.cmd = parser.$parse(command);\n          if ($truthy(self.cmd)) {\n          } else {\n            return nil\n          };\n          times = (function() {if (self.cmd.$command()['$=='](\"CF\")) {\n            return 2\n          } else {\n            return self.cmd.$command().$to_i()\n          }; return nil; })();\n          critical = (function() {if ($truthy(($ret_or_2 = self.cmd.$critical()))) {\n            return $ret_or_2\n          } else {\n            return 12\n          }; return nil; })();\n          fumble = (function() {if ($truthy(($ret_or_3 = self.cmd.$fumble()))) {\n            return $ret_or_3\n          } else {\n            return 2\n          }; return nil; })();\n          \n          $writer = [nil];\n          $send(self.cmd, 'dollar=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          if ($truthy((function() {if ($truthy(($ret_or_4 = $rb_lt(times, 0)))) {\n            return $ret_or_4\n          } else {\n            return [\">=\", nil]['$include?'](self.cmd.$cmp_op())['$!']()\n          }; return nil; })())) {\n            return nil};\n          dice_list = self.randomizer.$roll_barabara(times, 6);\n          dice_total = dice_list.$sum();\n          dice_list_text = dice_list.$join(\",\");\n          is_critical = $rb_ge(dice_total, critical);\n          is_fumble = $rb_le(dice_total, fumble);\n          total = (function() {if ($truthy(is_critical)) {\n            return 30\n          } else if ($truthy(is_fumble)) {\n            return -20\n          } else {\n            return dice_total\n          }; return nil; })();\n          total = $rb_plus(total, self.cmd.$modify_number());\n          sequence = [\"\" + \"(\" + (self.cmd.$to_s(\"after_modify_number\")) + \")\", \"\" + (dice_total) + \"[\" + (dice_list_text) + \"]\", total.$to_s(), (function() {if ($truthy($rb_lt(total, 0))) {\n            return \"0\"\n          } else {\n            return nil\n          }; return nil; })(), (function() {if ($truthy(is_critical)) {\n            return \"クリティカル\"\n          } else {\n            return nil\n          }; return nil; })(), (function() {if ($truthy(is_fumble)) {\n            return \"ファンブル\"\n          } else {\n            return nil\n          }; return nil; })(), (function() {if ($truthy(self.cmd.$target_number())) {\n            return \"\" + \"差分値 \" + (self.$difference(total))\n          } else {\n            return nil\n          }; return nil; })()].$compact();\n          return sequence.$join(\" ＞ \");\n        }, $ChaosFlare_cf_roll$4.$$arity = 1);\n        \n        Opal.def(self, '$difference', $ChaosFlare_difference$5 = function $$difference(total) {\n          var self = this;\n\n          if ($truthy($rb_lt(total, 0))) {\n            return self.cmd.$target_number()['$-@']()\n          } else {\n            return $rb_minus(total, self.cmd.$target_number())\n          }\n        }, $ChaosFlare_difference$5.$$arity = 1);\n        return Opal.const_set($nesting[0], 'FATE_TABLE', [[\"腐れ縁\"], [\"純愛\", \"親近感\", \"庇護\"], [\"信頼\", \"感服\", \"共感\"], [\"友情\", \"尊敬\", \"慕情\"], [\"好敵手\", \"期待\", \"借り\"], [\"興味\", \"憎悪\", \"悲しみ\"], [\"恐怖\", \"執着\", \"利用\"], [\"任意\"]].$freeze());\n      })($nesting[0], $$($nesting, 'Base'), $nesting)\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting)\n})(Opal);\n"],"sourceRoot":"webpack:///"}