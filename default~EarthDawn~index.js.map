{"version":3,"sources":["./node_modules/bcdice/lib/bcdice/game_system/EarthDawn.js"],"names":["require","Opal","$rb_gt","lhs","rhs","$rb_lt","$rb_minus","$rb_plus","$rb_ge","self","top","$nesting","nil","$$$","$$","$module","module","$klass","klass","$send2","send2","$truthy","truthy","$send","send","$base","$parent_nesting","concat","$super","$EarthDawn_initialize$1","$EarthDawn_eval_game_system_specific_command$2","$EarthDawn_ed_step$3","$EarthDawn_getStepResult$4","$EarthDawn_getStepTable$5","$EarthDawn_rollStep$6","$$prototype","string","isFailed","const_set","$register_prefix","def","$$initialize","command","$iter","$$p","$yield","find_super_dispatcher","sort_add_dice","$$arity","$$eval_game_system_specific_command","$ed_step","$$ed_step","str","output","$getStepResult","$$getStepResult","stepTotal","step","targetNumber","hasKarmaDice","karmaDiceCount","karmaDiceType","stable","nmod","d20step","d12step","d10step","d8step","d6step","d4step","$case","excelentSuccessNumber","superSuccessNumber","goodSuccessNumber","failedNumber","$last_match","$to_i","$getStepTable","$debug","$rollStep","$to_s","$$getStepTable","mod","d20","d12","d10","d8","d6","d4","exsuc","ssuc","gsuc","nsuc","fsuc","$$rollStep","diceType","diceCount","$$7","i","$$s","$a","dice_now","dice_in","randomizer","$roll_once"],"mappings":"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","file":"default~EarthDawn~index.js","sourcesContent":["require('./../opal');\n\n/* Generated by Opal 1.1.1 */\n(function(Opal) {\n  function $rb_gt(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);\n  }\n  function $rb_lt(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);\n  }\n  function $rb_minus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);\n  }\n  function $rb_plus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);\n  }\n  function $rb_ge(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs >= rhs : lhs['$>='](rhs);\n  }\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $klass = Opal.klass, $send2 = Opal.send2, $truthy = Opal.truthy, $send = Opal.send;\n\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'GameSystem');\n\n      var $nesting = [self].concat($parent_nesting);\n\n      (function($base, $super, $parent_nesting) {\n        var self = $klass($base, $super, 'EarthDawn');\n\n        var $nesting = [self].concat($parent_nesting), $EarthDawn_initialize$1, $EarthDawn_eval_game_system_specific_command$2, $EarthDawn_ed_step$3, $EarthDawn_getStepResult$4, $EarthDawn_getStepTable$5, $EarthDawn_rollStep$6;\n\n        self.$$prototype.string = self.$$prototype.isFailed = nil;\n        \n        Opal.const_set($nesting[0], 'ID', \"EarthDawn\");\n        Opal.const_set($nesting[0], 'NAME', \"アースドーン\");\n        Opal.const_set($nesting[0], 'SORT_KEY', \"ああすとおん\");\n        Opal.const_set($nesting[0], 'HELP_MESSAGE', \"\" + \"ステップダイス　(xEn+k)\\n\" + \"ステップx、目標値n(省略可能）、カルマダイスk(D2-D20)でステップダイスをロールします。\\n\" + \"振り足しも自動。\\n\" + \"例）9E　10E8　10E+D12\\n\");\n        self.$register_prefix(\"\\\\d+e\");\n        \n        Opal.def(self, '$initialize', $EarthDawn_initialize$1 = function $$initialize(command) {\n          var $iter = $EarthDawn_initialize$1.$$p, $yield = $iter || nil, self = this;\n\n          if ($iter) $EarthDawn_initialize$1.$$p = null;\n          \n          $send2(self, Opal.find_super_dispatcher(self, 'initialize', $EarthDawn_initialize$1, false, true), 'initialize', [command], null);\n          return (self.sort_add_dice = true);\n        }, $EarthDawn_initialize$1.$$arity = 1);\n        \n        Opal.def(self, '$eval_game_system_specific_command', $EarthDawn_eval_game_system_specific_command$2 = function $$eval_game_system_specific_command(command) {\n          var self = this;\n\n          return self.$ed_step(command)\n        }, $EarthDawn_eval_game_system_specific_command$2.$$arity = 1);\n        \n        Opal.def(self, '$ed_step', $EarthDawn_ed_step$3 = function $$ed_step(str) {\n          var self = this, output = nil;\n\n          \n          output = self.$getStepResult(str);\n          return output;\n        }, $EarthDawn_ed_step$3.$$arity = 1);\n        \n        Opal.def(self, '$getStepResult', $EarthDawn_getStepResult$4 = function $$getStepResult(str) {\n          var self = this, stepTotal = nil, step = nil, targetNumber = nil, hasKarmaDice = nil, karmaDiceCount = nil, karmaDiceType = nil, stable = nil, nmod = nil, d20step = nil, d12step = nil, d10step = nil, d8step = nil, d6step = nil, d4step = nil, $case = nil, output = nil, excelentSuccessNumber = nil, superSuccessNumber = nil, goodSuccessNumber = nil, failedNumber = nil;\n\n          \n          if ($truthy(/(\\d+)E(\\d+)?(\\+)?(\\d+)?(d\\d+)?/i['$=~'](str))) {\n          } else {\n            return nil\n          };\n          stepTotal = 0;\n          self.isFailed = true;\n          step = $$($nesting, 'Regexp').$last_match(1).$to_i();\n          targetNumber = 0;\n          hasKarmaDice = false;\n          karmaDiceCount = 0;\n          karmaDiceType = 0;\n          if ($truthy($rb_gt(step, 40))) {\n            step = 40};\n          if ($truthy($$($nesting, 'Regexp').$last_match(2))) {\n            \n            targetNumber = $$($nesting, 'Regexp').$last_match(2).$to_i();\n            if ($truthy($rb_gt(targetNumber, 43))) {\n              targetNumber = 42};};\n          if ($truthy($$($nesting, 'Regexp').$last_match(3))) {\n            hasKarmaDice = $$($nesting, 'Regexp').$last_match(3).$to_i()};\n          if ($truthy($$($nesting, 'Regexp').$last_match(4))) {\n            karmaDiceCount = $$($nesting, 'Regexp').$last_match(4).$to_i()};\n          if ($truthy($$($nesting, 'Regexp').$last_match(5))) {\n            karmaDiceType = $$($nesting, 'Regexp').$last_match(5)};\n          if ($truthy($rb_lt(targetNumber, 0))) {\n            return nil};\n          stable = self.$getStepTable();\n          nmod = stable['$[]'](0)['$[]']($rb_minus(step, 1));\n          d20step = stable['$[]'](1)['$[]']($rb_minus(step, 1));\n          d12step = stable['$[]'](2)['$[]']($rb_minus(step, 1));\n          d10step = stable['$[]'](3)['$[]']($rb_minus(step, 1));\n          d8step = stable['$[]'](4)['$[]']($rb_minus(step, 1));\n          d6step = stable['$[]'](5)['$[]']($rb_minus(step, 1));\n          d4step = stable['$[]'](6)['$[]']($rb_minus(step, 1));\n          if ($truthy(hasKarmaDice)) {\n            $case = karmaDiceType;\n            if (/d20/i['$===']($case)) {d20step = $rb_plus(d20step, karmaDiceCount)}\n            else if (/d12/i['$===']($case)) {d12step = $rb_plus(d12step, karmaDiceCount)}\n            else if (/d10/i['$===']($case)) {d10step = $rb_plus(d10step, karmaDiceCount)}\n            else if (/d8/i['$===']($case)) {d8step = $rb_plus(d8step, karmaDiceCount)}\n            else if (/d6/i['$===']($case)) {d6step = $rb_plus(d6step, karmaDiceCount)}\n            else if (/d4/i['$===']($case)) {d4step = $rb_plus(d4step, karmaDiceCount)}\n            else {nmod = $rb_plus(nmod, karmaDiceCount)}};\n          self.string = \"\";\n          self.$debug(\"d20step, d12step, d10step, d8step, d6step, d4step\", d20step, d12step, d10step, d8step, d6step, d4step);\n          stepTotal = $rb_plus(stepTotal, self.$rollStep(20, d20step));\n          stepTotal = $rb_plus(stepTotal, self.$rollStep(12, d12step));\n          stepTotal = $rb_plus(stepTotal, self.$rollStep(10, d10step));\n          stepTotal = $rb_plus(stepTotal, self.$rollStep(8, d8step));\n          stepTotal = $rb_plus(stepTotal, self.$rollStep(6, d6step));\n          stepTotal = $rb_plus(stepTotal, self.$rollStep(4, d4step));\n          if ($truthy($rb_gt(nmod, 0))) {\n            self.string = $rb_plus(self.string, \"+\")};\n          if ($truthy(nmod['$!='](0))) {\n            \n            self.string = $rb_plus(self.string, nmod.$to_s());\n            stepTotal = $rb_plus(stepTotal, nmod);};\n          self.string = $rb_plus(self.string, \"\" + \" ＞ \" + (stepTotal));\n          output = \"\" + \"ステップ\" + (step) + \" ＞ \" + (self.string);\n          if (targetNumber['$=='](0)) {\n            return output};\n          self.string = $rb_plus(self.string, \" ＞ \");\n          excelentSuccessNumber = stable['$[]'](7)['$[]']($rb_minus(targetNumber, 1));\n          superSuccessNumber = stable['$[]'](8)['$[]']($rb_minus(targetNumber, 1));\n          goodSuccessNumber = stable['$[]'](9)['$[]']($rb_minus(targetNumber, 1));\n          failedNumber = stable['$[]'](11)['$[]']($rb_minus(targetNumber, 1));\n          if ($truthy(self.isFailed)) {\n            self.string = $rb_plus(self.string, \"自動失敗\")\n          } else if ($truthy($rb_ge(stepTotal, excelentSuccessNumber))) {\n            self.string = $rb_plus(self.string, \"最良成功\")\n          } else if ($truthy($rb_ge(stepTotal, superSuccessNumber))) {\n            self.string = $rb_plus(self.string, \"優成功\")\n          } else if ($truthy($rb_ge(stepTotal, goodSuccessNumber))) {\n            self.string = $rb_plus(self.string, \"良成功\")\n          } else if ($truthy($rb_ge(stepTotal, targetNumber))) {\n            self.string = $rb_plus(self.string, \"成功\")\n          } else if ($truthy($rb_lt(stepTotal, failedNumber))) {\n            self.string = $rb_plus(self.string, \"大失敗\")\n          } else {\n            self.string = $rb_plus(self.string, \"失敗\")\n          };\n          output = \"\" + \"ステップ\" + (step) + \">=\" + (targetNumber) + \" ＞ \" + (self.string);\n          return output;\n        }, $EarthDawn_getStepResult$4.$$arity = 1);\n        \n        Opal.def(self, '$getStepTable', $EarthDawn_getStepTable$5 = function $$getStepTable() {\n          var self = this, mod = nil, d20 = nil, d12 = nil, d10 = nil, d8 = nil, d6 = nil, d4 = nil, exsuc = nil, ssuc = nil, gsuc = nil, nsuc = nil, fsuc = nil, stable = nil;\n\n          \n          mod = [-2, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n          d20 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n          d12 = [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1];\n          d10 = [0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 2, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 2, 3, 2, 1, 1, 1, 2, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 2, 1];\n          d8 = [0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 2, 1, 1, 1, 2, 2, 1, 1, 1, 1, 2, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0];\n          d6 = [0, 0, 0, 1, 0, 0, 0, 2, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 2, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 2, 1, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 1, 0, 0, 0, 2, 1, 1, 0, 0, 0];\n          d4 = [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n          exsuc = [6, 8, 10, 12, 14, 17, 19, 20, 22, 24, 25, 27, 29, 32, 33, 35, 37, 38, 39, 41, 42, 44, 45, 47, 48, 49, 51, 52, 54, 55, 56, 58, 59, 60, 62, 64, 65, 67, 68, 70, 71, 72];\n          ssuc = [4, 6, 8, 10, 11, 13, 15, 16, 18, 19, 21, 22, 24, 26, 27, 29, 30, 32, 33, 34, 35, 37, 38, 40, 41, 42, 43, 45, 46, 47, 48, 49, 51, 52, 53, 55, 56, 58, 59, 60, 61, 62];\n          gsuc = [2, 4, 6, 7, 9, 10, 12, 13, 14, 15, 17, 18, 20, 21, 22, 24, 25, 26, 27, 28, 29, 31, 32, 33, 34, 35, 36, 38, 39, 40, 41, 42, 43, 45, 46, 47, 48, 50, 51, 52, 53, 54];\n          nsuc = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42];\n          fsuc = [0, 1, 1, 1, 1, 2, 2, 3, 4, 5, 5, 6, 6, 7, 8, 8, 9, 10, 11, 12, 13, 13, 14, 15, 16, 17, 18, 18, 18, 20, 21, 22, 23, 23, 24, 25, 26, 26, 27, 28, 29, 30];\n          stable = [mod, d20, d12, d10, d8, d6, d4, exsuc, ssuc, gsuc, nsuc, fsuc];\n          return stable;\n        }, $EarthDawn_getStepTable$5.$$arity = 0);\n        return (Opal.def(self, '$rollStep', $EarthDawn_rollStep$6 = function $$rollStep(diceType, diceCount) {\n          var $$7, self = this, stepTotal = nil;\n\n          \n          self.$debug(\"rollStep diceType, diceCount, @string\", diceType, diceCount, self.string);\n          stepTotal = 0;\n          if ($truthy($rb_gt(diceCount, 0))) {\n          } else {\n            return stepTotal\n          };\n          if ($truthy(self.string['$empty?']())) {\n          } else {\n            self.string = $rb_plus(self.string, \"+\")\n          };\n          self.string = $rb_plus(self.string, \"\" + (diceCount) + \"d\" + (diceType) + \"[\");\n          self.$debug(\"rollStep @string\", self.string);\n          $send(diceCount, 'times', [], ($$7 = function(i){var self = $$7.$$s == null ? this : $$7.$$s, $a, dice_now = nil, dice_in = nil;\n            if (self.randomizer == null) self.randomizer = nil;\n            if (self.string == null) self.string = nil;\n\n          \n            \n            if (i == null) {\n              i = nil;\n            };\n            dice_now = self.randomizer.$roll_once(diceType);\n            if ($truthy(dice_now['$!='](1))) {\n              self.isFailed = false};\n            dice_in = dice_now;\n            while (dice_now['$=='](diceType)) {\n              \n              dice_now = self.randomizer.$roll_once(diceType);\n              dice_in = $rb_plus(dice_in, dice_now);\n            };\n            stepTotal = $rb_plus(stepTotal, dice_in);\n            if ($truthy(i['$!='](0))) {\n              self.string = $rb_plus(self.string, \",\")};\n            return (self.string = $rb_plus(self.string, dice_in.$to_s()));}, $$7.$$s = self, $$7.$$arity = 1, $$7));\n          self.string = $rb_plus(self.string, \"]\");\n          return stepTotal;\n        }, $EarthDawn_rollStep$6.$$arity = 2), nil) && 'rollStep';\n      })($nesting[0], $$($nesting, 'Base'), $nesting)\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting)\n})(Opal);\n"],"sourceRoot":"webpack:///"}