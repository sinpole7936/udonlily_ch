{"version":3,"sources":["./node_modules/bcdice/lib/bcdice/game_system/NightmareHunterDeep.js"],"names":["require","Opal","modules","$rb_gt","lhs","rhs","self","top","$nesting","nil","$$$","$$","$module","module","$truthy","truthy","$base","$parent_nesting","concat","$Format_comparison_operator$1","$Format_modifier$2","$module_function","def","$$comparison_operator","op","$case","$to_s","$$arity","$$modifier","number","$rb_minus","$rb_times","$rb_plus","$rb_ge","$rb_divide","$klass","klass","$send2","send2","$send","send","$hash2","hash2","$require","$super","$NightmareHunterDeep_initialize$1","$NightmareHunterDeep_eval_game_system_specific_command$2","$NightmareHunterDeep_result_text$5","$NightmareHunterDeep_fate$6","$NightmareHunterDeep_interim_expr$7","$NightmareHunterDeep_expr_with_revision$8","$NightmareHunterDeep_dice_revision$9","$$prototype","randomizer","const_set","$register_prefix","$$initialize","command","$iter","$$p","$yield","find_super_dispatcher","sort_add_dice","$$eval_game_system_specific_command","$$3","$$4","$a","$b","parser","cmd","times","dice_list","dice_total","total","suffix","revision","target","result","sequence","$$s","$last_match","$to_i","$new","$round_type","$restrict_cmp_op_to","$enable_question_target","$parse","$command","$roll_barabara","$sort","$sum","$modify_number","$dice_revision","to_ary","$target_number","$result_text","$cmp_op","$interim_expr","$expr_with_revision","$fate","$compact","$join","$$result_text","cmp_op","success_lv","success_nl","$$fate","$count","$$interim_expr","$ret_or_1","modifier","$size","$modifier","$$expr_with_revision","$$dice_revision","count6"],"mappings":"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","file":"default~NightmareHunterDeep~index.js","sourcesContent":["require('./../opal');\n\n/* Generated by Opal 1.1.1 */\nOpal.modules[\"bcdice/format\"] = function(Opal) {\n  function $rb_gt(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);\n  }\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $truthy = Opal.truthy;\n\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'Format');\n\n      var $nesting = [self].concat($parent_nesting), $Format_comparison_operator$1, $Format_modifier$2;\n\n      \n      self.$module_function();\n      \n      Opal.def(self, '$comparison_operator', $Format_comparison_operator$1 = function $$comparison_operator(op) {\n        var self = this, $case = nil;\n\n        return (function() {$case = op;\n        if (\"==\"['$===']($case)) {return \"=\"}\n        else if (\"!=\"['$===']($case)) {return \"<>\"}\n        else if ($$($nesting, 'Symbol')['$===']($case)) {return op.$to_s()}\n        else { return nil }})()\n      }, $Format_comparison_operator$1.$$arity = 1);\n      \n      Opal.def(self, '$modifier', $Format_modifier$2 = function $$modifier(number) {\n        var self = this;\n\n        if ($truthy(number['$nil?']())) {\n          return nil\n        } else if (number['$=='](0)) {\n          return \"\"\n        } else if ($truthy($rb_gt(number, 0))) {\n          return \"\" + \"+\" + (number)\n        } else {\n          return number.$to_s()\n        }\n      }, $Format_modifier$2.$$arity = 1);\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting)\n};\n\n/* Generated by Opal 1.1.1 */\n(function(Opal) {\n  function $rb_minus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);\n  }\n  function $rb_times(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs * rhs : lhs['$*'](rhs);\n  }\n  function $rb_plus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);\n  }\n  function $rb_ge(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs >= rhs : lhs['$>='](rhs);\n  }\n  function $rb_divide(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs / rhs : lhs['$/'](rhs);\n  }\n  function $rb_gt(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);\n  }\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $klass = Opal.klass, $send2 = Opal.send2, $send = Opal.send, $hash2 = Opal.hash2, $truthy = Opal.truthy;\n\n  \n  self.$require(\"bcdice/format\");\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'GameSystem');\n\n      var $nesting = [self].concat($parent_nesting);\n\n      (function($base, $super, $parent_nesting) {\n        var self = $klass($base, $super, 'NightmareHunterDeep');\n\n        var $nesting = [self].concat($parent_nesting), $NightmareHunterDeep_initialize$1, $NightmareHunterDeep_eval_game_system_specific_command$2, $NightmareHunterDeep_result_text$5, $NightmareHunterDeep_fate$6, $NightmareHunterDeep_interim_expr$7, $NightmareHunterDeep_expr_with_revision$8, $NightmareHunterDeep_dice_revision$9;\n\n        self.$$prototype.randomizer = nil;\n        \n        Opal.const_set($nesting[0], 'ID', \"NightmareHunterDeep\");\n        Opal.const_set($nesting[0], 'NAME', \"ナイトメアハンター=ディープ\");\n        Opal.const_set($nesting[0], 'SORT_KEY', \"ないとめあはんたあていいふ\");\n        Opal.const_set($nesting[0], 'HELP_MESSAGE', \"\" + \"判定（xD6+y>=a, xD6+y, xD6)\\n\" + \"  出目6の個数をカウントして、その4倍を合計値に加算します。\\n\" + \"  また、宿命を獲得したか表示します。\\n\" + \"\\n\" + \"  Lv目標値 (xD6+y>=LVn, xD6+y>=NLn)\\n\" + \"    レベルで目標値を指定することができます。\\n\" + \"    LVn -> n*5+1, NLn -> n*5+5 に変換されます。\\n\" + \"  目標値'?' (xD6+y>=?)\\n\" + \"    目標値を '?' にすると何Lv成功か、何NL成功かを表示します。\\n\" + \"\\n\" + \"※判定コマンドは xD6 から始まる必要があります。また xD6 が複数あると反応しません。\\n\");\n        self.$register_prefix(\"\\\\d+D6\");\n        \n        Opal.def(self, '$initialize', $NightmareHunterDeep_initialize$1 = function $$initialize(command) {\n          var $iter = $NightmareHunterDeep_initialize$1.$$p, $yield = $iter || nil, self = this;\n\n          if ($iter) $NightmareHunterDeep_initialize$1.$$p = null;\n          \n          $send2(self, Opal.find_super_dispatcher(self, 'initialize', $NightmareHunterDeep_initialize$1, false, true), 'initialize', [command], null);\n          return (self.sort_add_dice = true);\n        }, $NightmareHunterDeep_initialize$1.$$arity = 1);\n        \n        Opal.def(self, '$eval_game_system_specific_command', $NightmareHunterDeep_eval_game_system_specific_command$2 = function $$eval_game_system_specific_command(command) {\n          var $$3, $$4, $a, $b, self = this, parser = nil, cmd = nil, times = nil, dice_list = nil, dice_total = nil, total = nil, suffix = nil, revision = nil, target = nil, result = nil, sequence = nil;\n\n          \n          command = $send($send(command, 'sub', [/Lv(\\d+)/i], ($$3 = function(){var self = $$3.$$s == null ? this : $$3.$$s;\n\n          return $rb_minus($rb_times($$($nesting, 'Regexp').$last_match(1).$to_i(), 5), 1).$to_s()}, $$3.$$s = self, $$3.$$arity = 0, $$3)), 'sub', [/NL(\\d+)/i], ($$4 = function(){var self = $$4.$$s == null ? this : $$4.$$s;\n\n          return $rb_plus($rb_times($$($nesting, 'Regexp').$last_match(1).$to_i(), 5), 5).$to_s()}, $$4.$$s = self, $$4.$$arity = 0, $$4));\n          parser = $$$($$($nesting, 'Command'), 'Parser').$new(/\\d+D6/, $hash2([\"round_type\"], {\"round_type\": self.$round_type()})).$restrict_cmp_op_to(nil, \">=\").$enable_question_target();\n          cmd = parser.$parse(command);\n          if ($truthy(cmd)) {\n          } else {\n            return nil\n          };\n          times = cmd.$command().$to_i();\n          dice_list = self.randomizer.$roll_barabara(times, 6).$sort();\n          dice_total = dice_list.$sum();\n          total = $rb_plus(dice_total, cmd.$modify_number());\n          $b = self.$dice_revision(dice_list), $a = Opal.to_ary($b), (suffix = ($a[0] == null ? nil : $a[0])), (revision = ($a[1] == null ? nil : $a[1])), $b;\n          total = $rb_plus(total, revision);\n          target = (function() {if ($truthy(cmd['$question_target?']())) {\n            return \"?\"\n          } else {\n            return cmd.$target_number()\n          }; return nil; })();\n          result = self.$result_text(total, cmd.$cmp_op(), target);\n          sequence = [\"\" + \"(\" + (cmd) + \")\", self.$interim_expr(cmd, dice_total, dice_list), self.$expr_with_revision($rb_plus(dice_total, cmd.$modify_number()), suffix), total, result, self.$fate(dice_list)].$compact();\n          return sequence.$join(\" ＞ \");\n        }, $NightmareHunterDeep_eval_game_system_specific_command$2.$$arity = 1);\n        \n        Opal.def(self, '$result_text', $NightmareHunterDeep_result_text$5 = function $$result_text(total, cmp_op, target) {\n          var self = this, success_lv = nil, success_nl = nil;\n\n          \n          if (cmp_op['$=='](\">=\")) {\n          } else {\n            return nil\n          };\n          if ($truthy(target['$!='](\"?\"))) {\n            return (function() {if ($truthy($rb_ge(total, target))) {\n              return \"成功\"\n            } else {\n              return \"失敗\"\n            }; return nil; })()};\n          success_lv = $rb_divide($rb_plus(total, 1), 5).$to_i();\n          success_nl = $rb_divide($rb_minus(total, 5), 5).$to_i();\n          return (function() {if ($truthy($rb_gt(success_lv, 0))) {\n            return \"\" + \"Lv\" + (success_lv) + \"/NL\" + (success_nl) + \"成功\"\n          } else {\n            return \"失敗\"\n          }; return nil; })();\n        }, $NightmareHunterDeep_result_text$5.$$arity = 3);\n        \n        Opal.def(self, '$fate', $NightmareHunterDeep_fate$6 = function $$fate(dice_list) {\n          var self = this;\n\n          if ($truthy($rb_gt(dice_list.$count(1), 0))) {\n            return \"宿命獲得\"\n          } else {\n            return nil\n          }\n        }, $NightmareHunterDeep_fate$6.$$arity = 1);\n        \n        Opal.def(self, '$interim_expr', $NightmareHunterDeep_interim_expr$7 = function $$interim_expr(cmd, dice_total, dice_list) {\n          var self = this, $ret_or_1 = nil, modifier = nil;\n\n          if ($truthy((function() {if ($truthy(($ret_or_1 = $rb_gt(dice_list.$size(), 1)))) {\n            return $ret_or_1\n          } else {\n            return cmd.$modify_number()['$!='](0)\n          }; return nil; })())) {\n            \n            modifier = $$($nesting, 'Format').$modifier(cmd.$modify_number());\n            return \"\" + (dice_total) + \"[\" + (dice_list.$join(\",\")) + \"]\" + (modifier);\n          } else {\n            return nil\n          }\n        }, $NightmareHunterDeep_interim_expr$7.$$arity = 3);\n        \n        Opal.def(self, '$expr_with_revision', $NightmareHunterDeep_expr_with_revision$8 = function $$expr_with_revision(total, suffix) {\n          var self = this;\n\n          if ($truthy(suffix)) {\n            return \"\" + (total) + (suffix)\n          } else {\n            return nil\n          }\n        }, $NightmareHunterDeep_expr_with_revision$8.$$arity = 2);\n        return (Opal.def(self, '$dice_revision', $NightmareHunterDeep_dice_revision$9 = function $$dice_revision(dice_list) {\n          var self = this, count6 = nil;\n\n          \n          count6 = dice_list.$count(6);\n          if ($truthy($rb_gt(count6, 0))) {\n            return [\"\" + \"+\" + (count6) + \"*4\", $rb_times(count6, 4)]\n          } else {\n            return [nil, 0]\n          };\n        }, $NightmareHunterDeep_dice_revision$9.$$arity = 1), nil) && 'dice_revision';\n      })($nesting[0], $$($nesting, 'Base'), $nesting)\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting);\n})(Opal);\n"],"sourceRoot":"webpack:///"}