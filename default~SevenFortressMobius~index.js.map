{"version":3,"sources":["./node_modules/bcdice/lib/bcdice/game_system/SevenFortressMobius.js"],"names":["require","Opal","modules","self","top","$nesting","nil","$$$","$$","$module","module","$base","$parent_nesting","concat","$Normalize_comparison_operator$1","$Normalize_target_number$2","$module_function","def","$$comparison_operator","op","$case","$$arity","$$target_number","val","$to_i","$rb_gt","lhs","rhs","$truthy","truthy","$Format_comparison_operator$1","$Format_modifier$2","$to_s","$$modifier","number","$rb_plus","$rb_minus","$klass","klass","$send2","send2","$send","send","$require","$super","$NightWizard_initialize$1","$NightWizard_eval_game_system_specific_command$2","$NightWizard_parse_nw$7","$NightWizard_parse_2r6$8","$NightWizard_roll_nw$9","$NightWizard_roll_once$10","$NightWizard_roll_once_first$11","$NightWizard_fumble_base_number$12","$$prototype","nw_command","randomizer","total","interim_expr","status","fumble_numbers","critical_numbers","const_set","$register_prefix","$$initialize","command","$iter","$$p","$yield","find_super_dispatcher","$$eval_game_system_specific_command","string","$a","$b","cmd","$ret_or_1","result","sequence","$parse_nw","$parse_2r6","$roll_nw","to_ary","$cmp_op","$target_number","$compact","$join","$private","$attr_accessor","$ParsedNW_initialize$3","$ParsedNW_passive_modify_number$4","$ParsedNW_to_s$5","base","modify_number","active_modify_number","prana","cmp_op","target_number","$$passive_modify_number","$$to_s","dollar","$ret_or_2","$modifier","$Parsed2R6_to_s$6","passive_modify_number","$$parse_nw","m","$writer","regexp","$match","$new","to_a","$eval","$split","$to_proc","$comparison_operator","$$parse_2r6","$$roll_nw","parsed","$ret_or_3","dice_list","prana_bonus","prana_list","$critical_numbers","$fumble_numbers","$roll_once_first","$roll_once","$prana","$roll_barabara","$sum","$fumble_base_number","$passive_modify_number","$active_modify_number","$$roll_once","fumbleable","dice_value","dice_str","$ret_or_4","$$roll_once_first","$$fumble_base_number","$SevenFortressMobius_initialize$1"],"mappings":"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","file":"default~SevenFortressMobius~index.js","sourcesContent":["require('./../opal');\n\n/* Generated by Opal 1.1.1 */\nOpal.modules[\"bcdice/normalize\"] = function(Opal) {\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module;\n\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'Normalize');\n\n      var $nesting = [self].concat($parent_nesting), $Normalize_comparison_operator$1, $Normalize_target_number$2;\n\n      \n      self.$module_function();\n      \n      Opal.def(self, '$comparison_operator', $Normalize_comparison_operator$1 = function $$comparison_operator(op) {\n        var self = this, $case = nil;\n\n        return (function() {$case = op;\n        if (/<=|=</['$===']($case)) {return \"<=\"}\n        else if (/>=|=>/['$===']($case)) {return \">=\"}\n        else if (/<>|!=|=!/['$===']($case)) {return \"!=\"}\n        else if (/</['$===']($case)) {return \"<\"}\n        else if (/>/['$===']($case)) {return \">\"}\n        else if (/=/['$===']($case)) {return \"==\"}\n        else { return nil }})()\n      }, $Normalize_comparison_operator$1.$$arity = 1);\n      \n      Opal.def(self, '$target_number', $Normalize_target_number$2 = function $$target_number(val) {\n        var self = this;\n\n        if (val['$=='](\"?\")) {\n          return val\n        } else {\n          return val.$to_i()\n        }\n      }, $Normalize_target_number$2.$$arity = 1);\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting)\n};\n\n/* Generated by Opal 1.1.1 */\nOpal.modules[\"bcdice/format\"] = function(Opal) {\n  function $rb_gt(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);\n  }\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $truthy = Opal.truthy;\n\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'Format');\n\n      var $nesting = [self].concat($parent_nesting), $Format_comparison_operator$1, $Format_modifier$2;\n\n      \n      self.$module_function();\n      \n      Opal.def(self, '$comparison_operator', $Format_comparison_operator$1 = function $$comparison_operator(op) {\n        var self = this, $case = nil;\n\n        return (function() {$case = op;\n        if (\"==\"['$===']($case)) {return \"=\"}\n        else if (\"!=\"['$===']($case)) {return \"<>\"}\n        else if ($$($nesting, 'Symbol')['$===']($case)) {return op.$to_s()}\n        else { return nil }})()\n      }, $Format_comparison_operator$1.$$arity = 1);\n      \n      Opal.def(self, '$modifier', $Format_modifier$2 = function $$modifier(number) {\n        var self = this;\n\n        if ($truthy(number['$nil?']())) {\n          return nil\n        } else if (number['$=='](0)) {\n          return \"\"\n        } else if ($truthy($rb_gt(number, 0))) {\n          return \"\" + \"+\" + (number)\n        } else {\n          return number.$to_s()\n        }\n      }, $Format_modifier$2.$$arity = 1);\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting)\n};\n\n/* Generated by Opal 1.1.1 */\nOpal.modules[\"bcdice/game_system/NightWizard\"] = function(Opal) {\n  function $rb_plus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);\n  }\n  function $rb_minus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);\n  }\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $klass = Opal.klass, $send2 = Opal.send2, $truthy = Opal.truthy, $send = Opal.send;\n\n  \n  self.$require(\"bcdice/normalize\");\n  self.$require(\"bcdice/format\");\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'GameSystem');\n\n      var $nesting = [self].concat($parent_nesting);\n\n      (function($base, $super, $parent_nesting) {\n        var self = $klass($base, $super, 'NightWizard');\n\n        var $nesting = [self].concat($parent_nesting), $NightWizard_initialize$1, $NightWizard_eval_game_system_specific_command$2, $NightWizard_parse_nw$7, $NightWizard_parse_2r6$8, $NightWizard_roll_nw$9, $NightWizard_roll_once$10, $NightWizard_roll_once_first$11, $NightWizard_fumble_base_number$12;\n\n        self.$$prototype.nw_command = self.$$prototype.randomizer = self.$$prototype.total = self.$$prototype.interim_expr = self.$$prototype.status = self.$$prototype.fumble_numbers = self.$$prototype.critical_numbers = nil;\n        \n        Opal.const_set($nesting[0], 'ID', \"NightWizard\");\n        Opal.const_set($nesting[0], 'NAME', \"ナイトウィザード The 2nd Edition\");\n        Opal.const_set($nesting[0], 'SORT_KEY', \"ないとういさあと2\");\n        Opal.const_set($nesting[0], 'HELP_MESSAGE', \"\" + \"・判定用コマンド　(aNW+b@x#y$z+c)\\n\" + \"　　a : 基本値\\n\" + \"　　b : 常時に準じる特技による補正\\n\" + \"　　c : 常時以外の特技、および支援効果による補正（ファンブル時には適用されない）\\n\" + \"　　x : クリティカル値のカンマ区切り（省略時 10）\\n\" + \"　　y : ファンブル値のカンマ区切り（省略時 5）\\n\" + \"　　z : プラーナによる達成値補正のプラーナ消費数（ファンブル時には適用されない）\\n\" + \"　クリティカル値、ファンブル値が無い場合は1や13などのあり得ない数値を入れてください。\\n\" + \"　例）12NW-5@7#2$3 1NW 50nw+5@7,10#2,5 50nw-5+10@7,10#2,5+15+25\\n\");\n        self.$register_prefix(\"([-+]?\\\\d+)?NW\", \"2R6\");\n        \n        Opal.def(self, '$initialize', $NightWizard_initialize$1 = function $$initialize(command) {\n          var $iter = $NightWizard_initialize$1.$$p, $yield = $iter || nil, self = this;\n\n          if ($iter) $NightWizard_initialize$1.$$p = null;\n          \n          $send2(self, Opal.find_super_dispatcher(self, 'initialize', $NightWizard_initialize$1, false, true), 'initialize', [command], null);\n          return (self.nw_command = \"NW\");\n        }, $NightWizard_initialize$1.$$arity = 1);\n        \n        Opal.def(self, '$eval_game_system_specific_command', $NightWizard_eval_game_system_specific_command$2 = function $$eval_game_system_specific_command(string) {\n          var $a, $b, self = this, cmd = nil, $ret_or_1 = nil, total = nil, interim_expr = nil, status = nil, result = nil, sequence = nil;\n\n          \n          cmd = (function() {if ($truthy(($ret_or_1 = self.$parse_nw(string)))) {\n            return $ret_or_1\n          } else {\n            return self.$parse_2r6(string)\n          }; return nil; })();\n          if ($truthy(cmd)) {\n          } else {\n            return nil\n          };\n          $b = self.$roll_nw(cmd), $a = Opal.to_ary($b), (total = ($a[0] == null ? nil : $a[0])), (interim_expr = ($a[1] == null ? nil : $a[1])), (status = ($a[2] == null ? nil : $a[2])), $b;\n          result = (function() {if ($truthy(cmd.$cmp_op())) {\n            if ($truthy(total.$send(cmd.$cmp_op(), cmd.$target_number()))) {\n              return \"成功\"\n            } else {\n              return \"失敗\"\n            }\n          } else {\n            return nil\n          }; return nil; })();\n          sequence = [\"\" + \"(\" + (cmd) + \")\", interim_expr, status, total.$to_s(), result].$compact();\n          return sequence.$join(\" ＞ \");\n        }, $NightWizard_eval_game_system_specific_command$2.$$arity = 1);\n        self.$private();\n        (function($base, $super, $parent_nesting) {\n          var self = $klass($base, $super, 'Parsed');\n\n          var $nesting = [self].concat($parent_nesting);\n\n          \n          self.$attr_accessor(\"critical_numbers\");\n          self.$attr_accessor(\"fumble_numbers\");\n          self.$attr_accessor(\"prana\");\n          self.$attr_accessor(\"active_modify_number\");\n          self.$attr_accessor(\"cmp_op\");\n          return self.$attr_accessor(\"target_number\");\n        })($nesting[0], null, $nesting);\n        (function($base, $super, $parent_nesting) {\n          var self = $klass($base, $super, 'ParsedNW');\n\n          var $nesting = [self].concat($parent_nesting), $ParsedNW_initialize$3, $ParsedNW_passive_modify_number$4, $ParsedNW_to_s$5;\n\n          self.$$prototype.base = self.$$prototype.modify_number = self.$$prototype.active_modify_number = self.$$prototype.prana = self.$$prototype.command = self.$$prototype.critical_numbers = self.$$prototype.fumble_numbers = self.$$prototype.cmp_op = self.$$prototype.target_number = nil;\n          \n          self.$attr_accessor(\"base\");\n          self.$attr_accessor(\"modify_number\");\n          \n          Opal.def(self, '$initialize', $ParsedNW_initialize$3 = function $$initialize(command) {\n            var $iter = $ParsedNW_initialize$3.$$p, $yield = $iter || nil, self = this;\n\n            if ($iter) $ParsedNW_initialize$3.$$p = null;\n            \n            $send2(self, Opal.find_super_dispatcher(self, 'initialize', $ParsedNW_initialize$3, false, true), 'initialize', [], null);\n            return (self.command = command);\n          }, $ParsedNW_initialize$3.$$arity = 1);\n          \n          Opal.def(self, '$passive_modify_number', $ParsedNW_passive_modify_number$4 = function $$passive_modify_number() {\n            var self = this;\n\n            return $rb_plus(self.base, self.modify_number)\n          }, $ParsedNW_passive_modify_number$4.$$arity = 0);\n          return (Opal.def(self, '$to_s', $ParsedNW_to_s$5 = function $$to_s() {\n            var self = this, base = nil, modify_number = nil, active_modify_number = nil, dollar = nil, $ret_or_2 = nil;\n\n            \n            base = (function() {if ($truthy(self.base['$zero?']())) {\n              return nil\n            } else {\n              return self.base\n            }; return nil; })();\n            modify_number = $$($nesting, 'Format').$modifier(self.modify_number);\n            active_modify_number = $$($nesting, 'Format').$modifier(self.active_modify_number);\n            dollar = (function() {if ($truthy(($ret_or_2 = self.prana))) {\n              return \"\" + \"$\" + (self.prana)\n            } else {\n              return $ret_or_2\n            }; return nil; })();\n            return \"\" + (base) + (self.command) + (modify_number) + \"@\" + (self.critical_numbers.$join(\",\")) + \"#\" + (self.fumble_numbers.$join(\",\")) + (dollar) + (active_modify_number) + (self.cmp_op) + (self.target_number);\n          }, $ParsedNW_to_s$5.$$arity = 0), nil) && 'to_s';\n        })($nesting[0], $$($nesting, 'Parsed'), $nesting);\n        (function($base, $super, $parent_nesting) {\n          var self = $klass($base, $super, 'Parsed2R6');\n\n          var $nesting = [self].concat($parent_nesting), $Parsed2R6_to_s$6;\n\n          self.$$prototype.passive_modify_number = self.$$prototype.active_modify_number = self.$$prototype.critical_numbers = self.$$prototype.fumble_numbers = self.$$prototype.cmp_op = self.$$prototype.target_number = nil;\n          \n          self.$attr_accessor(\"passive_modify_number\");\n          return (Opal.def(self, '$to_s', $Parsed2R6_to_s$6 = function $$to_s() {\n            var self = this;\n\n            return \"\" + \"2R6M[\" + (self.passive_modify_number) + \",\" + (self.active_modify_number) + \"]C[\" + (self.critical_numbers.$join(\",\")) + \"]F[\" + (self.fumble_numbers.$join(\",\")) + \"]\" + (self.cmp_op) + (self.target_number)\n          }, $Parsed2R6_to_s$6.$$arity = 0), nil) && 'to_s';\n        })($nesting[0], $$($nesting, 'Parsed'), $nesting);\n        \n        Opal.def(self, '$parse_nw', $NightWizard_parse_nw$7 = function $$parse_nw(string) {\n          var $a, $b, self = this, m = nil, command = nil, $writer = nil;\n\n          \n          m = Opal.regexp([\"^([-+]?\\\\d+)?\", self.nw_command, \"((?:[-+]\\\\d+)+)?(?:@(\\\\d+(?:,\\\\d+)*))?(?:#(\\\\d+(?:,\\\\d+)*))?(?:\\\\$(\\\\d+(?:,\\\\d+)*))?((?:[-+]\\\\d+)+)?(?:([>=]+)(\\\\d+))?$\"]).$match(string);\n          if ($truthy(m)) {\n          } else {\n            return nil\n          };\n          command = $$($nesting, 'ParsedNW').$new(self.nw_command);\n          \n          $writer = [m['$[]'](1).$to_i()];\n          $send(command, 'base=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          \n          $writer = [$$($nesting, 'ArithmeticEvaluator').$eval(m['$[]'](2))];\n          $send(command, 'modify_number=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          \n          $writer = [(function() {if ($truthy(m['$[]'](3))) {\n            return $send(m['$[]'](3).$split(\",\"), 'map', [], \"to_i\".$to_proc())\n          } else {\n            return [10]\n          }; return nil; })()];\n          $send(command, 'critical_numbers=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          \n          $writer = [(function() {if ($truthy(m['$[]'](4))) {\n            return $send(m['$[]'](4).$split(\",\"), 'map', [], \"to_i\".$to_proc())\n          } else {\n            return [5]\n          }; return nil; })()];\n          $send(command, 'fumble_numbers=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          \n          $writer = [($a = m['$[]'](5), ($a === nil || $a == null) ? nil : $send($a, 'to_i', []))];\n          $send(command, 'prana=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          \n          $writer = [$$($nesting, 'ArithmeticEvaluator').$eval(m['$[]'](6))];\n          $send(command, 'active_modify_number=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          \n          $writer = [$$($nesting, 'Normalize').$comparison_operator(m['$[]'](7))];\n          $send(command, 'cmp_op=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          \n          $writer = [($b = m['$[]'](8), ($b === nil || $b == null) ? nil : $send($b, 'to_i', []))];\n          $send(command, 'target_number=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          return command;\n        }, $NightWizard_parse_nw$7.$$arity = 1);\n        \n        Opal.def(self, '$parse_2r6', $NightWizard_parse_2r6$8 = function $$parse_2r6(string) {\n          var $a, self = this, m = nil, command = nil, $writer = nil;\n\n          \n          m = /^2R6m\\[([-+]?\\d+(?:[-+]\\d+)*)(?:,([-+]?\\d+(?:[-+]\\d+)*))?\\](?:c\\[(\\d+(?:,\\d+)*)\\])?(?:f\\[(\\d+(?:,\\d+)*)\\])?(?:([>=]+)(\\d+))?/i.$match(string);\n          if ($truthy(m)) {\n          } else {\n            return nil\n          };\n          command = $$($nesting, 'Parsed2R6').$new();\n          \n          $writer = [$$($nesting, 'ArithmeticEvaluator').$eval(m['$[]'](1))];\n          $send(command, 'passive_modify_number=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          \n          $writer = [$$($nesting, 'ArithmeticEvaluator').$eval(m['$[]'](2))];\n          $send(command, 'active_modify_number=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          \n          $writer = [(function() {if ($truthy(m['$[]'](3))) {\n            return $send(m['$[]'](3).$split(\",\"), 'map', [], \"to_i\".$to_proc())\n          } else {\n            return [10]\n          }; return nil; })()];\n          $send(command, 'critical_numbers=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          \n          $writer = [(function() {if ($truthy(m['$[]'](4))) {\n            return $send(m['$[]'](4).$split(\",\"), 'map', [], \"to_i\".$to_proc())\n          } else {\n            return [5]\n          }; return nil; })()];\n          $send(command, 'fumble_numbers=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          \n          $writer = [$$($nesting, 'Normalize').$comparison_operator(m['$[]'](5))];\n          $send(command, 'cmp_op=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          \n          $writer = [($a = m['$[]'](6), ($a === nil || $a == null) ? nil : $send($a, 'to_i', []))];\n          $send(command, 'target_number=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          return command;\n        }, $NightWizard_parse_2r6$8.$$arity = 1);\n        \n        Opal.def(self, '$roll_nw', $NightWizard_roll_nw$9 = function $$roll_nw(parsed) {\n          var $a, self = this, status = nil, $ret_or_3 = nil, dice_list = nil, prana_bonus = nil, prana_list = nil, base = nil;\n\n          \n          self.critical_numbers = parsed.$critical_numbers();\n          self.fumble_numbers = parsed.$fumble_numbers();\n          self.total = 0;\n          self.interim_expr = \"\";\n          self.status = nil;\n          status = self.$roll_once_first();\n          while (status['$=='](\"critical\")) {\n            status = self.$roll_once()\n          };\n          if ($truthy((function() {if ($truthy(($ret_or_3 = status['$!='](\"fumble\")))) {\n            return parsed.$prana()\n          } else {\n            return $ret_or_3\n          }; return nil; })())) {\n            \n            dice_list = self.randomizer.$roll_barabara(parsed.$prana(), 6);\n            prana_bonus = dice_list.$sum();\n            prana_list = dice_list.$join(\",\");\n            self.total = $rb_plus(self.total, prana_bonus);\n            self.interim_expr = $rb_plus(self.interim_expr, \"\" + \"+\" + (prana_bonus) + \"[\" + (prana_list) + \"]\");};\n          base = (function() {if (status['$=='](\"fumble\")) {\n            return self.$fumble_base_number(parsed)\n          } else {\n            return $rb_plus(parsed.$passive_modify_number(), parsed.$active_modify_number())\n          }; return nil; })();\n          self.total = $rb_plus(self.total, base);\n          self.interim_expr = $rb_plus(base.$to_s(), self.interim_expr);\n          return [self.total, self.interim_expr, self.status];\n        }, $NightWizard_roll_nw$9.$$arity = 1);\n        \n        Opal.def(self, '$roll_once', $NightWizard_roll_once$10 = function $$roll_once(fumbleable) {\n          var self = this, dice_list = nil, dice_value = nil, dice_str = nil, $ret_or_4 = nil;\n\n          \n          \n          if (fumbleable == null) {\n            fumbleable = false;\n          };\n          dice_list = self.randomizer.$roll_barabara(2, 6);\n          dice_value = dice_list.$sum();\n          dice_str = dice_list.$join(\",\");\n          if ($truthy((function() {if ($truthy(($ret_or_4 = fumbleable))) {\n            return self.fumble_numbers['$include?'](dice_value)\n          } else {\n            return $ret_or_4\n          }; return nil; })())) {\n            \n            self.total = $rb_minus(self.total, 10);\n            self.interim_expr = $rb_plus(self.interim_expr, \"\" + \"-10[\" + (dice_str) + \"]\");\n            self.status = \"ファンブル\";\n            return \"fumble\";\n          } else if ($truthy(self.critical_numbers['$include?'](dice_value))) {\n            \n            self.total = $rb_plus(self.total, 10);\n            self.interim_expr = $rb_plus(self.interim_expr, \"\" + \"+10[\" + (dice_str) + \"]\");\n            self.status = \"クリティカル\";\n            return \"critical\";\n          } else {\n            \n            self.total = $rb_plus(self.total, dice_value);\n            self.interim_expr = $rb_plus(self.interim_expr, \"\" + \"+\" + (dice_value) + \"[\" + (dice_str) + \"]\");\n            return nil;\n          };\n        }, $NightWizard_roll_once$10.$$arity = -1);\n        \n        Opal.def(self, '$roll_once_first', $NightWizard_roll_once_first$11 = function $$roll_once_first() {\n          var self = this;\n\n          return self.$roll_once(true)\n        }, $NightWizard_roll_once_first$11.$$arity = 0);\n        return (Opal.def(self, '$fumble_base_number', $NightWizard_fumble_base_number$12 = function $$fumble_base_number(parsed) {\n          var self = this;\n\n          return parsed.$passive_modify_number()\n        }, $NightWizard_fumble_base_number$12.$$arity = 1), nil) && 'fumble_base_number';\n      })($nesting[0], $$($nesting, 'Base'), $nesting)\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting);\n};\n\n/* Generated by Opal 1.1.1 */\n(function(Opal) {\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $klass = Opal.klass, $send2 = Opal.send2;\n\n  \n  self.$require(\"bcdice/game_system/NightWizard\");\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'GameSystem');\n\n      var $nesting = [self].concat($parent_nesting);\n\n      (function($base, $super, $parent_nesting) {\n        var self = $klass($base, $super, 'SevenFortressMobius');\n\n        var $nesting = [self].concat($parent_nesting), $SevenFortressMobius_initialize$1;\n\n        \n        Opal.const_set($nesting[0], 'ID', \"SevenFortressMobius\");\n        Opal.const_set($nesting[0], 'NAME', \"セブン＝フォートレス メビウス\");\n        Opal.const_set($nesting[0], 'SORT_KEY', \"せふんふおおとれすめひうす\");\n        Opal.const_set($nesting[0], 'HELP_MESSAGE', \"\" + \"・判定用コマンド　(nSFM+m@x#y)\\n\" + \"　\\\"(基本値)SFM(常時および常時に準じる特技等及び状態異常（省略可）)@(クリティカル値)#(ファンブル値)（常時以外の特技等及び味方の支援効果等の影響（省略可））\\\"でロールします。\\n\" + \"　Rコマンド(2R6m[n,m]c[x]f[y]>=t tは目標値)に読替されます。\\n\" + \"　クリティカル値、ファンブル値が無い場合は1や13などのあり得ない数値を入れてください。\\n\" + \"　例）12SFM-5@7#2　　1SFM　　50SFM+5@7,10#2,5　50SFM-5+10@7,10#2,5+15+25\\n\");\n        self.$register_prefix(\"([-+]?\\\\d+)?SFM\", \"2R6\");\n        return (Opal.def(self, '$initialize', $SevenFortressMobius_initialize$1 = function $$initialize(command) {\n          var $iter = $SevenFortressMobius_initialize$1.$$p, $yield = $iter || nil, self = this;\n\n          if ($iter) $SevenFortressMobius_initialize$1.$$p = null;\n          \n          $send2(self, Opal.find_super_dispatcher(self, 'initialize', $SevenFortressMobius_initialize$1, false, true), 'initialize', [command], null);\n          return (self.nw_command = \"SFM\");\n        }, $SevenFortressMobius_initialize$1.$$arity = 1), nil) && 'initialize';\n      })($nesting[0], $$($nesting, 'NightWizard'), $nesting)\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting);\n})(Opal);\n"],"sourceRoot":"webpack:///"}