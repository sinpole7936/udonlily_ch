{"version":3,"sources":["./node_modules/bcdice/lib/bcdice/game_system/SkynautsBouken.js"],"names":["require","Opal","$rb_le","lhs","rhs","$rb_ge","$rb_minus","$rb_plus","self","top","$nesting","nil","$$$","$$","$module","module","$klass","klass","$hash2","hash2","$send2","send2","$truthy","truthy","$hash","hash","$send","send","$range","range","$base","$parent_nesting","concat","$super","$SkynautsBouken_initialize$1","$SkynautsBouken_eval_game_system_specific_command$2","$SkynautsBouken_command_sn$3","$SkynautsBouken_command_d$4","$SkynautsBouken_command_avo$5","$SkynautsBouken_command_snavo$7","$SkynautsBouken_command_snd$8","$SkynautsBouken_get_points_text$9","$SkynautsBouken_get_xy_text$12","$SkynautsBouken_get_fire_points$13","$$prototype","randomizer","const_set","$new","$freeze","$register_prefix","def","$$initialize","command","$iter","$$p","$yield","find_super_dispatcher","round_type","$$arity","$$eval_game_system_specific_command","$ret_or_1","$ret_or_2","$ret_or_3","$ret_or_4","$ret_or_5","$command_sn","$command_d","$command_avo","$command_snavo","$command_snd","$roll_tables","$private","$$command_sn","$a","$b","cmd","dice_count","target","fumble","dice_list","dice_top_two","res","$writer","$debug","$round_type","$restrict_cmp_op_to","$enable_fumble","$parse","$command","$split","$to_proc","to_ary","$fumble","$roll_barabara","$sort","$critical","$max","$sum","$success","$failure","$join","$text","$compact","to_a","$$command_d","m","fire_count","fire_range","ballistics","points","result","dir","diff_x","diff_y","$match","$to_i","$to_s","$get_fire_points","$sub","$get_points_text","$$command_avo","$$6","dmg","$$s","y","x","$last_match","$get_xy_text","$$command_snavo","sn","avo","am","$$command_snd","d","$$get_points_text","$$10","list","$$11","$$get_xy_text","$ret_or_6","$$get_fire_points","$$14","$chars","$times","$$15","$roll_once","$roll_sum","r","xdiff","ydiff"],"mappings":"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","file":"default~SkynautsBouken~index.js","sourcesContent":["require('./../opal');\n\n/* Generated by Opal 1.1.1 */\n(function(Opal) {\n  function $rb_le(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs <= rhs : lhs['$<='](rhs);\n  }\n  function $rb_ge(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs >= rhs : lhs['$>='](rhs);\n  }\n  function $rb_minus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);\n  }\n  function $rb_plus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);\n  }\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2, $send2 = Opal.send2, $truthy = Opal.truthy, $hash = Opal.hash, $send = Opal.send, $range = Opal.range;\n\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'GameSystem');\n\n      var $nesting = [self].concat($parent_nesting);\n\n      (function($base, $super, $parent_nesting) {\n        var self = $klass($base, $super, 'SkynautsBouken');\n\n        var $nesting = [self].concat($parent_nesting), $SkynautsBouken_initialize$1, $SkynautsBouken_eval_game_system_specific_command$2, $SkynautsBouken_command_sn$3, $SkynautsBouken_command_d$4, $SkynautsBouken_command_avo$5, $SkynautsBouken_command_snavo$7, $SkynautsBouken_command_snd$8, $SkynautsBouken_get_points_text$9, $SkynautsBouken_get_xy_text$12, $SkynautsBouken_get_fire_points$13;\n\n        self.$$prototype.randomizer = nil;\n        \n        Opal.const_set($nesting[0], 'ID', \"SkynautsBouken\");\n        Opal.const_set($nesting[0], 'NAME', \"歯車の塔の探空士（冒険企画局）\");\n        Opal.const_set($nesting[0], 'SORT_KEY', \"はくるまのとうのすかいのおつ2\");\n        Opal.const_set($nesting[0], 'HELP_MESSAGE', \"\" + \"・行為判定（nSNt#f） n:ダイス数(省略時2)、t:目標値(省略時7)、f:ファンブル値(省略時1)\\n\" + \"    例）SN6#2　3SN\\n\" + \"・ダメージチェック (Dx/y@m) x:ダメージ範囲、y:攻撃回数\\n\" + \"　　m:《弾道学》（省略可）上:8、下:2、左:4、右:6\\n\" + \"　　例） D/4　D19/2　D/3@8　D[大揺れ]/2\\n\" + \"・回避(AVO@mダメージ)\\n\" + \"　　m:回避方向（上:8、下:2、左:4、右:6）、ダメージ：ダメージチェック結果\\n\" + \"　　例）AVO@8[1,4],[2,6],[3,8]　AVO@2[6,4],[2,6]\\n\" + \"・FT ファンブル表(p76)\\n\" + \"・NV 航行表\\n\" + \"\\n\" + \"■ 判定セット\\n\" + \"・《回避運動》判定+回避（nSNt#f/AVO@ダメージ）\\n\" + \"　　nSNt#f → 成功なら AVO@m\\n\" + \"　　例）SN/AVO@8[1,4],[2,6],[3,8]　3SN#2/AVO@2[6,4],[2,6]\\n\" + \"・砲撃判定+ダメージチェック　(nSNt#f/Dx/y@m)\\n\" + \"　　行為判定の出目変更タイミングを逃すので要GMの許可\\n\" + \"　　nSNt#f → 成功なら Dx/y@m\\n\" + \"　　例）SN/D/4　3SN#2/D[大揺れ]/2\\n\");\n        Opal.const_set($nesting[0], 'TABLES', $hash2([\"FT\", \"NV\"], {\"FT\": $$$($$($nesting, 'DiceTable'), 'Table').$new(\"ファンブル表\", \"1D6\", [\"なんとか大事にはいたらなかった。通常の失敗と同様の処理を行うこと。\", \"転んでしまった。キミは[転倒](p107)する。\", \"失敗にイライラしてしまった。キミは獲得している【キズナ】1つの「支援チェック」にチェックを入れる。\", \"自身のいるマスを[破損](p104)させる。この[破損]によって、キミの【生命点】は減少しない。\", \"頭をぶつけてしまった。キミの【生命点】を「1d6点」減少する。\", \"奇跡的な結果。 この行為判定は成功となる。\"]), \"NV\": $$$($$($nesting, 'DiceTable'), 'Table').$new(\"航海表\", \"1d6\", [\"スポット1つ分進む\", \"スポット1つ分進む\", \"スポット1つ分進む\", \"スポット2つ分進む\", \"スポット2つ分進む\", \"スポット3つ分進む\"])}).$freeze());\n        self.$register_prefix(\"D\", \"\\\\d?SN\", \"NV\", \"FT\", \"AVO\");\n        \n        Opal.def(self, '$initialize', $SkynautsBouken_initialize$1 = function $$initialize(command) {\n          var $iter = $SkynautsBouken_initialize$1.$$p, $yield = $iter || nil, self = this;\n\n          if ($iter) $SkynautsBouken_initialize$1.$$p = null;\n          \n          $send2(self, Opal.find_super_dispatcher(self, 'initialize', $SkynautsBouken_initialize$1, false, true), 'initialize', [command], null);\n          return (self.round_type = $$$($$($nesting, 'RoundType'), 'FLOOR'));\n        }, $SkynautsBouken_initialize$1.$$arity = 1);\n        \n        Opal.def(self, '$eval_game_system_specific_command', $SkynautsBouken_eval_game_system_specific_command$2 = function $$eval_game_system_specific_command(command) {\n          var self = this, $ret_or_1 = nil, $ret_or_2 = nil, $ret_or_3 = nil, $ret_or_4 = nil, $ret_or_5 = nil;\n\n          if ($truthy(($ret_or_1 = (function() {if ($truthy(($ret_or_2 = (function() {if ($truthy(($ret_or_3 = (function() {if ($truthy(($ret_or_4 = (function() {if ($truthy(($ret_or_5 = self.$command_sn(command)))) {\n            return $ret_or_5\n          } else {\n            return self.$command_d(command)\n          }; return nil; })()))) {\n            return $ret_or_4\n          } else {\n            return self.$command_avo(command)\n          }; return nil; })()))) {\n            return $ret_or_3\n          } else {\n            return self.$command_snavo(command)\n          }; return nil; })()))) {\n            return $ret_or_2\n          } else {\n            return self.$command_snd(command)\n          }; return nil; })()))) {\n            return $ret_or_1\n          } else {\n            return self.$roll_tables(command, $$($nesting, 'TABLES'))\n          }\n        }, $SkynautsBouken_eval_game_system_specific_command$2.$$arity = 1);\n        self.$private();\n        Opal.const_set($nesting[0], 'DIRECTION_INFOS', $hash(0, $hash2([\"name\", \"position_diff\"], {\"name\": \"\", \"position_diff\": [0, 0]}), 1, $hash2([\"name\", \"position_diff\"], {\"name\": \"左下\", \"position_diff\": [-1, 1]}), 2, $hash2([\"name\", \"position_diff\"], {\"name\": \"下\", \"position_diff\": [0, 1]}), 3, $hash2([\"name\", \"position_diff\"], {\"name\": \"右下\", \"position_diff\": [1, 1]}), 4, $hash2([\"name\", \"position_diff\"], {\"name\": \"左\", \"position_diff\": [-1, 0]}), 5, $hash2([\"name\", \"position_diff\"], {\"name\": \"\", \"position_diff\": [0, 0]}), 6, $hash2([\"name\", \"position_diff\"], {\"name\": \"右\", \"position_diff\": [1, 0]}), 7, $hash2([\"name\", \"position_diff\"], {\"name\": \"左上\", \"position_diff\": [-1, -1]}), 8, $hash2([\"name\", \"position_diff\"], {\"name\": \"上\", \"position_diff\": [0, -1]}), 9, $hash2([\"name\", \"position_diff\"], {\"name\": \"右上\", \"position_diff\": [1, -1]})).$freeze());\n        Opal.const_set($nesting[0], 'D_REGEXP', /^D([1-46-9]{0,8})(\\[.+\\]|S|F|SF|FS)?\\/(\\d{1,2})(@([2468]))?$/.$freeze());\n        \n        Opal.def(self, '$command_sn', $SkynautsBouken_command_sn$3 = function $$command_sn(command) {\n          var $a, $b, self = this, cmd = nil, dice_count = nil, target = nil, fumble = nil, dice_list = nil, dice_top_two = nil, res = nil, $writer = nil;\n\n          \n          self.$debug(\"SN\", command);\n          cmd = $$$($$($nesting, 'Command'), 'Parser').$new(/[1-9]?SN(\\d{0,2})/, $hash2([\"round_type\"], {\"round_type\": self.$round_type()})).$restrict_cmp_op_to(nil).$enable_fumble().$parse(command);\n          if ($truthy(cmd)) {\n          } else {\n            return nil\n          };\n          $b = $send(cmd.$command().$split(\"SN\", 2), 'map', [], \"to_i\".$to_proc()), $a = Opal.to_ary($b), (dice_count = ($a[0] == null ? nil : $a[0])), (target = ($a[1] == null ? nil : $a[1])), $b;\n          if (dice_count['$=='](0)) {\n            dice_count = 2};\n          if (target['$=='](0)) {\n            target = 7};\n          fumble = (function() {if ($truthy(cmd.$fumble()['$nil?']())) {\n            return 1\n          } else {\n            return cmd.$fumble()\n          }; return nil; })();\n          self.$debug(\"SN Parsed\", dice_count, target, fumble);\n          dice_list = self.randomizer.$roll_barabara(dice_count, 6);\n          dice_top_two = dice_list.$sort()['$[]']($range(-2, -1, false));\n          res = (function() {if (dice_top_two['$==']([6, 6])) {\n            return $$($nesting, 'Result').$critical(\"スペシャル（【生命点】1d6回復）\")\n          } else if ($truthy($rb_le(dice_list.$max(), fumble))) {\n            return $$($nesting, 'Result').$fumble(\"ファンブル（ファンブル表FT）\")\n          } else if ($truthy($rb_ge(dice_top_two.$sum(), target))) {\n            return $$($nesting, 'Result').$success(\"成功\")\n          } else {\n            return $$($nesting, 'Result').$failure(\"失敗\")\n          }; return nil; })();\n          if (dice_count['$=='](2)) {\n            \n            $writer = [[\"\" + \"(\" + (dice_count) + \"SN\" + (target) + \"#\" + (fumble) + \")\", \"\" + (dice_top_two.$sum()) + \"[\" + (dice_list.$join(\",\")) + \"]\", res.$text()].$compact().$join(\" ＞ \")];\n            $send(res, 'text=', Opal.to_a($writer));\n            $writer[$rb_minus($writer[\"length\"], 1)];\n          } else {\n            \n            $writer = [[\"\" + \"(\" + (dice_count) + \"SN\" + (target) + \"#\" + (fumble) + \")\", $rb_plus($rb_plus(\"[\", dice_list.$join(\",\")), \"]\"), \"\" + (dice_top_two.$sum()) + \"[\" + (dice_top_two.$join(\",\")) + \"]\", res.$text()].$compact().$join(\" ＞ \")];\n            $send(res, 'text=', Opal.to_a($writer));\n            $writer[$rb_minus($writer[\"length\"], 1)];\n          };\n          return res;\n        }, $SkynautsBouken_command_sn$3.$$arity = 1);\n        \n        Opal.def(self, '$command_d', $SkynautsBouken_command_d$4 = function $$command_d(command) {\n          var $a, $b, self = this, m = nil, fire_count = nil, fire_range = nil, ballistics = nil, points = nil, result = nil, dir = nil, diff_x = nil, diff_y = nil, $writer = nil;\n\n          \n          m = $$($nesting, 'D_REGEXP').$match(command);\n          if ($truthy(m)) {\n          } else {\n            return nil\n          };\n          fire_count = m['$[]'](3).$to_i();\n          fire_range = m['$[]'](1).$to_s();\n          ballistics = m['$[]'](5).$to_i();\n          points = self.$get_fire_points(fire_count, fire_range);\n          command = command.$sub(\"SF/\", \"[大揺れ,火災]/\").$sub(\"FS/\", \"[火災,大揺れ]/\").$sub(\"F/\", \"[火災]/\").$sub(\"S/\", \"[大揺れ]/\");\n          result = [\"\" + \"(\" + (command) + \")\", self.$get_points_text(points, 0, 0)];\n          if ($truthy(ballistics['$!='](0))) {\n            \n            dir = $$($nesting, 'DIRECTION_INFOS')['$[]'](ballistics);\n            $b = dir['$[]'](\"position_diff\"), $a = Opal.to_ary($b), (diff_x = ($a[0] == null ? nil : $a[0])), (diff_y = ($a[1] == null ? nil : $a[1])), $b;\n            \n            $writer = [-1, $rb_plus(result['$[]'](-1), \"\\n\")];\n            $send(result, '[]=', Opal.to_a($writer));\n            $writer[$rb_minus($writer[\"length\"], 1)];;\n            result['$<<'](\"\" + \"《弾道学》\" + (dir['$[]'](\"name\")));\n            result['$<<'](self.$get_points_text(points, diff_x, diff_y));};\n          return result.$compact().$join(\" ＞ \");\n        }, $SkynautsBouken_command_d$4.$$arity = 1);\n        \n        Opal.def(self, '$command_avo', $SkynautsBouken_command_avo$5 = function $$command_avo(command) {\n          var $a, $b, $$6, self = this, dmg = nil, dir = nil, diff_x = nil, diff_y = nil;\n\n          \n          self.$debug(\"AVO\", command);\n          dmg = command.$match(/^AVO@([2468])(.*?)$/);\n          if ($truthy(dmg)) {\n          } else {\n            return nil\n          };\n          dir = $$($nesting, 'DIRECTION_INFOS')['$[]'](dmg['$[]'](1).$to_i());\n          $b = dir['$[]'](\"position_diff\"), $a = Opal.to_ary($b), (diff_x = ($a[0] == null ? nil : $a[0])), (diff_y = ($a[1] == null ? nil : $a[1])), $b;\n          return $rb_plus(\"\" + \"《回避運動》\" + (dir['$[]'](\"name\")) + \" ＞ \", $send(dmg['$[]'](2), 'gsub', [/\\(?\\[(\\d),(\\d{1,2})\\]\\)?/], ($$6 = function(){var self = $$6.$$s == null ? this : $$6.$$s, y = nil, x = nil;\n\n          \n            y = $rb_plus($$($nesting, 'Regexp').$last_match(1).$to_i(), diff_y);\n            x = $rb_plus($$($nesting, 'Regexp').$last_match(2).$to_i(), diff_x);\n            return self.$get_xy_text(x, y);}, $$6.$$s = self, $$6.$$arity = 0, $$6)));\n        }, $SkynautsBouken_command_avo$5.$$arity = 1);\n        \n        Opal.def(self, '$command_snavo', $SkynautsBouken_command_snavo$7 = function $$command_snavo(command) {\n          var $a, $b, self = this, sn = nil, avo = nil, am = nil, res = nil, $writer = nil;\n\n          \n          $b = command.$split(/\\/?AVO/, 2), $a = Opal.to_ary($b), (sn = ($a[0] == null ? nil : $a[0])), (avo = ($a[1] == null ? nil : $a[1])), $b;\n          self.$debug(\"SNAVO\", sn, avo);\n          am = /^@([2468])(.*?)$/.$match(avo);\n          if ($truthy(am)) {\n          } else {\n            return nil\n          };\n          res = self.$command_sn(sn);\n          if ($truthy(res)) {\n          } else {\n            return nil\n          };\n          if ($truthy(res['$success?']())) {\n            \n            $writer = [$rb_plus(res.$text(), $rb_plus(\"\\n ＞ \", self.$command_avo($rb_plus(\"AVO\", avo))))];\n            $send(res, 'text=', Opal.to_a($writer));\n            $writer[$rb_minus($writer[\"length\"], 1)];};\n          return res;\n        }, $SkynautsBouken_command_snavo$7.$$arity = 1);\n        \n        Opal.def(self, '$command_snd', $SkynautsBouken_command_snd$8 = function $$command_snd(command) {\n          var $a, $b, self = this, sn = nil, d = nil, m = nil, res = nil, $writer = nil;\n\n          \n          $b = command.$split(/\\/?D/, 2), $a = Opal.to_ary($b), (sn = ($a[0] == null ? nil : $a[0])), (d = ($a[1] == null ? nil : $a[1])), $b;\n          self.$debug(\"SND\", sn, d);\n          m = $$($nesting, 'D_REGEXP').$match(\"\" + \"D\" + (d));\n          if ($truthy(m)) {\n          } else {\n            return nil\n          };\n          res = self.$command_sn(sn);\n          if ($truthy(res)) {\n          } else {\n            return nil\n          };\n          if ($truthy(res['$success?']())) {\n            \n            $writer = [$rb_plus(res.$text(), \"\" + \"\\n ＞ \" + (self.$command_d($rb_plus(\"D\", d))))];\n            $send(res, 'text=', Opal.to_a($writer));\n            $writer[$rb_minus($writer[\"length\"], 1)];};\n          return res;\n        }, $SkynautsBouken_command_snd$8.$$arity = 1);\n        \n        Opal.def(self, '$get_points_text', $SkynautsBouken_get_points_text$9 = function $$get_points_text(points, diff_x, diff_y) {\n          var $$10, self = this;\n\n          return $rb_plus(\"[縦,横]=\", $send(points, 'map', [], ($$10 = function(list){var self = $$10.$$s == null ? this : $$10.$$s, $$11;\n\n          \n            \n            if (list == null) {\n              list = nil;\n            };\n            return $send(list, 'map', [], ($$11 = function(x, y){var self = $$11.$$s == null ? this : $$11.$$s;\n\n            \n              \n              if (x == null) {\n                x = nil;\n              };\n              \n              if (y == null) {\n                y = nil;\n              };\n              return self.$get_xy_text($rb_plus(x, diff_x), $rb_plus(y, diff_y));}, $$11.$$s = self, $$11.$$arity = 2, $$11)).$join();}, $$10.$$s = self, $$10.$$arity = 1, $$10)).$join(\",\"))\n        }, $SkynautsBouken_get_points_text$9.$$arity = 3);\n        \n        Opal.def(self, '$get_xy_text', $SkynautsBouken_get_xy_text$12 = function $$get_xy_text(x, y) {\n          var self = this, $ret_or_6 = nil;\n\n          if ($truthy((function() {if ($truthy(($ret_or_6 = $range(2, 12, false)['$include?'](x)))) {\n            return $range(1, 6, false)['$include?'](y)\n          } else {\n            return $ret_or_6\n          }; return nil; })())) {\n            return \"\" + \"[\" + (y) + \",\" + (x) + \"]\"\n          } else {\n            return \"\" + \"([\" + (y) + \",\" + (x) + \"])\"\n          }\n        }, $SkynautsBouken_get_xy_text$12.$$arity = 2);\n        return (Opal.def(self, '$get_fire_points', $SkynautsBouken_get_fire_points$13 = function $$get_fire_points(fire_count, fire_range) {\n          var $$14, self = this, range = nil;\n\n          \n          range = $send(fire_range.$chars(), 'map', [], \"to_i\".$to_proc());\n          return $send(fire_count.$times(), 'map', [], ($$14 = function(){var self = $$14.$$s == null ? this : $$14.$$s, $$15, y = nil, x = nil;\n            if (self.randomizer == null) self.randomizer = nil;\n\n          \n            y = self.randomizer.$roll_once(6);\n            x = self.randomizer.$roll_sum(2, 6);\n            return $rb_plus([[x, y]], $send(range, 'map', [], ($$15 = function(r){var self = $$15.$$s == null ? this : $$15.$$s, $a, $b, xdiff = nil, ydiff = nil;\n\n            \n              \n              if (r == null) {\n                r = nil;\n              };\n              $b = $$($nesting, 'DIRECTION_INFOS')['$[]'](r)['$[]'](\"position_diff\"), $a = Opal.to_ary($b), (xdiff = ($a[0] == null ? nil : $a[0])), (ydiff = ($a[1] == null ? nil : $a[1])), $b;\n              return [$rb_plus(x, xdiff), $rb_plus(y, ydiff)];}, $$15.$$s = self, $$15.$$arity = 1, $$15)));}, $$14.$$s = self, $$14.$$arity = 0, $$14));\n        }, $SkynautsBouken_get_fire_points$13.$$arity = 2), nil) && 'get_fire_points';\n      })($nesting[0], $$($nesting, 'Base'), $nesting)\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting)\n})(Opal);\n"],"sourceRoot":"webpack:///"}