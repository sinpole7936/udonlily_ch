{"version":3,"sources":["./node_modules/bcdice/lib/bcdice/game_system/StellarKnights.js"],"names":["require","Opal","modules","$rb_minus","lhs","rhs","self","top","$nesting","nil","$$$","$$","$module","module","$klass","klass","$hash2","hash2","$truthy","truthy","$base","$parent_nesting","concat","$super","$Table_from_i18n$1","$Table_initialize$2","$Table_roll$3","$Table_choice$4","$$prototype","times","sides","name","items","defs","$$from_i18n","key","locale","table","$t","$new","$$arity","def","$$initialize","type","m","$freeze","$match","$raise","$to_i","$$roll","bcdice","value","$roll_sum","$choice","$$choice","index","$rb_plus","$rb_times","$D66GridTable_from_i18n$1","$D66GridTable_initialize$2","$D66GridTable_roll$3","randomizer","dice1","dice2","index1","index2","$roll_once","$rb_ge","$rb_gt","$rb_le","$send2","send2","$send","send","$range","range","$require","$StellarKnights_initialize$1","$StellarKnights_eval_game_system_specific_command$2","$StellarKnights_resolute_action$3","$StellarKnights_parse_dice_change_rules$8","$StellarKnights_roll_all_situation_b2_tables$10","$StellarKnights_roll_all_situation_tables$12","$StellarKnights_roll_personality_table$14","$StellarKnights_roll_fragment_table$15","const_set","command","$iter","$$p","$yield","find_super_dispatcher","sort_barabara_dice","d66_sort_type","$$eval_game_system_specific_command","$ret_or_1","num","$ret_or_2","$upcase","$roll","$resolute_action","$roll_all_situation_b2_tables","$roll_all_situation_tables","$roll_personality_table","$roll_fragment_table","$private","$$resolute_action","num_dices","defence","dice_change_text","$$4","$$6","$$7","dices","dice_text","output","dice_change_rules","success","failure","success_num","$roll_barabara","$sort","$join","$parse_dice_change_rules","rule","$$s","$$5","val","$translate","r","$writer","to_a","$$parse_dice_change_rules","text","$$9","$split","v","$to_proc","$$roll_all_situation_b2_tables","$$11","$$roll_all_situation_tables","$$13","$$roll_personality_table","$a","$b","value1","value2","result","$get_table_by_d66","to_ary","$$roll_fragment_table","$$16","$$17","$$18","results","values","indexes","$translate_tables$19","$$translate_tables","$from_i18n","get_singleton_class","$translate_tables","$register_prefix","$keys"],"mappings":"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","file":"default~StellarKnights~index.js","sourcesContent":["require('./../opal');\n\n/* Generated by Opal 1.1.1 */\nOpal.modules[\"bcdice/dice_table/table\"] = function(Opal) {\n  function $rb_minus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);\n  }\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2, $truthy = Opal.truthy;\n\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'DiceTable');\n\n      var $nesting = [self].concat($parent_nesting);\n\n      (function($base, $super, $parent_nesting) {\n        var self = $klass($base, $super, 'Table');\n\n        var $nesting = [self].concat($parent_nesting), $Table_from_i18n$1, $Table_initialize$2, $Table_roll$3, $Table_choice$4;\n\n        self.$$prototype.times = self.$$prototype.sides = self.$$prototype.name = self.$$prototype.items = nil;\n        \n        Opal.defs(self, '$from_i18n', $Table_from_i18n$1 = function $$from_i18n(key, locale) {\n          var self = this, table = nil;\n\n          \n          table = $$($nesting, 'I18n').$t(key, $hash2([\"locale\"], {\"locale\": locale}));\n          return self.$new(table['$[]'](\"name\"), table['$[]'](\"type\"), table['$[]'](\"items\"));\n        }, $Table_from_i18n$1.$$arity = 2);\n        \n        Opal.def(self, '$initialize', $Table_initialize$2 = function $$initialize(name, type, items) {\n          var self = this, m = nil;\n\n          \n          self.name = name;\n          self.items = items.$freeze();\n          m = /(\\d+)D(\\d+)/i.$match(type);\n          if ($truthy(m)) {\n          } else {\n            self.$raise($$($nesting, 'ArgumentError'), \"\" + \"Unexpected table type: \" + (type))\n          };\n          self.times = m['$[]'](1).$to_i();\n          return (self.sides = m['$[]'](2).$to_i());\n        }, $Table_initialize$2.$$arity = 3);\n        \n        Opal.def(self, '$roll', $Table_roll$3 = function $$roll(bcdice) {\n          var self = this, value = nil;\n\n          \n          value = bcdice.$roll_sum(self.times, self.sides);\n          return self.$choice(value);\n        }, $Table_roll$3.$$arity = 1);\n        return (Opal.def(self, '$choice', $Table_choice$4 = function $$choice(value) {\n          var self = this, index = nil;\n\n          \n          index = $rb_minus(value, self.times);\n          return $$($nesting, 'RollResult').$new(self.name, value, self.items['$[]'](index));\n        }, $Table_choice$4.$$arity = 1), nil) && 'choice';\n      })($nesting[0], null, $nesting)\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting)\n};\n\n/* Generated by Opal 1.1.1 */\nOpal.modules[\"bcdice/dice_table/d66_grid_table\"] = function(Opal) {\n  function $rb_plus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);\n  }\n  function $rb_times(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs * rhs : lhs['$*'](rhs);\n  }\n  function $rb_minus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);\n  }\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2;\n\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'DiceTable');\n\n      var $nesting = [self].concat($parent_nesting);\n\n      (function($base, $super, $parent_nesting) {\n        var self = $klass($base, $super, 'D66GridTable');\n\n        var $nesting = [self].concat($parent_nesting), $D66GridTable_from_i18n$1, $D66GridTable_initialize$2, $D66GridTable_roll$3;\n\n        self.$$prototype.name = self.$$prototype.items = nil;\n        \n        Opal.defs(self, '$from_i18n', $D66GridTable_from_i18n$1 = function $$from_i18n(key, locale) {\n          var self = this, table = nil;\n\n          \n          table = $$($nesting, 'I18n').$t(key, $hash2([\"locale\", \"raise\"], {\"locale\": locale, \"raise\": true}));\n          return self.$new(table['$[]'](\"name\"), table['$[]'](\"items\"));\n        }, $D66GridTable_from_i18n$1.$$arity = 2);\n        \n        Opal.def(self, '$initialize', $D66GridTable_initialize$2 = function $$initialize(name, items) {\n          var self = this;\n\n          \n          self.name = name;\n          return (self.items = items.$freeze());\n        }, $D66GridTable_initialize$2.$$arity = 2);\n        return (Opal.def(self, '$roll', $D66GridTable_roll$3 = function $$roll(randomizer) {\n          var self = this, dice1 = nil, dice2 = nil, value = nil, index1 = nil, index2 = nil;\n\n          \n          dice1 = randomizer.$roll_once(6);\n          dice2 = randomizer.$roll_once(6);\n          value = $rb_plus($rb_times(dice1, 10), dice2);\n          index1 = $rb_minus(dice1, 1);\n          index2 = $rb_minus(dice2, 1);\n          return $$($nesting, 'RollResult').$new(self.name, value, self.items['$[]'](index1)['$[]'](index2));\n        }, $D66GridTable_roll$3.$$arity = 1), nil) && 'roll';\n      })($nesting[0], null, $nesting)\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting)\n};\n\n/* Generated by Opal 1.1.1 */\n(function(Opal) {\n  function $rb_plus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);\n  }\n  function $rb_ge(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs >= rhs : lhs['$>='](rhs);\n  }\n  function $rb_gt(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);\n  }\n  function $rb_minus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);\n  }\n  function $rb_le(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs <= rhs : lhs['$<='](rhs);\n  }\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $klass = Opal.klass, $send2 = Opal.send2, $truthy = Opal.truthy, $send = Opal.send, $hash2 = Opal.hash2, $range = Opal.range;\n\n  \n  self.$require(\"bcdice/dice_table/table\");\n  self.$require(\"bcdice/dice_table/d66_grid_table\");\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'GameSystem');\n\n      var $nesting = [self].concat($parent_nesting);\n\n      (function($base, $super, $parent_nesting) {\n        var self = $klass($base, $super, 'StellarKnights');\n\n        var $nesting = [self].concat($parent_nesting), $StellarKnights_initialize$1, $StellarKnights_eval_game_system_specific_command$2, $StellarKnights_resolute_action$3, $StellarKnights_parse_dice_change_rules$8, $StellarKnights_roll_all_situation_b2_tables$10, $StellarKnights_roll_all_situation_tables$12, $StellarKnights_roll_personality_table$14, $StellarKnights_roll_fragment_table$15;\n\n        self.$$prototype.randomizer = nil;\n        \n        Opal.const_set($nesting[0], 'ID', \"StellarKnights\");\n        Opal.const_set($nesting[0], 'NAME', \"銀剣のステラナイツ\");\n        Opal.const_set($nesting[0], 'SORT_KEY', \"きんけんのすてらないつ\");\n        Opal.const_set($nesting[0], 'HELP_MESSAGE', \"\" + \"・判定　nSK[d][,k>l,...]\\n\" + \"[]内は省略可能。\\n\" + \"n: ダイス数、d: アタック判定における対象の防御力、k, l: ダイスの出目がkならばlに変更（アマランサスのスキル「始まりの部屋」用）\\n\" + \"d省略時はダイスを振った結果のみ表示。（nSKはnB6と同じ）\\n\" + \"\\n\" + \"4SK: ダイスを4個振って、その結果を表示\\n\" + \"5SK3: 【アタック判定：5ダイス】、対象の防御力を3として成功数を表示\\n\" + \"3SK,1>6: ダイスを3個振り、出目が1のダイスを全て6に変更し、その結果を表示\\n\" + \"6SK4,1>6,2>6: 【アタック判定：6ダイス】、出目が1と2のダイスを全て6に変更、対象の防御力を4として成功数を表示\\n\" + \"\\n\" + \"・基本\\n\" + \"TT：お題表\\n\" + \"STA    ：シチュエーション表A：時間 (Situation Table A)\\n\" + \"STB    ：シチュエーション表B：場所 (ST B)\\n\" + \"STB2[n]：シチュエーション表B その2：学園編 (ST B 2)\\n\" + \"　n: 1(アーセルトレイ), 2(イデアグロリア), 3(シトラ), 4(フィロソフィア), 5(聖アージェティア), 6(SoA)\\n\" + \"STC    ：シチュエーション表C：話題 (ST C)\\n\" + \"ALLS   ：シチュエーション表全てを一括で（学園編除く）\\n\" + \"GAT：所属組織決定 (Gakuen Table)\\n\" + \"HOT：希望表 (Hope Table)\\n\" + \"DET：絶望表 (Despair Table)\\n\" + \"WIT：願い事表 (Wish Table)\\n\" + \"YST：あなたの物語表 (Your Story Table)\\n\" + \"YSTA：あなたの物語表：異世界 (YST Another World)\\n\" + \"PET：性格表 (Personality Table)\\n\" + \"    性格表を2回振り、性格を決定する\\n\" + \"\\n\" + \"・霧と桜のマルジナリア\\n\" + \"YSTM：あなたの物語表：マルジナリア世界 (YST Marginalia)\\n\" + \"STM：シチュエーション表：マルジナリア世界 (ST Marginalia)\\n\" + \"YSTL：あなたの物語表：手紙世界 (YST Letter)\\n\" + \"YSTR：あなたの物語表：リコレクト・ドール (YST Recollect-doll)\\n\" + \"STBR：シチュエーション表B：場所（リコレクト・ドール） (ST B Recollect-doll)\\n\" + \"STCR：シチュエーション表C：リコレクト (ST C Recollect)\\n\" + \"STBS：シチュエーション表B：シトラセッティング (ST B Sut Tu Real)\\n\" + \"STE：シチュエーション表：エクリプス専用 (ST Eclipse)\\n\" + \"\\n\" + \"・紫弾のオルトリヴート\\n\" + \"FT：フラグメント表 (Fragment Table)\\n\" + \"    フラグメント表を５回振る\\n\" + \"FTx：フラグメント表をx回振る\\n\" + \"YSTB：あなたの物語表：ブリンガー (YST Bringer)\\n\" + \"YSTF：あなたの物語表：フォージ (YST Forge)\\n\" + \"STAL：シチュエーション表：オルトリヴート (ST Alt-Levoot)\\n\");\n        \n        Opal.def(self, '$initialize', $StellarKnights_initialize$1 = function $$initialize(command) {\n          var $iter = $StellarKnights_initialize$1.$$p, $yield = $iter || nil, self = this;\n\n          if ($iter) $StellarKnights_initialize$1.$$p = null;\n          \n          $send2(self, Opal.find_super_dispatcher(self, 'initialize', $StellarKnights_initialize$1, false, true), 'initialize', [command], null);\n          self.sort_barabara_dice = true;\n          return (self.d66_sort_type = $$$($$($nesting, 'D66SortType'), 'NO_SORT'));\n        }, $StellarKnights_initialize$1.$$arity = 1);\n        \n        Opal.def(self, '$eval_game_system_specific_command', $StellarKnights_eval_game_system_specific_command$2 = function $$eval_game_system_specific_command(command) {\n          var self = this, table = nil, m = nil, $ret_or_1 = nil, num = nil, $ret_or_2 = nil;\n\n          \n          command = command.$upcase();\n          if ($truthy((table = $$($nesting, 'TABLES')['$[]'](command)))) {\n            return table.$roll(self.randomizer)\n          } else if ($truthy((m = /(\\d+)SK(\\d)?((,\\d>\\d)+)?/.$match(command)))) {\n            return self.$resolute_action(m['$[]'](1).$to_i(), (function() {if ($truthy(($ret_or_1 = m['$[]'](2)))) {\n              return m['$[]'](2).$to_i()\n            } else {\n              return $ret_or_1\n            }; return nil; })(), m['$[]'](3), command)\n          } else if (command['$=='](\"STB2\")) {\n            return self.$roll_all_situation_b2_tables()\n          } else if (command['$=='](\"ALLS\")) {\n            return self.$roll_all_situation_tables()\n          } else if (command['$=='](\"PET\")) {\n            return self.$roll_personality_table()\n          } else if ($truthy((m = /FT(\\d+)?/.$match(command)))) {\n            \n            num = (function() {if ($truthy(($ret_or_2 = m['$[]'](1)))) {\n              return $ret_or_2\n            } else {\n              return 5\n            }; return nil; })().$to_i();\n            return self.$roll_fragment_table(num);\n          } else {\n            return nil\n          };\n        }, $StellarKnights_eval_game_system_specific_command$2.$$arity = 1);\n        self.$private();\n        \n        Opal.def(self, '$resolute_action', $StellarKnights_resolute_action$3 = function $$resolute_action(num_dices, defence, dice_change_text, command) {\n          var $$4, $$6, $$7, self = this, dices = nil, dice_text = nil, output = nil, dice_change_rules = nil, success = nil, failure = nil, success_num = nil;\n\n          \n          dices = self.randomizer.$roll_barabara(num_dices, 6).$sort();\n          dice_text = dices.$join(\",\");\n          output = \"\" + \"(\" + (command) + \") ＞ \" + (dice_text);\n          dice_change_rules = self.$parse_dice_change_rules(dice_change_text);\n          $send(dice_change_rules, 'each', [], ($$4 = function(rule){var self = $$4.$$s == null ? this : $$4.$$s, $$5;\n\n          \n            \n            if (rule == null) {\n              rule = nil;\n            };\n            return $send(dices, 'map!', [], ($$5 = function(val){var self = $$5.$$s == null ? this : $$5.$$s;\n\n            \n              \n              if (val == null) {\n                val = nil;\n              };\n              if (val['$=='](rule['$[]'](\"from\"))) {\n                return rule['$[]'](\"to\")\n              } else {\n                return val\n              };}, $$5.$$s = self, $$5.$$arity = 1, $$5));}, $$4.$$s = self, $$4.$$arity = 1, $$4));\n          if ($truthy(dice_change_rules['$empty?']())) {\n          } else {\n            \n            dices['$sort!']();\n            output = $rb_plus(output, \"\" + \" ＞ [\" + (dices.$join(\",\")) + \"]\");\n          };\n          if ($truthy(defence['$nil?']())) {\n            \n            success = false;\n            failure = false;\n          } else {\n            \n            success_num = $send(dices, 'count', [], ($$6 = function(val){var self = $$6.$$s == null ? this : $$6.$$s;\n\n            \n              \n              if (val == null) {\n                val = nil;\n              };\n              return $rb_ge(val, defence);}, $$6.$$s = self, $$6.$$arity = 1, $$6));\n            output = $rb_plus(output, $rb_plus(\" ＞ \", self.$translate(\"StellarKnights.SK.success_num\", $hash2([\"success_num\"], {\"success_num\": success_num}))));\n            success = $rb_gt(success_num, 0);\n            failure = success['$!']();\n          };\n          return $send($$($nesting, 'Result').$new(output), 'tap', [], ($$7 = function(r){var self = $$7.$$s == null ? this : $$7.$$s, $writer = nil;\n\n          \n            \n            if (r == null) {\n              r = nil;\n            };\n            \n            $writer = [success];\n            $send(r, 'success=', Opal.to_a($writer));\n            $writer[$rb_minus($writer[\"length\"], 1)];;\n            \n            $writer = [failure];\n            $send(r, 'failure=', Opal.to_a($writer));\n            return $writer[$rb_minus($writer[\"length\"], 1)];;}, $$7.$$s = self, $$7.$$arity = 1, $$7));\n        }, $StellarKnights_resolute_action$3.$$arity = 4);\n        \n        Opal.def(self, '$parse_dice_change_rules', $StellarKnights_parse_dice_change_rules$8 = function $$parse_dice_change_rules(text) {\n          var $$9, self = this;\n\n          \n          if ($truthy(text['$nil?']())) {\n            return []};\n          text = text['$[]']($range(1, -1, false));\n          return $send(text.$split(\",\"), 'map', [], ($$9 = function(rule){var self = $$9.$$s == null ? this : $$9.$$s, v = nil;\n\n          \n            \n            if (rule == null) {\n              rule = nil;\n            };\n            v = $send(rule.$split(\">\"), 'map', [], \"to_i\".$to_proc());\n            return $hash2([\"from\", \"to\"], {\"from\": v['$[]'](0), \"to\": v['$[]'](1)});}, $$9.$$s = self, $$9.$$arity = 1, $$9));\n        }, $StellarKnights_parse_dice_change_rules$8.$$arity = 1);\n        \n        Opal.def(self, '$roll_all_situation_b2_tables', $StellarKnights_roll_all_situation_b2_tables$10 = function $$roll_all_situation_b2_tables() {\n          var $$11, self = this;\n\n          return $send($range(1, 6, false), 'map', [], ($$11 = function(num){var self = $$11.$$s == null ? this : $$11.$$s;\n            if (self.randomizer == null) self.randomizer = nil;\n\n          \n            \n            if (num == null) {\n              num = nil;\n            };\n            return $$($nesting, 'TABLES')['$[]'](\"\" + \"STB2\" + (num)).$roll(self.randomizer);}, $$11.$$s = self, $$11.$$arity = 1, $$11)).$join(\"\\n\")\n        }, $StellarKnights_roll_all_situation_b2_tables$10.$$arity = 0);\n        \n        Opal.def(self, '$roll_all_situation_tables', $StellarKnights_roll_all_situation_tables$12 = function $$roll_all_situation_tables() {\n          var $$13, self = this;\n\n          return $send([\"STA\", \"STB\", \"STC\"], 'map', [], ($$13 = function(command){var self = $$13.$$s == null ? this : $$13.$$s;\n            if (self.randomizer == null) self.randomizer = nil;\n\n          \n            \n            if (command == null) {\n              command = nil;\n            };\n            return $$($nesting, 'TABLES')['$[]'](command).$roll(self.randomizer);}, $$13.$$s = self, $$13.$$arity = 1, $$13)).$join(\"\\n\")\n        }, $StellarKnights_roll_all_situation_tables$12.$$arity = 0);\n        \n        Opal.def(self, '$roll_personality_table', $StellarKnights_roll_personality_table$14 = function $$roll_personality_table() {\n          var $a, $b, self = this, value1 = nil, index1 = nil, value2 = nil, index2 = nil, name = nil, result = nil;\n\n          \n          $b = self.$get_table_by_d66(self.$translate(\"StellarKnights.PET.items\")), $a = Opal.to_ary($b), (value1 = ($a[0] == null ? nil : $a[0])), (index1 = ($a[1] == null ? nil : $a[1])), $b;\n          $b = self.$get_table_by_d66(self.$translate(\"StellarKnights.PET.items\")), $a = Opal.to_ary($b), (value2 = ($a[0] == null ? nil : $a[0])), (index2 = ($a[1] == null ? nil : $a[1])), $b;\n          name = self.$translate(\"StellarKnights.PET.name\");\n          result = self.$translate(\"StellarKnights.PET.result\", $hash2([\"value1\", \"value2\"], {\"value1\": value1, \"value2\": value2}));\n          return \"\" + (name) + \"(\" + (index1) + \",\" + (index2) + \") ＞ \" + (result);\n        }, $StellarKnights_roll_personality_table$14.$$arity = 0);\n        \n        Opal.def(self, '$roll_fragment_table', $StellarKnights_roll_fragment_table$15 = function $$roll_fragment_table(num) {\n          var $$16, $$17, $$18, self = this, results = nil, values = nil, indexes = nil, name = nil;\n\n          \n          if ($truthy($rb_le(num, 0))) {\n            return nil};\n          results = $send($$($nesting, 'Array'), 'new', [num], ($$16 = function(){var self = $$16.$$s == null ? this : $$16.$$s;\n\n          return self.$get_table_by_d66(self.$translate(\"StellarKnights.FT.items\"))}, $$16.$$s = self, $$16.$$arity = 0, $$16));\n          values = $send(results, 'map', [], ($$17 = function(r){var self = $$17.$$s == null ? this : $$17.$$s;\n\n          \n            \n            if (r == null) {\n              r = nil;\n            };\n            return r['$[]'](0);}, $$17.$$s = self, $$17.$$arity = 1, $$17));\n          indexes = $send(results, 'map', [], ($$18 = function(r){var self = $$18.$$s == null ? this : $$18.$$s;\n\n          \n            \n            if (r == null) {\n              r = nil;\n            };\n            return r['$[]'](1);}, $$18.$$s = self, $$18.$$arity = 1, $$18));\n          name = self.$translate(\"StellarKnights.FT.name\");\n          return \"\" + (name) + \"(\" + (indexes.$join(\",\")) + \") ＞ \" + (values.$join(\",\"));\n        }, $StellarKnights_roll_fragment_table$15.$$arity = 1);\n        (function(self, $parent_nesting) {\n          var $nesting = [self].concat($parent_nesting), $translate_tables$19;\n\n          \n          self.$private();\n          return (Opal.def(self, '$translate_tables', $translate_tables$19 = function $$translate_tables(locale) {\n            var self = this;\n\n            return $hash2([\"TT\", \"STA\", \"STB\", \"STB21\", \"STB22\", \"STB23\", \"STB24\", \"STB25\", \"STB26\", \"STC\", \"GAT\", \"HOT\", \"DET\", \"WIT\", \"YST\", \"YSTA\", \"YSTM\", \"STM\", \"YSTL\", \"YSTR\", \"STBR\", \"STCR\", \"STBS\", \"STE\", \"YSTB\", \"YSTF\", \"STAL\"], {\"TT\": $$$($$($nesting, 'DiceTable'), 'D66GridTable').$from_i18n(\"StellarKnights.tables.TT\", locale), \"STA\": $$$($$($nesting, 'DiceTable'), 'Table').$from_i18n(\"StellarKnights.tables.STA\", locale), \"STB\": $$$($$($nesting, 'DiceTable'), 'D66OneThirdTable').$from_i18n(\"StellarKnights.tables.STB\", locale), \"STB21\": $$$($$($nesting, 'DiceTable'), 'Table').$from_i18n(\"StellarKnights.tables.STB21\", locale), \"STB22\": $$$($$($nesting, 'DiceTable'), 'Table').$from_i18n(\"StellarKnights.tables.STB22\", locale), \"STB23\": $$$($$($nesting, 'DiceTable'), 'Table').$from_i18n(\"StellarKnights.tables.STB23\", locale), \"STB24\": $$$($$($nesting, 'DiceTable'), 'Table').$from_i18n(\"StellarKnights.tables.STB24\", locale), \"STB25\": $$$($$($nesting, 'DiceTable'), 'Table').$from_i18n(\"StellarKnights.tables.STB25\", locale), \"STB26\": $$$($$($nesting, 'DiceTable'), 'Table').$from_i18n(\"StellarKnights.tables.STB26\", locale), \"STC\": $$$($$($nesting, 'DiceTable'), 'D66HalfGridTable').$from_i18n(\"StellarKnights.tables.STC\", locale), \"GAT\": $$$($$($nesting, 'DiceTable'), 'Table').$from_i18n(\"StellarKnights.tables.GAT\", locale), \"HOT\": $$$($$($nesting, 'DiceTable'), 'D66HalfGridTable').$from_i18n(\"StellarKnights.tables.HOT\", locale), \"DET\": $$$($$($nesting, 'DiceTable'), 'D66HalfGridTable').$from_i18n(\"StellarKnights.tables.DET\", locale), \"WIT\": $$$($$($nesting, 'DiceTable'), 'D66OneThirdTable').$from_i18n(\"StellarKnights.tables.WIT\", locale), \"YST\": $$$($$($nesting, 'DiceTable'), 'D66OneThirdTable').$from_i18n(\"StellarKnights.tables.YST\", locale), \"YSTA\": $$$($$($nesting, 'DiceTable'), 'D66OneThirdTable').$from_i18n(\"StellarKnights.tables.YSTA\", locale), \"YSTM\": $$$($$($nesting, 'DiceTable'), 'D66OneThirdTable').$from_i18n(\"StellarKnights.tables.YSTM\", locale), \"STM\": $$$($$($nesting, 'DiceTable'), 'D66HalfGridTable').$from_i18n(\"StellarKnights.tables.STM\", locale), \"YSTL\": $$$($$($nesting, 'DiceTable'), 'D66HalfGridTable').$from_i18n(\"StellarKnights.tables.YSTL\", locale), \"YSTR\": $$$($$($nesting, 'DiceTable'), 'D66HalfGridTable').$from_i18n(\"StellarKnights.tables.YSTR\", locale), \"STBR\": $$$($$($nesting, 'DiceTable'), 'D66HalfGridTable').$from_i18n(\"StellarKnights.tables.STBR\", locale), \"STCR\": $$$($$($nesting, 'DiceTable'), 'D66HalfGridTable').$from_i18n(\"StellarKnights.tables.STCR\", locale), \"STBS\": $$$($$($nesting, 'DiceTable'), 'D66HalfGridTable').$from_i18n(\"StellarKnights.tables.STBS\", locale), \"STE\": $$$($$($nesting, 'DiceTable'), 'D66HalfGridTable').$from_i18n(\"StellarKnights.tables.STE\", locale), \"YSTB\": $$$($$($nesting, 'DiceTable'), 'D66HalfGridTable').$from_i18n(\"StellarKnights.tables.YSTB\", locale), \"YSTF\": $$$($$($nesting, 'DiceTable'), 'D66HalfGridTable').$from_i18n(\"StellarKnights.tables.YSTF\", locale), \"STAL\": $$$($$($nesting, 'DiceTable'), 'D66HalfGridTable').$from_i18n(\"StellarKnights.tables.STAL\", locale)})\n          }, $translate_tables$19.$$arity = 1), nil) && 'translate_tables';\n        })(Opal.get_singleton_class(self), $nesting);\n        Opal.const_set($nesting[0], 'TABLES', self.$translate_tables(\"ja_jp\"));\n        return self.$register_prefix(\"\\\\d+SK\", \"STB2\", \"ALLS\", \"PET\", \"FT\", $$($nesting, 'TABLES').$keys());\n      })($nesting[0], $$($nesting, 'Base'), $nesting)\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting);\n})(Opal);\n"],"sourceRoot":"webpack:///"}