{"version":3,"sources":["./node_modules/bcdice/lib/bcdice/game_system/Warhammer4.js"],"names":["require","Opal","$rb_divide","lhs","rhs","$rb_minus","$rb_le","$rb_lt","$rb_ge","$rb_gt","$rb_plus","$rb_times","self","top","$nesting","nil","$$$","$$","$module","module","$klass","klass","$send2","send2","$truthy","truthy","$send","send","$hash2","hash2","$range","range","$base","$parent_nesting","concat","$super","$Warhammer4_initialize$1","$Warhammer4_eval_game_system_specific_command$2","$Warhammer4_result_1d100$3","$Warhammer4_result_detail$4","$Warhammer4_roll_critical_table$5","$Warhammer4_roll_attack$9","$Warhammer4_additional_result$10","$Warhammer4_split_d100$11","$Warhammer4_merge_d100$12","$$prototype","randomizer","const_set","$register_prefix","def","$$initialize","command","$iter","$$p","$yield","find_super_dispatcher","round_type","$$arity","$$eval_game_system_specific_command","$ret_or_1","$ret_or_2","$roll_critical_table","$roll_attack","$roll_tables","$$result_1d100","total","_dice_total","cmp_op","target","t10","d10","sl","$ret_or_3","$ret_or_4","result","sl_text","$writer","$nothing","$to_i","$success","$failure","$format","$text","$result_detail","to_a","$private","$$result_detail","$$roll_critical_table","m","part","under_ganken_bonus","$match","$roll","$CriticalTable_initialize$6","$CriticalTable_roll$7","items","name","$$roll","$$8","dice","chosen","$roll_once","$clamp","key","_","$$s","$new","$freeze","$$roll_attack","$a","target_number","sequence","$result_1d100","$additional_result","$compact","$join","$$additional_result","$b","tens","ones","$ret_or_5","$split_d100","to_ary","$fetch","$merge_d100","$content","$$split_d100","$$merge_d100","$ret_or_6"],"mappings":";;;;;;;;;AAAAA,mBAAO,CAAC,uBAAD,CAAP;AAEA;;;AACA,CAAC,UAASC,IAAT,EAAe;AACd,WAASC,UAAT,CAAoBC,GAApB,EAAyBC,GAAzB,EAA8B;AAC5B,WAAQ,OAAOD,GAAP,KAAgB,QAAhB,IAA4B,OAAOC,GAAP,KAAgB,QAA7C,GAAyDD,GAAG,GAAGC,GAA/D,GAAqED,GAAG,CAAC,IAAD,CAAH,CAAUC,GAAV,CAA5E;AACD;;AACD,WAASC,SAAT,CAAmBF,GAAnB,EAAwBC,GAAxB,EAA6B;AAC3B,WAAQ,OAAOD,GAAP,KAAgB,QAAhB,IAA4B,OAAOC,GAAP,KAAgB,QAA7C,GAAyDD,GAAG,GAAGC,GAA/D,GAAqED,GAAG,CAAC,IAAD,CAAH,CAAUC,GAAV,CAA5E;AACD;;AACD,WAASE,MAAT,CAAgBH,GAAhB,EAAqBC,GAArB,EAA0B;AACxB,WAAQ,OAAOD,GAAP,KAAgB,QAAhB,IAA4B,OAAOC,GAAP,KAAgB,QAA7C,GAAyDD,GAAG,IAAIC,GAAhE,GAAsED,GAAG,CAAC,KAAD,CAAH,CAAWC,GAAX,CAA7E;AACD;;AACD,WAASG,MAAT,CAAgBJ,GAAhB,EAAqBC,GAArB,EAA0B;AACxB,WAAQ,OAAOD,GAAP,KAAgB,QAAhB,IAA4B,OAAOC,GAAP,KAAgB,QAA7C,GAAyDD,GAAG,GAAGC,GAA/D,GAAqED,GAAG,CAAC,IAAD,CAAH,CAAUC,GAAV,CAA5E;AACD;;AACD,WAASI,MAAT,CAAgBL,GAAhB,EAAqBC,GAArB,EAA0B;AACxB,WAAQ,OAAOD,GAAP,KAAgB,QAAhB,IAA4B,OAAOC,GAAP,KAAgB,QAA7C,GAAyDD,GAAG,IAAIC,GAAhE,GAAsED,GAAG,CAAC,KAAD,CAAH,CAAWC,GAAX,CAA7E;AACD;;AACD,WAASK,MAAT,CAAgBN,GAAhB,EAAqBC,GAArB,EAA0B;AACxB,WAAQ,OAAOD,GAAP,KAAgB,QAAhB,IAA4B,OAAOC,GAAP,KAAgB,QAA7C,GAAyDD,GAAG,GAAGC,GAA/D,GAAqED,GAAG,CAAC,IAAD,CAAH,CAAUC,GAAV,CAA5E;AACD;;AACD,WAASM,QAAT,CAAkBP,GAAlB,EAAuBC,GAAvB,EAA4B;AAC1B,WAAQ,OAAOD,GAAP,KAAgB,QAAhB,IAA4B,OAAOC,GAAP,KAAgB,QAA7C,GAAyDD,GAAG,GAAGC,GAA/D,GAAqED,GAAG,CAAC,IAAD,CAAH,CAAUC,GAAV,CAA5E;AACD;;AACD,WAASO,SAAT,CAAmBR,GAAnB,EAAwBC,GAAxB,EAA6B;AAC3B,WAAQ,OAAOD,GAAP,KAAgB,QAAhB,IAA4B,OAAOC,GAAP,KAAgB,QAA7C,GAAyDD,GAAG,GAAGC,GAA/D,GAAqED,GAAG,CAAC,IAAD,CAAH,CAAUC,GAAV,CAA5E;AACD;;AACD,MAAIQ,IAAI,GAAGX,IAAI,CAACY,GAAhB;AAAA,MAAqBC,QAAQ,GAAG,EAAhC;AAAA,MAAoCC,GAAG,GAAGd,IAAI,CAACc,GAA/C;AAAA,MAAoDC,GAAG,GAAGf,IAAI,CAACe,GAA/D;AAAA,MAAoEC,EAAE,GAAGhB,IAAI,CAACgB,EAA9E;AAAA,MAAkFC,OAAO,GAAGjB,IAAI,CAACkB,MAAjG;AAAA,MAAyGC,MAAM,GAAGnB,IAAI,CAACoB,KAAvH;AAAA,MAA8HC,MAAM,GAAGrB,IAAI,CAACsB,KAA5I;AAAA,MAAmJC,OAAO,GAAGvB,IAAI,CAACwB,MAAlK;AAAA,MAA0KC,KAAK,GAAGzB,IAAI,CAAC0B,IAAvL;AAAA,MAA6LC,MAAM,GAAG3B,IAAI,CAAC4B,KAA3M;AAAA,MAAkNC,MAAM,GAAG7B,IAAI,CAAC8B,KAAhO;AAEA,SAAQ,UAASC,KAAT,EAAgBC,eAAhB,EAAiC;AACvC,QAAIrB,IAAI,GAAGM,OAAO,CAACc,KAAD,EAAQ,QAAR,CAAlB;AAEA,QAAIlB,QAAQ,GAAG,CAACF,IAAD,EAAOsB,MAAP,CAAcD,eAAd,CAAf;;AAEA,KAAC,UAASD,KAAT,EAAgBC,eAAhB,EAAiC;AAChC,UAAIrB,IAAI,GAAGM,OAAO,CAACc,KAAD,EAAQ,YAAR,CAAlB;AAEA,UAAIlB,QAAQ,GAAG,CAACF,IAAD,EAAOsB,MAAP,CAAcD,eAAd,CAAf;;AAEA,OAAC,UAASD,KAAT,EAAgBG,MAAhB,EAAwBF,eAAxB,EAAyC;AACxC,YAAIrB,IAAI,GAAGQ,MAAM,CAACY,KAAD,EAAQG,MAAR,EAAgB,YAAhB,CAAjB;AAEA,YAAIrB,QAAQ,GAAG,CAACF,IAAD,EAAOsB,MAAP,CAAcD,eAAd,CAAf;AAAA,YAA+CG,wBAA/C;AAAA,YAAyEC,+CAAzE;AAAA,YAA0HC,0BAA1H;AAAA,YAAsJC,2BAAtJ;AAAA,YAAmLC,iCAAnL;AAAA,YAAsNC,yBAAtN;AAAA,YAAiPC,gCAAjP;AAAA,YAAmRC,yBAAnR;AAAA,YAA8SC,yBAA9S;AAEAhC,YAAI,CAACiC,WAAL,CAAiBC,UAAjB,GAA8B/B,GAA9B;AAEAd,YAAI,CAAC8C,SAAL,CAAejC,QAAQ,CAAC,CAAD,CAAvB,EAA4B,IAA5B,EAAkC,YAAlC;AACAb,YAAI,CAAC8C,SAAL,CAAejC,QAAQ,CAAC,CAAD,CAAvB,EAA4B,MAA5B,EAAoC,eAApC;AACAb,YAAI,CAAC8C,SAAL,CAAejC,QAAQ,CAAC,CAAD,CAAvB,EAA4B,UAA5B,EAAwC,UAAxC;AACAb,YAAI,CAAC8C,SAAL,CAAejC,QAAQ,CAAC,CAAD,CAAvB,EAA4B,cAA5B,EAA4C,KAAK,0EAAL,GAAkF,mCAAlF,GAAwH,0CAAxH,GAAqK,uCAArK,GAA+M,0BAA/M,GAA4O,IAA5O,GAAmP,kBAAnP,GAAwQ,+BAAxQ,GAA0S,IAA1S,GAAiT,qBAAjT,GAAyU,6BAAzU,GAAyW,IAAzW,GAAgX,gBAAhX,GAAmY,0BAAnY,GAAga,yCAAha,GAA4c,uBAAxf;AACAF,YAAI,CAACoC,gBAAL,CAAsB,IAAtB;AAEA/C,YAAI,CAACgD,GAAL,CAASrC,IAAT,EAAe,aAAf,EAA8BwB,wBAAwB,GAAG,SAASc,YAAT,CAAsBC,OAAtB,EAA+B;AACtF,cAAIC,KAAK,GAAGhB,wBAAwB,CAACiB,GAArC;AAAA,cAA0CC,MAAM,GAAGF,KAAK,IAAIrC,GAA5D;AAAA,cAAiEH,IAAI,GAAG,IAAxE;AAEA,cAAIwC,KAAJ,EAAWhB,wBAAwB,CAACiB,GAAzB,GAA+B,IAA/B;AAEX/B,gBAAM,CAACV,IAAD,EAAOX,IAAI,CAACsD,qBAAL,CAA2B3C,IAA3B,EAAiC,YAAjC,EAA+CwB,wBAA/C,EAAyE,KAAzE,EAAgF,IAAhF,CAAP,EAA8F,YAA9F,EAA4G,CAACe,OAAD,CAA5G,EAAuH,IAAvH,CAAN;AACA,iBAAQvC,IAAI,CAAC4C,UAAL,GAAkBxC,GAAG,CAACC,EAAE,CAACH,QAAD,EAAW,WAAX,CAAH,EAA4B,MAA5B,CAA7B;AACD,SAPD,EAOGsB,wBAAwB,CAACqB,OAAzB,GAAmC,CAPtC;AASAxD,YAAI,CAACgD,GAAL,CAASrC,IAAT,EAAe,oCAAf,EAAqDyB,+CAA+C,GAAG,SAASqB,mCAAT,CAA6CP,OAA7C,EAAsD;AAC3J,cAAIvC,IAAI,GAAG,IAAX;AAAA,cAAiB+C,SAAS,GAAG5C,GAA7B;AAAA,cAAkC6C,SAAS,GAAG7C,GAA9C;;AAEA,cAAIS,OAAO,CAAEmC,SAAS,GAAI,YAAW;AAAC,gBAAInC,OAAO,CAAEoC,SAAS,GAAGhD,IAAI,CAACiD,oBAAL,CAA0BV,OAA1B,CAAd,CAAX,EAA+D;AACnG,qBAAOS,SAAP;AACD,aAFqC,MAE/B;AACL,qBAAOhD,IAAI,CAACkD,YAAL,CAAkBX,OAAlB,CAAP;AACD;;AAAA;AAAE,mBAAOpC,GAAP;AAAa,WAJS,EAAd,CAAX,EAIuB;AACrB,mBAAO4C,SAAP;AACD,WAND,MAMO;AACL,mBAAO/C,IAAI,CAACmD,YAAL,CAAkBZ,OAAlB,EAA2BlC,EAAE,CAACH,QAAD,EAAW,QAAX,CAA7B,CAAP;AACD;AACF,SAZD,EAYGuB,+CAA+C,CAACoB,OAAhD,GAA0D,CAZ7D;AAcAxD,YAAI,CAACgD,GAAL,CAASrC,IAAT,EAAe,eAAf,EAAgC0B,0BAA0B,GAAG,SAAS0B,cAAT,CAAwBC,KAAxB,EAA+BC,WAA/B,EAA4CC,MAA5C,EAAoDC,MAApD,EAA4D;AACvH,cAAIxD,IAAI,GAAG,IAAX;AAAA,cAAiByD,GAAG,GAAGtD,GAAvB;AAAA,cAA4BuD,GAAG,GAAGvD,GAAlC;AAAA,cAAuCwD,EAAE,GAAGxD,GAA5C;AAAA,cAAiDyD,SAAS,GAAGzD,GAA7D;AAAA,cAAkE0D,SAAS,GAAG1D,GAA9E;AAAA,cAAmF2D,MAAM,GAAG3D,GAA5F;AAAA,cAAiG4D,OAAO,GAAG5D,GAA3G;AAAA,cAAgH6D,OAAO,GAAG7D,GAA1H;;AAGA,cAAIqD,MAAM,CAAC,KAAD,CAAN,CAAc,GAAd,CAAJ,EAAwB;AACtB,mBAAOnD,EAAE,CAACH,QAAD,EAAW,QAAX,CAAF,CAAuB+D,QAAvB,EAAP;AAAyC;;AAAA;;AAC3C,cAAIV,MAAM,CAAC,KAAD,CAAN,CAAc,IAAd,CAAJ,EAAyB,CACxB,CADD,MACO;AACL,mBAAOpD,GAAP;AACD;;AAAA;AACDsD,aAAG,GAAGnE,UAAU,CAAC+D,KAAD,EAAQ,EAAR,CAAV,CAAsBa,KAAtB,EAAN;AACAR,aAAG,GAAGpE,UAAU,CAACkE,MAAD,EAAS,EAAT,CAAV,CAAuBU,KAAvB,EAAN;AACAP,YAAE,GAAGlE,SAAS,CAACiE,GAAD,EAAMD,GAAN,CAAd;;AACA,cAAI7C,OAAO,CAAE,YAAW;AAAC,gBAAIA,OAAO,CAAEgD,SAAS,GAAGlE,MAAM,CAAC2D,KAAD,EAAQ,CAAR,CAApB,CAAX,EAA6C;AACpE,qBAAO1D,MAAM,CAACgE,EAAD,EAAK,CAAL,CAAb;AACD,aAFwB,MAElB;AACL,qBAAOC,SAAP;AACD;;AAAA;AAAE,mBAAOzD,GAAP;AAAa,WAJJ,EAAD,CAAX,EAIsB;AACpBwD,cAAE,GAAG,CAAL;AACD,WAND,MAMO,IAAI/C,OAAO,CAAE,YAAW;AAAC,gBAAIA,OAAO,CAAEiD,SAAS,GAAGjE,MAAM,CAACyD,KAAD,EAAQ,EAAR,CAApB,CAAX,EAA8C;AAC5E,qBAAOxD,MAAM,CAAC8D,EAAD,EAAK,CAAC,CAAN,CAAb;AACD,aAF+B,MAEzB;AACL,qBAAOE,SAAP;AACD;;AAAA;AAAE,mBAAO1D,GAAP;AAAa,WAJG,EAAD,CAAX,EAIe;AACpBwD,cAAE,GAAG,CAAC,CAAN;AAAQ;;AAAA;;AACVG,gBAAM,GAAI,YAAW;AAAC,gBAAIlD,OAAO,CAAClB,MAAM,CAAC2D,KAAD,EAAQ,CAAR,CAAP,CAAX,EAA+B;AACnD,qBAAOhD,EAAE,CAACH,QAAD,EAAW,QAAX,CAAF,CAAuBiE,QAAvB,CAAgC,MAAhC,CAAP;AACD,aAFqB,MAEf,IAAIvD,OAAO,CAAChB,MAAM,CAACyD,KAAD,EAAQ,EAAR,CAAP,CAAX,EAAgC;AACrC,qBAAOhD,EAAE,CAACH,QAAD,EAAW,QAAX,CAAF,CAAuBkE,QAAvB,CAAgC,MAAhC,CAAP;AACD,aAFM,MAEA,IAAIxD,OAAO,CAAClB,MAAM,CAAC2D,KAAD,EAAQG,MAAR,CAAP,CAAX,EAAoC;AACzC,qBAAOnD,EAAE,CAACH,QAAD,EAAW,QAAX,CAAF,CAAuBiE,QAAvB,CAAgC,IAAhC,CAAP;AACD,aAFM,MAEA;AACL,qBAAO9D,EAAE,CAACH,QAAD,EAAW,QAAX,CAAF,CAAuBkE,QAAvB,CAAgC,IAAhC,CAAP;AACD;;AAAA;AAAE,mBAAOjE,GAAP;AAAa,WARP,EAAT;;AASA4D,iBAAO,GAAG/D,IAAI,CAACqE,OAAL,CAAa,SAAb,EAAwBV,EAAxB,CAAV;AAEAK,iBAAO,GAAG,CAAClE,QAAQ,CAACgE,MAAM,CAACQ,KAAP,EAAD,EAAiB,KAAMP,OAAN,GAAiB,KAAjB,GAA0B/D,IAAI,CAACuE,cAAL,CAAoBZ,EAApB,EAAwBN,KAAxB,EAA+BG,MAA/B,CAA3C,CAAT,CAAV;AACA1C,eAAK,CAACgD,MAAD,EAAS,OAAT,EAAkBzE,IAAI,CAACmF,IAAL,CAAUR,OAAV,CAAlB,CAAL;AACAA,iBAAO,CAACvE,SAAS,CAACuE,OAAO,CAAC,QAAD,CAAR,EAAoB,CAApB,CAAV,CAAP;AAAyC;AACzC,iBAAOF,MAAP;AACD,SAxCD,EAwCGpC,0BAA0B,CAACmB,OAA3B,GAAqC,CAxCxC;AAyCA7C,YAAI,CAACyE,QAAL;AAEApF,YAAI,CAACgD,GAAL,CAASrC,IAAT,EAAe,gBAAf,EAAiC2B,2BAA2B,GAAG,SAAS+C,eAAT,CAAyBf,EAAzB,EAA6BN,KAA7B,EAAoCG,MAApC,EAA4C;AACzG,cAAIxD,IAAI,GAAG,IAAX;;AAEA,cAAI2D,EAAE,CAAC,KAAD,CAAF,CAAU,CAAV,CAAJ,EAAkB;AAChB,gBAAI/C,OAAO,CAAClB,MAAM,CAAC2D,KAAD,EAAQ,CAAR,CAAP,CAAX,EAA+B;AAC7B,qBAAO,KAAP;AACD,aAFD,MAEO,IAAIzC,OAAO,CAAChB,MAAM,CAACyD,KAAD,EAAQ,EAAR,CAAP,CAAX,EAAgC;AACrC,qBAAO,KAAP;AACD,aAFM,MAEA,IAAIzC,OAAO,CAAClB,MAAM,CAAC2D,KAAD,EAAQG,MAAR,CAAP,CAAX,EAAoC;AACzC,qBAAO,KAAP;AACD,aAFM,MAEA;AACL,qBAAO,KAAP;AACD;AACF,WAVD,MAUO,IAAI5C,OAAO,CAAChB,MAAM,CAAC+D,EAAD,EAAK,CAAL,CAAP,CAAX,EAA4B;AACjC,mBAAO,MAAP;AACD,WAFM,MAEA,IAAI/C,OAAO,CAAChB,MAAM,CAAC+D,EAAD,EAAK,CAAL,CAAP,CAAX,EAA4B;AACjC,mBAAO,KAAP;AACD,WAFM,MAEA,IAAI/C,OAAO,CAAChB,MAAM,CAAC+D,EAAD,EAAK,CAAL,CAAP,CAAX,EAA4B;AACjC,mBAAO,IAAP;AACD,WAFM,MAEA,IAAI/C,OAAO,CAACf,MAAM,CAAC8D,EAAD,EAAK,CAAL,CAAP,CAAX,EAA4B;AACjC,mBAAO,KAAP;AACD,WAFM,MAEA,IAAI/C,OAAO,CAAChB,MAAM,CAAC+D,EAAD,EAAK,CAAC,CAAN,CAAP,CAAX,EAA6B;AAClC,mBAAO,KAAP;AACD,WAFM,MAEA,IAAI/C,OAAO,CAAChB,MAAM,CAAC+D,EAAD,EAAK,CAAC,CAAN,CAAP,CAAX,EAA6B;AAClC,mBAAO,IAAP;AACD,WAFM,MAEA,IAAI/C,OAAO,CAAChB,MAAM,CAAC+D,EAAD,EAAK,CAAC,CAAN,CAAP,CAAX,EAA6B;AAClC,mBAAO,KAAP;AACD,WAFM,MAEA;AACL,mBAAO,MAAP;AACD;AACF,SA9BD,EA8BGhC,2BAA2B,CAACkB,OAA5B,GAAsC,CA9BzC;AAgCAxD,YAAI,CAACgD,GAAL,CAASrC,IAAT,EAAe,sBAAf,EAAuC4B,iCAAiC,GAAG,SAAS+C,qBAAT,CAA+BpC,OAA/B,EAAwC;AACjH,cAAIvC,IAAI,GAAG,IAAX;AAAA,cAAiB4E,CAAC,GAAGzE,GAArB;AAAA,cAA0B0E,IAAI,GAAG1E,GAAjC;AAAA,cAAsC2E,kBAAkB,GAAG3E,GAA3D;AAGAyE,WAAC,GAAG,sBAAsBG,MAAtB,CAA6BxC,OAA7B,CAAJ;;AACA,cAAI3B,OAAO,CAACgE,CAAD,CAAX,EAAgB,CACf,CADD,MACO;AACL,mBAAOzE,GAAP;AACD;;AAAA;AACD0E,cAAI,GAAGD,CAAC,CAAC,KAAD,CAAD,CAAS,CAAT,CAAP;;AACA,cAAIC,IAAI,CAAC,KAAD,CAAJ,CAAY,GAAZ,CAAJ,EAAsB;AACpBA,gBAAI,GAAG,GAAP;AAAW;;AAAA;AACbC,4BAAkB,GAAGF,CAAC,CAAC,KAAD,CAAD,CAAS,CAAT,EAAY,OAAZ,IAAuB,IAAvB,GAArB;AACA,iBAAOvE,EAAE,CAACH,QAAD,EAAW,iBAAX,CAAF,CAAgC,KAAhC,EAAuC2E,IAAvC,EAA6CG,KAA7C,CAAmDhF,IAAI,CAACkC,UAAxD,EAAoE4C,kBAApE,CAAP;AACD,SAdD,EAcGlD,iCAAiC,CAACiB,OAAlC,GAA4C,CAd/C;;AAeA,SAAC,UAASzB,KAAT,EAAgBG,MAAhB,EAAwBF,eAAxB,EAAyC;AACxC,cAAIrB,IAAI,GAAGQ,MAAM,CAACY,KAAD,EAAQG,MAAR,EAAgB,eAAhB,CAAjB;AAEA,cAAIrB,QAAQ,GAAG,CAACF,IAAD,EAAOsB,MAAP,CAAcD,eAAd,CAAf;AAAA,cAA+C4D,2BAA/C;AAAA,cAA4EC,qBAA5E;AAEAlF,cAAI,CAACiC,WAAL,CAAiBkD,KAAjB,GAAyBnF,IAAI,CAACiC,WAAL,CAAiBmD,IAAjB,GAAwBjF,GAAjD;AAGAd,cAAI,CAACgD,GAAL,CAASrC,IAAT,EAAe,aAAf,EAA8BiF,2BAA2B,GAAG,SAAS3C,YAAT,CAAsB8C,IAAtB,EAA4BD,KAA5B,EAAmC;AAC7F,gBAAInF,IAAI,GAAG,IAAX;AAGAA,gBAAI,CAACoF,IAAL,GAAYA,IAAZ;AACA,mBAAQpF,IAAI,CAACmF,KAAL,GAAaA,KAArB;AACD,WAND,EAMGF,2BAA2B,CAACpC,OAA5B,GAAsC,CANzC;AAOA,iBAAO,CAACxD,IAAI,CAACgD,GAAL,CAASrC,IAAT,EAAe,OAAf,EAAwBkF,qBAAqB,GAAG,SAASG,MAAT,CAAgBnD,UAAhB,EAA4B4C,kBAA5B,EAAgD;AACtG,gBAAIQ,GAAJ;AAAA,gBAAStF,IAAI,GAAG,IAAhB;AAAA,gBAAsBuF,IAAI,GAAGpF,GAA7B;AAAA,gBAAkCqF,MAAM,GAAGrF,GAA3C;;AAGAoF,gBAAI,GAAGrD,UAAU,CAACuD,UAAX,CAAsB,GAAtB,CAAP;;AACA,gBAAI7E,OAAO,CAACkE,kBAAD,CAAX,EAAiC;AAC/BS,kBAAI,GAAG9F,SAAS,CAAC8F,IAAD,EAAO,EAAP,CAAT,CAAoBG,MAApB,CAA2B,CAA3B,EAA8B,GAA9B,CAAP;AAA0C;;AAAA;AAC5CF,kBAAM,GAAG1E,KAAK,CAACd,IAAI,CAACmF,KAAN,EAAa,MAAb,EAAqB,EAArB,GAA0BG,GAAG,GAAG,aAASK,GAAT,EAAcC,CAAd,EAAgB;AAAC,kBAAI5F,IAAI,GAAGsF,GAAG,CAACO,GAAJ,IAAW,IAAX,GAAkB,IAAlB,GAAyBP,GAAG,CAACO,GAAxC;;AAI7D,kBAAIF,GAAG,IAAI,IAAX,EAAiB;AACfA,mBAAG,GAAGxF,GAAN;AACD;;AAAA;;AAED,kBAAIyF,CAAC,IAAI,IAAT,EAAe;AACbA,iBAAC,GAAGzF,GAAJ;AACD;;AAAA;AACD,qBAAOP,MAAM,CAAC+F,GAAD,EAAMJ,IAAN,CAAb;AAA0B,aAXY,EAWVD,GAAG,CAACO,GAAJ,GAAU7F,IAXA,EAWMsF,GAAG,CAACzC,OAAJ,GAAc,CAXpB,EAWuByC,GAXjD,EAAL,CAW4D,KAX5D,EAWmE,CAXnE,CAAT;AAYA,mBAAO,KAAMtF,IAAI,CAACoF,IAAX,GAAmB,GAAnB,GAA0BG,IAA1B,GAAkC,MAAlC,GAA4CC,MAAnD;AACD,WApBO,EAoBLN,qBAAqB,CAACrC,OAAtB,GAAgC,CApB3B,GAoB+B1C,GApBhC,KAoBwC,MApB/C;AAqBD,SApCD,EAoCGD,QAAQ,CAAC,CAAD,CApCX,EAoCgB,IApChB,EAoCsBA,QApCtB;;AAqCAb,YAAI,CAAC8C,SAAL,CAAejC,QAAQ,CAAC,CAAD,CAAvB,EAA4B,iBAA5B,EAA+Cc,MAAM,CAAC,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,CAAD,EAAuB;AAAC,eAAKX,EAAE,CAACH,QAAD,EAAW,eAAX,CAAF,CAA8B4F,IAA9B,CAAmC,OAAnC,EAA4C,CAAC,CAAC,EAAD,EAAK,4CAAL,CAAD,EAAqD,CAAC,EAAD,EAAK,0BAAL,CAArD,EAAuF,CAAC,EAAD,EAAK,8BAAL,CAAvF,EAA6H,CAAC,EAAD,EAAK,4BAAL,CAA7H,EAAiK,CAAC,EAAD,EAAK,0BAAL,CAAjK,EAAmM,CAAC,EAAD,EAAK,iCAAL,CAAnM,EAA4O,CAAC,EAAD,EAAK,wCAAL,CAA5O,EAA4R,CAAC,EAAD,EAAK,wEAAL,CAA5R,EAA4W,CAAC,EAAD,EAAK,0CAAL,CAA5W,EAA8Z,CAAC,EAAD,EAAK,sEAAL,CAA9Z,EAA4e,CAAC,EAAD,EAAK,iFAAL,CAA5e,EAAqkB,CAAC,EAAD,EAAK,4EAAL,CAArkB,EAAypB,CAAC,EAAD,EAAK,4EAAL,CAAzpB,EAA6uB,CAAC,EAAD,EAAK,qJAAL,CAA7uB,EAA04B,CAAC,EAAD,EAAK,mDAAL,CAA14B,EAAq8B,CAAC,EAAD,EAAK,8DAAL,CAAr8B,EAA2gC,CAAC,EAAD,EAAK,wEAAL,CAA3gC,EAA2lC,CAAC,EAAD,EAAK,gFAAL,CAA3lC,EAAmrC,CAAC,EAAD,EAAK,oHAAL,CAAnrC,EAA+yC,CAAC,GAAD,EAAM,cAAN,CAA/yC,CAA5C,CAAN;AAA03C,eAAKzF,EAAE,CAACH,QAAD,EAAW,eAAX,CAAF,CAA8B4F,IAA9B,CAAmC,OAAnC,EAA4C,CAAC,CAAC,EAAD,EAAK,8BAAL,CAAD,EAAuC,CAAC,EAAD,EAAK,0BAAL,CAAvC,EAAyE,CAAC,EAAD,EAAK,2BAAL,CAAzE,EAA4G,CAAC,EAAD,EAAK,mEAAL,CAA5G,EAAuL,CAAC,EAAD,EAAK,sCAAL,CAAvL,EAAqO,CAAC,EAAD,EAAK,wFAAL,CAArO,EAAqU,CAAC,EAAD,EAAK,sDAAL,CAArU,EAAmY,CAAC,EAAD,EAAK,4EAAL,CAAnY,EAAud,CAAC,EAAD,EAAK,uFAAL,CAAvd,EAAsjB,CAAC,EAAD,EAAK,+CAAL,CAAtjB,EAA6mB,CAAC,EAAD,EAAK,0FAAL,CAA7mB,EAA+sB,CAAC,EAAD,EAAK,8DAAL,CAA/sB,EAAqxB,CAAC,EAAD,EAAK,8CAAL,CAArxB,EAA20B,CAAC,EAAD,EAAK,uIAAL,CAA30B,EAA09B,CAAC,EAAD,EAAK,sCAAL,CAA19B,EAAwgC,CAAC,EAAD,EAAK,4HAAL,CAAxgC,EAA4oC,CAAC,EAAD,EAAK,wEAAL,CAA5oC,EAA4tC,CAAC,EAAD,EAAK,4FAAL,CAA5tC,EAAg0C,CAAC,EAAD,EAAK,6GAAL,CAAh0C,EAAq7C,CAAC,GAAD,EAAM,aAAN,CAAr7C,CAA5C,CAA/3C;AAAw3F,eAAKzF,EAAE,CAACH,QAAD,EAAW,eAAX,CAAF,CAA8B4F,IAA9B,CAAmC,OAAnC,EAA4C,CAAC,CAAC,EAAD,EAAK,gCAAL,CAAD,EAAyC,CAAC,EAAD,EAAK,oEAAL,CAAzC,EAAqH,CAAC,EAAD,EAAK,yDAAL,CAArH,EAAsL,CAAC,EAAD,EAAK,+BAAL,CAAtL,EAA6N,CAAC,EAAD,EAAK,6FAAL,CAA7N,EAAkU,CAAC,EAAD,EAAK,2CAAL,CAAlU,EAAqX,CAAC,EAAD,EAAK,6EAAL,CAArX,EAA0c,CAAC,EAAD,EAAK,uBAAL,CAA1c,EAAye,CAAC,EAAD,EAAK,6CAAL,CAAze,EAA8hB,CAAC,EAAD,EAAK,mEAAL,CAA9hB,EAAymB,CAAC,EAAD,EAAK,+GAAL,CAAzmB,EAAguB,CAAC,EAAD,EAAK,kEAAL,CAAhuB,EAA0yB,CAAC,EAAD,EAAK,6BAAL,CAA1yB,EAA+0B,CAAC,EAAD,EAAK,gFAAL,CAA/0B,EAAu6B,CAAC,EAAD,EAAK,oEAAL,CAAv6B,EAAm/B,CAAC,EAAD,EAAK,oCAAL,CAAn/B,EAA+hC,CAAC,EAAD,EAAK,uEAAL,CAA/hC,EAA8mC,CAAC,EAAD,EAAK,qEAAL,CAA9mC,EAA2rC,CAAC,EAAD,EAAK,mEAAL,CAA3rC,EAAswC,CAAC,GAAD,EAAM,UAAN,CAAtwC,CAA5C,CAA73F;AAAosI,eAAKzF,EAAE,CAACH,QAAD,EAAW,eAAX,CAAF,CAA8B4F,IAA9B,CAAmC,OAAnC,EAA4C,CAAC,CAAC,EAAD,EAAK,yEAAL,CAAD,EAAkF,CAAC,EAAD,EAAK,8CAAL,CAAlF,EAAwI,CAAC,EAAD,EAAK,0BAAL,CAAxI,EAA0K,CAAC,EAAD,EAAK,sDAAL,CAA1K,EAAwO,CAAC,EAAD,EAAK,iEAAL,CAAxO,EAAiT,CAAC,EAAD,EAAK,+BAAL,CAAjT,EAAwV,CAAC,EAAD,EAAK,6CAAL,CAAxV,EAA6Y,CAAC,EAAD,EAAK,gFAAL,CAA7Y,EAAqe,CAAC,EAAD,EAAK,gEAAL,CAAre,EAA6iB,CAAC,EAAD,EAAK,gCAAL,CAA7iB,EAAqlB,CAAC,EAAD,EAAK,kGAAL,CAArlB,EAA+rB,CAAC,EAAD,EAAK,4GAAL,CAA/rB,EAAmzB,CAAC,EAAD,EAAK,uFAAL,CAAnzB,EAAk5B,CAAC,EAAD,EAAK,4FAAL,CAAl5B,EAAs/B,CAAC,EAAD,EAAK,gEAAL,CAAt/B,EAA8jC,CAAC,EAAD,EAAK,6FAAL,CAA9jC,EAAmqC,CAAC,EAAD,EAAK,+GAAL,CAAnqC,EAA0xC,CAAC,EAAD,EAAK,wDAAL,CAA1xC,EAA01C,CAAC,EAAD,EAAK,8EAAL,CAA11C,EAAg7C,CAAC,GAAD,EAAM,UAAN,CAAh7C,CAA5C;AAAzsI,SAAvB,CAAN,CAAwtLC,OAAxtL,EAA/C;AAEA1G,YAAI,CAACgD,GAAL,CAASrC,IAAT,EAAe,cAAf,EAA+B6B,yBAAyB,GAAG,SAASmE,aAAT,CAAuBzD,OAAvB,EAAgC;AACzF,cAAI0D,EAAJ;AAAA,cAAQjG,IAAI,GAAG,IAAf;AAAA,cAAqB4E,CAAC,GAAGzE,GAAzB;AAAA,cAA8B+F,aAAa,GAAG/F,GAA9C;AAAA,cAAmDkD,KAAK,GAAGlD,GAA3D;AAAA,cAAgE2D,MAAM,GAAG3D,GAAzE;AAAA,cAA8EgG,QAAQ,GAAGhG,GAAzF;AAGAyE,WAAC,GAAG,YAAYG,MAAZ,CAAmBxC,OAAnB,CAAJ;;AACA,cAAI3B,OAAO,CAACgE,CAAD,CAAX,EAAgB,CACf,CADD,MACO;AACL,mBAAOzE,GAAP;AACD;;AAAA;AACD+F,uBAAa,GAAGtB,CAAC,CAAC,KAAD,CAAD,CAAS,CAAT,EAAYV,KAAZ,EAAhB;AACAb,eAAK,GAAGrD,IAAI,CAACkC,UAAL,CAAgBuD,UAAhB,CAA2B,GAA3B,CAAR;AACA3B,gBAAM,IAAImC,EAAE,GAAGjG,IAAI,CAACoG,aAAL,CAAmB/C,KAAnB,EAA0BA,KAA1B,EAAiC,IAAjC,EAAuC6C,aAAvC,CAAL,EAA6DD,EAAE,KAAK9F,GAAP,IAAc8F,EAAE,IAAI,IAArB,GAA6B9F,GAA7B,GAAmCW,KAAK,CAACmF,EAAD,EAAK,MAAL,EAAa,EAAb,CAAxG,CAAN;AACAE,kBAAQ,GAAG,CAAC,KAAK,GAAL,GAAY5D,OAAZ,GAAuB,GAAxB,EAA6Bc,KAA7B,EAAoCS,MAApC,EAA4C9D,IAAI,CAACqG,kBAAL,CAAwBhD,KAAxB,EAA+B6C,aAA/B,CAA5C,EAA2FI,QAA3F,EAAX;AACA,iBAAOH,QAAQ,CAACI,KAAT,CAAe,KAAf,CAAP;AACD,SAdD,EAcG1E,yBAAyB,CAACgB,OAA1B,GAAoC,CAdvC;AAgBAxD,YAAI,CAACgD,GAAL,CAASrC,IAAT,EAAe,oBAAf,EAAqC8B,gCAAgC,GAAG,SAAS0E,mBAAT,CAA6BnD,KAA7B,EAAoC6C,aAApC,EAAmD;AACzH,cAAID,EAAJ;AAAA,cAAQQ,EAAR;AAAA,cAAYzG,IAAI,GAAG,IAAnB;AAAA,cAAyB0G,IAAI,GAAGvG,GAAhC;AAAA,cAAqCwG,IAAI,GAAGxG,GAA5C;AAAA,cAAiDyG,SAAS,GAAGzG,GAA7D;AAGAsG,YAAE,GAAGzG,IAAI,CAAC6G,WAAL,CAAiBxD,KAAjB,CAAL,EAA8B4C,EAAE,GAAG5G,IAAI,CAACyH,MAAL,CAAYL,EAAZ,CAAnC,EAAqDC,IAAI,GAAIT,EAAE,CAAC,CAAD,CAAF,IAAS,IAAT,GAAgB9F,GAAhB,GAAsB8F,EAAE,CAAC,CAAD,CAArF,EAA6FU,IAAI,GAAIV,EAAE,CAAC,CAAD,CAAF,IAAS,IAAT,GAAgB9F,GAAhB,GAAsB8F,EAAE,CAAC,CAAD,CAA7H,EAAoIQ,EAApI;;AACA,cAAI7F,OAAO,CAAE,YAAW;AAAC,gBAAIA,OAAO,CAAEgG,SAAS,GAAG/G,MAAM,CAACwD,KAAD,EAAQ6C,aAAR,CAApB,CAAX,EAAyD;AAChF,qBAAOU,SAAP;AACD,aAFwB,MAElB;AAEL,qBAAO/G,MAAM,CAACwD,KAAD,EAAQ,EAAR,CAAb;AACD;;AAAA;AAAE,mBAAOlD,GAAP;AAAa,WALJ,EAAD,CAAX,EAKsB;AACpB,gBAAIwG,IAAI,CAAC,KAAD,CAAJ,CAAYD,IAAZ,CAAJ,EAAuB;AACrB,qBAAO,OAAP;AACD,aAFD,MAEO;AACL,qBAAO,KAAK,GAAL,GAAYrG,EAAE,CAACH,QAAD,EAAW,iBAAX,CAAF,CAAgC6G,MAAhC,CAAuC/G,IAAI,CAACgH,WAAL,CAAiBL,IAAjB,EAAuBD,IAAvB,CAAvC,EAAqEO,QAArE,EAAZ,GAA+F,GAAtG;AACD;AACF,WAXD,MAWO,IAAIN,IAAI,CAAC,KAAD,CAAJ,CAAYD,IAAZ,CAAJ,EAAuB;AAC5B,mBAAO,QAAP;AACD,WAFM,MAEA;AACL,mBAAOrG,EAAE,CAACH,QAAD,EAAW,iBAAX,CAAF,CAAgC6G,MAAhC,CAAuC/G,IAAI,CAACgH,WAAL,CAAiBL,IAAjB,EAAuBD,IAAvB,CAAvC,EAAqEO,QAArE,EAAP;AACD;;AAAA;AACF,SArBD,EAqBGnF,gCAAgC,CAACe,OAAjC,GAA2C,CArB9C;AAuBAxD,YAAI,CAACgD,GAAL,CAASrC,IAAT,EAAe,aAAf,EAA8B+B,yBAAyB,GAAG,SAASmF,YAAT,CAAsB3B,IAAtB,EAA4B;AACpF,cAAIvF,IAAI,GAAG,IAAX;;AAEA,cAAIuF,IAAI,CAAC,KAAD,CAAJ,CAAY,GAAZ,CAAJ,EAAsB;AACpB,mBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;AACD,WAFD,MAEO;AACL,mBAAO,CAACjG,UAAU,CAACiG,IAAD,EAAO,EAAP,CAAV,CAAqBrB,KAArB,EAAD,EAA+BqB,IAAI,CAAC,IAAD,CAAJ,CAAW,EAAX,CAA/B,CAAP;AACD;AACF,SARD,EAQGxD,yBAAyB,CAACc,OAA1B,GAAoC,CARvC;AAUAxD,YAAI,CAACgD,GAAL,CAASrC,IAAT,EAAe,aAAf,EAA8BgC,yBAAyB,GAAG,SAASmF,YAAT,CAAsBT,IAAtB,EAA4BC,IAA5B,EAAkC;AAC1F,cAAI3G,IAAI,GAAG,IAAX;AAAA,cAAiBoH,SAAS,GAAGjH,GAA7B;;AAEA,cAAIS,OAAO,CAAE,YAAW;AAAC,gBAAIA,OAAO,CAAEwG,SAAS,GAAGV,IAAI,CAAC,KAAD,CAAJ,CAAY,CAAZ,CAAd,CAAX,EAA2C;AAClE,qBAAOC,IAAI,CAAC,KAAD,CAAJ,CAAY,CAAZ,CAAP;AACD,aAFwB,MAElB;AACL,qBAAOS,SAAP;AACD;;AAAA;AAAE,mBAAOjH,GAAP;AAAa,WAJJ,EAAD,CAAX,EAIsB;AACpB,mBAAO,GAAP;AACD,WAND,MAMO;AACL,mBAAOL,QAAQ,CAACC,SAAS,CAAC2G,IAAD,EAAO,EAAP,CAAV,EAAsBC,IAAtB,CAAf;AACD;AACF,SAZD,EAYG3E,yBAAyB,CAACa,OAA1B,GAAoC,CAZvC;AAaAxD,YAAI,CAAC8C,SAAL,CAAejC,QAAQ,CAAC,CAAD,CAAvB,EAA4B,iBAA5B,EAA+CE,GAAG,CAACC,EAAE,CAACH,QAAD,EAAW,WAAX,CAAH,EAA4B,YAA5B,CAAH,CAA6C4F,IAA7C,CAAkD,OAAlD,EAA2D,OAA3D,EAAoE,CAAC,CAAC5E,MAAM,CAAC,CAAD,EAAI,CAAJ,EAAO,KAAP,CAAP,EAAsB,IAAtB,CAAD,EAA8B,CAACA,MAAM,CAAC,EAAD,EAAK,EAAL,EAAS,KAAT,CAAP,EAAwB,QAAxB,CAA9B,EAAiE,CAACA,MAAM,CAAC,EAAD,EAAK,EAAL,EAAS,KAAT,CAAP,EAAwB,QAAxB,CAAjE,EAAoG,CAACA,MAAM,CAAC,EAAD,EAAK,EAAL,EAAS,KAAT,CAAP,EAAwB,IAAxB,CAApG,EAAmI,CAACA,MAAM,CAAC,EAAD,EAAK,EAAL,EAAS,KAAT,CAAP,EAAwB,IAAxB,CAAnI,EAAkK,CAACA,MAAM,CAAC,EAAD,EAAK,GAAL,EAAU,KAAV,CAAP,EAAyB,IAAzB,CAAlK,CAApE,CAA/C;AACA,eAAO7B,IAAI,CAAC8C,SAAL,CAAejC,QAAQ,CAAC,CAAD,CAAvB,EAA4B,QAA5B,EAAsCc,MAAM,CAAC,CAAC,MAAD,EAAS,MAAT,CAAD,EAAmB;AAAC,kBAAQX,EAAE,CAACH,QAAD,EAAW,iBAAX,CAAX;AAA0C,kBAAQE,GAAG,CAACC,EAAE,CAACH,QAAD,EAAW,WAAX,CAAH,EAA4B,YAA5B,CAAH,CAA6C4F,IAA7C,CAAkD,UAAlD,EAA8D,OAA9D,EAAuE,CAAC,CAAC5E,MAAM,CAAC,CAAD,EAAI,EAAJ,EAAQ,KAAR,CAAP,EAAuB,+BAAvB,CAAD,EAA0D,CAACA,MAAM,CAAC,EAAD,EAAK,EAAL,EAAS,KAAT,CAAP,EAAwB,oCAAxB,CAA1D,EAAyH,CAACA,MAAM,CAAC,EAAD,EAAK,EAAL,EAAS,KAAT,CAAP,EAAwB,gCAAxB,CAAzH,EAAoL,CAACA,MAAM,CAAC,EAAD,EAAK,EAAL,EAAS,KAAT,CAAP,EAAwB,mCAAxB,CAApL,EAAkP,CAACA,MAAM,CAAC,EAAD,EAAK,EAAL,EAAS,KAAT,CAAP,EAAwB,4BAAxB,CAAlP,EAAyS,CAACA,MAAM,CAAC,EAAD,EAAK,EAAL,EAAS,KAAT,CAAP,EAAwB,wDAAxB,CAAzS,EAA4X,CAACA,MAAM,CAAC,EAAD,EAAK,GAAL,EAAU,KAAV,CAAP,EAAyB,oFAAzB,CAA5X,CAAvE;AAAlD,SAAnB,CAAN,CAAioB6E,OAAjoB,EAAtC,CAAP;AACD,OArOD,EAqOG7F,QAAQ,CAAC,CAAD,CArOX,EAqOgBG,EAAE,CAACH,QAAD,EAAW,MAAX,CArOlB,EAqOsCA,QArOtC;AAsOD,KA3OD,EA2OGA,QAAQ,CAAC,CAAD,CA3OX,EA2OgBA,QA3OhB;AA4OD,GAjPM,CAiPJA,QAAQ,CAAC,CAAD,CAjPJ,EAiPSA,QAjPT,CAAP;AAkPD,CA7QD,EA6QGb,IA7QH,E","file":"default~Warhammer4~index.js","sourcesContent":["require('./../opal');\n\n/* Generated by Opal 1.1.1 */\n(function(Opal) {\n  function $rb_divide(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs / rhs : lhs['$/'](rhs);\n  }\n  function $rb_minus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);\n  }\n  function $rb_le(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs <= rhs : lhs['$<='](rhs);\n  }\n  function $rb_lt(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);\n  }\n  function $rb_ge(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs >= rhs : lhs['$>='](rhs);\n  }\n  function $rb_gt(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);\n  }\n  function $rb_plus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);\n  }\n  function $rb_times(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs * rhs : lhs['$*'](rhs);\n  }\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $klass = Opal.klass, $send2 = Opal.send2, $truthy = Opal.truthy, $send = Opal.send, $hash2 = Opal.hash2, $range = Opal.range;\n\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'GameSystem');\n\n      var $nesting = [self].concat($parent_nesting);\n\n      (function($base, $super, $parent_nesting) {\n        var self = $klass($base, $super, 'Warhammer4');\n\n        var $nesting = [self].concat($parent_nesting), $Warhammer4_initialize$1, $Warhammer4_eval_game_system_specific_command$2, $Warhammer4_result_1d100$3, $Warhammer4_result_detail$4, $Warhammer4_roll_critical_table$5, $Warhammer4_roll_attack$9, $Warhammer4_additional_result$10, $Warhammer4_split_d100$11, $Warhammer4_merge_d100$12;\n\n        self.$$prototype.randomizer = nil;\n        \n        Opal.const_set($nesting[0], 'ID', \"Warhammer4\");\n        Opal.const_set($nesting[0], 'NAME', \"ウォーハンマーRPG第4版\");\n        Opal.const_set($nesting[0], 'SORT_KEY', \"うおおはんまあ4\");\n        Opal.const_set($nesting[0], 'HELP_MESSAGE', \"\" + \"■ クリティカル表 (whctH, whctA, whctB, whctL, whctHU, whctAU, whctBU, whctLU)\\n\" + \"  \\\"WH部位 頑健ボーナス以下フラグ\\\"の形で指定します。\\n\" + \"  部位は「H(頭部)」「A(腕)」「B(胴体)」「L(足)」の４カ所です。\\n\" + \"  頑健ボーナスフラグは頑健ボーナス以下のダメージの時にUをつけます。\\n\" + \"  例）whctH whctAU WHCTL\\n\" + \"\\n\" + \"■ 命中部位表 (WHLT)\\n\" + \"  命中部位をランダムに決定します。(クリティカル用)\\n\" + \"\\n\" + \"■ やっちまった！表 (WHFT)\\n\" + \"　やっちまった！表をロールして、結果を表示します。\\n\" + \"\\n\" + \"■ 命中判定 (WHx)\\n\" + \"  \\\"WH(命中値)\\\"の形で指定します。\\n\" + \"  命中判定を行って、クリティカルかファンブルでなければ部位も表示します。\\n\" + \"  例）wh60　　wh(43-20)\\n\");\n        self.$register_prefix(\"WH\");\n        \n        Opal.def(self, '$initialize', $Warhammer4_initialize$1 = function $$initialize(command) {\n          var $iter = $Warhammer4_initialize$1.$$p, $yield = $iter || nil, self = this;\n\n          if ($iter) $Warhammer4_initialize$1.$$p = null;\n          \n          $send2(self, Opal.find_super_dispatcher(self, 'initialize', $Warhammer4_initialize$1, false, true), 'initialize', [command], null);\n          return (self.round_type = $$$($$($nesting, 'RoundType'), 'CEIL'));\n        }, $Warhammer4_initialize$1.$$arity = 1);\n        \n        Opal.def(self, '$eval_game_system_specific_command', $Warhammer4_eval_game_system_specific_command$2 = function $$eval_game_system_specific_command(command) {\n          var self = this, $ret_or_1 = nil, $ret_or_2 = nil;\n\n          if ($truthy(($ret_or_1 = (function() {if ($truthy(($ret_or_2 = self.$roll_critical_table(command)))) {\n            return $ret_or_2\n          } else {\n            return self.$roll_attack(command)\n          }; return nil; })()))) {\n            return $ret_or_1\n          } else {\n            return self.$roll_tables(command, $$($nesting, 'TABLES'))\n          }\n        }, $Warhammer4_eval_game_system_specific_command$2.$$arity = 1);\n        \n        Opal.def(self, '$result_1d100', $Warhammer4_result_1d100$3 = function $$result_1d100(total, _dice_total, cmp_op, target) {\n          var self = this, t10 = nil, d10 = nil, sl = nil, $ret_or_3 = nil, $ret_or_4 = nil, result = nil, sl_text = nil, $writer = nil;\n\n          \n          if (target['$=='](\"?\")) {\n            return $$($nesting, 'Result').$nothing()};\n          if (cmp_op['$=='](\"<=\")) {\n          } else {\n            return nil\n          };\n          t10 = $rb_divide(total, 10).$to_i();\n          d10 = $rb_divide(target, 10).$to_i();\n          sl = $rb_minus(d10, t10);\n          if ($truthy((function() {if ($truthy(($ret_or_3 = $rb_le(total, 5)))) {\n            return $rb_lt(sl, 1)\n          } else {\n            return $ret_or_3\n          }; return nil; })())) {\n            sl = 1\n          } else if ($truthy((function() {if ($truthy(($ret_or_4 = $rb_ge(total, 96)))) {\n            return $rb_gt(sl, -1)\n          } else {\n            return $ret_or_4\n          }; return nil; })())) {\n            sl = -1};\n          result = (function() {if ($truthy($rb_le(total, 5))) {\n            return $$($nesting, 'Result').$success(\"自動成功\")\n          } else if ($truthy($rb_ge(total, 96))) {\n            return $$($nesting, 'Result').$failure(\"自動失敗\")\n          } else if ($truthy($rb_le(total, target))) {\n            return $$($nesting, 'Result').$success(\"成功\")\n          } else {\n            return $$($nesting, 'Result').$failure(\"失敗\")\n          }; return nil; })();\n          sl_text = self.$format(\"(SL%+d)\", sl);\n          \n          $writer = [$rb_plus(result.$text(), \"\" + (sl_text) + \" ＞ \" + (self.$result_detail(sl, total, target)))];\n          $send(result, 'text=', Opal.to_a($writer));\n          $writer[$rb_minus($writer[\"length\"], 1)];;\n          return result;\n        }, $Warhammer4_result_1d100$3.$$arity = 4);\n        self.$private();\n        \n        Opal.def(self, '$result_detail', $Warhammer4_result_detail$4 = function $$result_detail(sl, total, target) {\n          var self = this;\n\n          if (sl['$=='](0)) {\n            if ($truthy($rb_le(total, 5))) {\n              return \"小成功\"\n            } else if ($truthy($rb_ge(total, 96))) {\n              return \"小失敗\"\n            } else if ($truthy($rb_le(total, target))) {\n              return \"小成功\"\n            } else {\n              return \"小失敗\"\n            }\n          } else if ($truthy($rb_ge(sl, 6))) {\n            return \"超大成功\"\n          } else if ($truthy($rb_ge(sl, 4))) {\n            return \"大成功\"\n          } else if ($truthy($rb_ge(sl, 2))) {\n            return \"成功\"\n          } else if ($truthy($rb_gt(sl, 0))) {\n            return \"小成功\"\n          } else if ($truthy($rb_ge(sl, -1))) {\n            return \"小失敗\"\n          } else if ($truthy($rb_ge(sl, -3))) {\n            return \"失敗\"\n          } else if ($truthy($rb_ge(sl, -5))) {\n            return \"大失敗\"\n          } else {\n            return \"超大失敗\"\n          }\n        }, $Warhammer4_result_detail$4.$$arity = 3);\n        \n        Opal.def(self, '$roll_critical_table', $Warhammer4_roll_critical_table$5 = function $$roll_critical_table(command) {\n          var self = this, m = nil, part = nil, under_ganken_bonus = nil;\n\n          \n          m = /^WHCT([HABTL])(U)?$/.$match(command);\n          if ($truthy(m)) {\n          } else {\n            return nil\n          };\n          part = m['$[]'](1);\n          if (part['$=='](\"T\")) {\n            part = \"B\"};\n          under_ganken_bonus = m['$[]'](2)['$nil?']()['$!']();\n          return $$($nesting, 'CRITICAL_TABLES')['$[]'](part).$roll(self.randomizer, under_ganken_bonus);\n        }, $Warhammer4_roll_critical_table$5.$$arity = 1);\n        (function($base, $super, $parent_nesting) {\n          var self = $klass($base, $super, 'CriticalTable');\n\n          var $nesting = [self].concat($parent_nesting), $CriticalTable_initialize$6, $CriticalTable_roll$7;\n\n          self.$$prototype.items = self.$$prototype.name = nil;\n          \n          \n          Opal.def(self, '$initialize', $CriticalTable_initialize$6 = function $$initialize(name, items) {\n            var self = this;\n\n            \n            self.name = name;\n            return (self.items = items);\n          }, $CriticalTable_initialize$6.$$arity = 2);\n          return (Opal.def(self, '$roll', $CriticalTable_roll$7 = function $$roll(randomizer, under_ganken_bonus) {\n            var $$8, self = this, dice = nil, chosen = nil;\n\n            \n            dice = randomizer.$roll_once(100);\n            if ($truthy(under_ganken_bonus)) {\n              dice = $rb_minus(dice, 20).$clamp(1, 100)};\n            chosen = $send(self.items, 'find', [], ($$8 = function(key, _){var self = $$8.$$s == null ? this : $$8.$$s;\n\n            \n              \n              if (key == null) {\n                key = nil;\n              };\n              \n              if (_ == null) {\n                _ = nil;\n              };\n              return $rb_ge(key, dice);}, $$8.$$s = self, $$8.$$arity = 2, $$8))['$[]'](1);\n            return \"\" + (self.name) + \"(\" + (dice) + \") ＞ \" + (chosen);\n          }, $CriticalTable_roll$7.$$arity = 2), nil) && 'roll';\n        })($nesting[0], null, $nesting);\n        Opal.const_set($nesting[0], 'CRITICAL_TABLES', $hash2([\"H\", \"A\", \"B\", \"L\"], {\"H\": $$($nesting, 'CriticalTable').$new(\"頭部CT表\", [[10, \"勲章となる傷：耐久値-1：「出血状態」1つを得る。社交系テストSL+1(累積なし)。\"], [20, \"小さな裂傷：耐久値-1：「出血状態」1つを得る。\"], [25, \"眼窩の負傷：耐久値-1：「目がくらんだ状態」1つを得る。\"], [30, \"耳朶への強打：耐久値-1：「耳鳴り状態」1つを得る。\"], [35, \"朦朧化打撃：耐久値-2：「朦朧状態」1つを得る。\"], [40, \"眼の周りの青あざ：耐久値-2：「目がくらんだ状態」2つを得る。\"], [45, \"耳朶の裂傷：耐久値-2：「出血状態」2つに加えて、「耳鳴り状態」1つを得る。\"], [50, \"額への一打：耐久値-2：「出血状態」2つに加えて「目がくらんだ状態」1つを得る。なお後者は「出血状態」を取り除いた後でなければ取り除けない。\"], [55, \"顎骨折：耐久値-3：「朦朧状態」2つを得る。さらに「骨折(軽度)」の負傷を得る。\"], [60, \"眼窩の大怪我：耐久値-3：「出血状態」2つを得る。さらに「目がくらんだ状態」1つも得て、こちらは「治療行為」を受けない限り回復できない。\"], [65, \"耳朶の大怪我：耐久値-3：片耳の聴力を失う。聴覚に関するテストに-20。この効果をもう一度受けた場合、永続的な聴覚喪失者となる。これは魔法でしか治療できない。\"], [70, \"鼻砕き：耐久値-3：「出血状態」2つを得る。「手強い(+0)」〈肉体抵抗〉テストを行い、失敗したら「朦朧状態」1つも得る。社交系テストに+1/-1。\"], [75, \"顎粉砕：耐久値-4：「朦朧状態」3つを得る。「手強い(+0)」〈肉体抵抗〉テストを行い、失敗したら「気絶状態」を得る。「骨折(重度)」の負傷を得る。\"], [80, \"脳震盪打撃：耐久値-4：「出血状態」2つと「耳鳴り状態」1つに加えて1d10の「朦朧状態」を得る。さらに1d10日間継続する「疲労状態」1つも得る。この「疲労状態」継続中に頭部への「致命的負傷」を再度得たなら、「普通(+20)」の〈肉体抵抗〉テストを行い、失敗したなら追加で「気絶状態」になる。\"], [85, \"口粉砕：耐久値-4：「出血状態」2つを得る。1d10本の歯が失われる。「身体欠損(容易)」を被る。\"], [90, \"耳が屑肉に：耐久値-4：「耳鳴り状態」3つに加えて「出血状態」2つを得る。片耳の機能を失う。「身体欠損(普通)」を被る。\"], [93, \"眼球破裂：耐久値-5：「目がくらんだ状態」3つと、「出血状態」2つ、「朦朧状態」1つを得る。片目の機能を失う。「身体欠損(難しい)」を被る。\"], [96, \"顔が化け物のように：耐久値-5：「出血状態」3つ「目がくらんだ状態」3つ、「朦朧状態」2つを得る。片目の機能を失い、鼻梁も失う。「身体欠損(多難)」を被る。\"], [99, \"顎が屑肉に：耐久値-5：「出血状態」4つと「朦朧状態」3つを得る。「超多難(-30)」な〈肉体抵抗〉テストを行い、失敗したら「気絶状態」になる。「骨折(重度)」の負傷を得て、舌と1d10本の歯を失う。「身体欠損(多難)」を被る。\"], [100, \"斬首刑さながらに：即死：\"]]), \"A\": $$($nesting, 'CriticalTable').$new(\"腕部CT表\", [[10, \"腕痺れ：耐久値-1：手に持っているものを落としてしまう。\"], [20, \"小さな裂傷：耐久値-1：「出血状態」1つを得る。\"], [25, \"捻挫：耐久値-1：「筋断裂(軽度)」の負傷を得る。\"], [30, \"ひどい腕痺れ：耐久値-2：手に持っているものを落としてしまい、その腕は1d10-【頑健力】ボーナスのラウンドに渡って使えなくなる。\"], [35, \"筋断裂：耐久値-2：「出血状態」1つと、「筋断裂(軽度)」の負傷を得る。\"], [40, \"手の出血：耐久値-2：「出血状態」1つを得る。その手で何かを握る「アクション」を行う場合、先立って「普通(+20)」の【器用度】テストを行い、失敗したら取り落としてしまう。\"], [45, \"肩の捻挫：耐久値-2：手に持っているものを落としてしまい、その腕は1d10ラウンドに渡って使えなくなる。\"], [50, \"大きな傷口：耐久値-3：「出血状態」2つを得る。傷口を縫う「手術」を受ける前に同じ腕にダメージを受けた場合、傷口が開き「出血状態」1つを追加で得る。\"], [55, \"単純骨折：耐久値-3：手に持っているものを落としてしまい、「骨折(軽度)」の負傷を得る。「難しい(-10)」〈肉体抵抗〉テストを行い、失敗したなら「朦朧状態」1つを得る。\"], [60, \"靱帯断裂：耐久値-3：手に持っているものを落としてしまい、「筋断裂(重度)」の負傷を得る。\"], [65, \"深手：耐久値-3：「出血状態」2つを得る。「朦朧状態」1つを得て、「筋断裂(軽度)」の負傷を得る。「多難(-20)」な〈肉体抵抗〉テストを行い、失敗したなら「気絶状態」になる。\"], [70, \"動脈破損：耐久値-4：「出血状態」4つを得る。「手術」を受ける前に同じ腕にダメージを受けるたびに「出血状態」2つを得る。\"], [75, \"肘粉砕：耐久値-4：手に持っているものを落としてしまい、「筋断裂(重度)」の負傷を得る。\"], [80, \"肩の脱臼：耐久値-4：「多難(-20)」な〈肉体抵抗〉テストを行い、失敗したなら「朦朧状態」1つを得て「伏せ状態」になる。手に持っているものを落としてしまう。その腕を使うことはできず、欠損したものとして扱う。さらに「治療行為」を受けるまでの間「朦朧状態」1つを得る。\"], [85, \"指切断：耐久値-4：「身体欠損(普通)」を被る。「出血状態」1つを得る。\"], [90, \"手の半切断：耐久値-5：指一本を失い、「身体欠損(多難)」を被る。「出血状態」2つと「朦朧状態」1つを得る。君が「治療行為」を受けるまでの以降の各ラウンドに指を一本ずつ失う。すべての指を失ったら、その手の機能を失い「身体欠損(難しい)」を得る。\"], [93, \"力こぶがズタズタに：耐久値-5：手に持っていたものを落とすとともに「筋断裂(重度)」の負傷を得て、「出血状態」2つと「朦朧状態」1つを得る。\"], [96, \"片手が屑肉同然に：耐久値-5：その手の機能を失い、「身体欠損(多難)」を被る。「出血状態」2つを得る。「多難(-20)」な〈肉体抵抗〉テストを行い、失敗したなら「気絶状態」になる。\"], [99, \"靱帯断裂：耐久値-5：腕は無用の長物と化す―「身体欠損(超多難)」を被る。「出血状態」3つ、「朦朧状態」1つを得て、「伏せ状態」になる。「多難(-20)」な〈肉体抵抗〉テストを行い、失敗したなら「気絶状態」になる。\"], [100, \"残酷な腕の喪失：即死：\"]]), \"B\": $$($nesting, 'CriticalTable').$new(\"胴体CT表\", [[10, \"ただのかすり傷だって！：耐久値-1：「出血状態」1つを得る。\"], [20, \"みぞおちへの一打：耐久値-1：「朦朧状態」1つを得る。「容易(+40)」な〈肉体抵抗〉テストを行い、失敗したなら「伏せ状態」になる。\"], [25, \"下腹部に直撃！：耐久値-1：「多難(-20)」な〈肉体抵抗〉テストを行い、失敗したなら「朦朧状態」3つを得る。\"], [30, \"背中を捻じる：耐久値-1：「筋断裂(軽度)」の負傷を得る。\"], [35, \"息ができない：耐久値-2：「朦朧状態」1つを得る。「普通(+20)」の〈肉体抵抗〉テストを行い、失敗したなら「伏せ状態」になる。また、1d10ラウンドに渡って「移動力」が半分になる。\"], [40, \"肋骨に青あざ：耐久値-2：1d10日間に渡って【敏捷力】に関連するテストに-10。\"], [45, \"鎖骨捻じれ：耐久値-2：左右どちらの鎖骨かランダムに決定する。そちらの手に持っている物を落としてしまい、1d10ラウンドに渡ってその腕は使用できない。\"], [50, \"裂傷：耐久値-2：「出血状態」2つを得る。\"], [55, \"肋骨にひびが：耐久値-3：「朦朧状態」1つを得る。また、「骨折(軽度)」の負傷を得る。\"], [60, \"大きな傷口：耐久値-3：「出血状態」3つを得る。「手術」を受けるまでの間、胴体に命中を受けるたびに追加で1つの「出血状態」を得る。\"], [65, \"激痛を伴う裂傷：耐久値-3：「出血状態」2つと「朦朧状態」1つを得る。「多難(-20)」な〈肉体抵抗〉テストを行い、失敗したなら「気絶状態」になる。またSL+4以上でテストに成功していない限り、金切り声を上げてしまう。\"], [70, \"動脈損傷：耐久値-3：「出血状態」4つを得る。「手術」を受けるまでの間、胴体に攻撃を受けるたびに追加で2つの「出血状態」を得る。\"], [75, \"背筋断裂：耐久値-4：「筋断裂(重度)」の負傷を得る。\"], [80, \"股関節骨折：耐久値-4：「朦朧状態」1つを得る。「手強い(+0)」〈肉体抵抗〉テストを行い、失敗したなら「伏せ状態」にもなる。「骨折(軽度)」の負傷を得る。\"], [85, \"胸郭の大怪我：耐久値-4：「出血状態」4つを得る。「手術」を受けるまでの間、胴体に命中を受けるたびに追加で2つの「出血状態」を得る。\"], [90, \"内臓の損傷：耐久値-4：「膿み傷」に罹患し、「出血状態」2つを得る。\"], [93, \"胸郭粉砕：耐久値-5：「朦朧状態」1つを得る。これは「治療行為」を受けない限り取り除くことは出来ない。さらに「骨折(重度)」の負傷を得る。\"], [96, \"鎖骨粉砕：耐久値-5：「気絶状態」になる。これは「治療行為」を受けない限り取り除くことは出来ない。さらに「骨折(重度)」の負傷を得る。\"], [99, \"内臓出血：耐久値-5：「出血状態」1つを得る。これは「手術」を受けない限り取り除くことは出来ない。さらに「血液腐れ病」に罹患する。\"], [100, \"胴部両断：即死：\"]]), \"L\": $$($nesting, 'CriticalTable').$new(\"脚部CT表\", [[10, \"爪先をぶつける：耐久値-1：「普通(+20)」の〈肉体抵抗〉テストを行い、失敗したなら次のターンの終了時まで【敏捷力】に関するテストに-10。\"], [20, \"足首の捻挫：耐久値-1：以降1d10ラウンドに渡って【敏捷力】に関連するテストに-10。\"], [25, \"小さな裂傷：耐久値-1：「出血状態」1つを得る。\"], [30, \"足がかりを失う：耐久値-1：「手強い(+0)」〈肉体抵抗〉テストを行い、失敗したなら「伏せ状態」になる。\"], [35, \"太腿への打撃：耐久値-2：「出血状態」1つを得て「普通(+20)」の〈肉体抵抗〉テストを行い、失敗したなら「伏せ状態」になる。\"], [40, \"足首の筋断裂：耐久値-2：「筋断裂(軽度)」の負傷を得る。\"], [45, \"膝の捻挫：耐久値-2：以降1d10ラウンドに渡って【敏捷力】に関連するテストに-20。\"], [50, \"爪先のひどい裂傷：耐久値-2：「出血状態」1つを得る。「手強い(+0)」〈肉体抵抗〉テストを行い、失敗したなら片方の爪先を失う―「身体欠損(普通)」を被る。\"], [55, \"ひどい裂傷：耐久値-3：「出血状態」2つを得る。「手強い(+0)」〈肉体抵抗〉テストを行い、失敗したなら「伏せ状態」になる。\"], [60, \"膝のひどい捻挫：耐久値-3：「筋断裂(重度)」の負傷を得る。\"], [65, \"脚への痛打：耐久値-3：「伏せ状態」に加えて「出血状態」2つを得て、「骨折(軽度)」の負傷を得る。さらに「多難(-20)」な〈肉体抵抗〉テストを行い、失敗したなら「朦朧状態」1つを追加で得る。\"], [70, \"太腿への深手：耐久値-3：「出血状態」3つを得る。「手強い(+0)」〈肉体抵抗〉テストを行い、失敗したなら「伏せ状態」になる。「手術」を受けるまでの間、この脚に命中を受けるたびに、追加で1つの「出血状態」を得る。\"], [75, \"靱帯断裂：耐久値-4：「伏せ状態」に加えて「朦朧状態」1つを得る。「多難(-20)」な〈肉体抵抗〉テストを行い、失敗したなら「気絶状態」になる。君のその脚は使えなくなる。\"], [80, \"脛への深手：耐久値-4：敵の武器が君の膝下に当たり、骨に食い込んで腱を切断する。「朦朧状態」1つを得て、「伏せ状態」になる。さらに「筋断裂(重度)」と「骨折(軽度)」の負傷を得る。\"], [85, \"膝粉砕：耐久値-4：「出血状態」1つと「朦朧状態」1つを得ることに加えて、「伏せ状態」になる。「骨折(重度)」の負傷を得る。\"], [90, \"膝関節脱臼：耐久値-4：「伏せ状態」になる。「多難(-20)」な〈肉体抵抗〉テストを行い、失敗したなら「朦朧状態」1つを得る。これは「治療行為」を受けない限り取り除くことができない。\"], [93, \"脚粉砕：耐久値-5：「普通(+20)」の〈肉体抵抗〉テストを行い、失敗したなら「伏せ状態」を得て、足の指1本を失う。さら、SLが-1あるごとに追加で1つの足指を失う―「身体欠損(普通)」を被る。「出血状態」2つを得る。\"], [96, \"足切断：耐久値-5：「身体欠損(多難)」を被る。「出血状態」3つと「朦朧状態」2つを得て「伏せ状態」になる。\"], [99, \"アキレス腱切断：耐久値-5：苦痛に金切り声を上げながら倒れる。「出血状態」2つと「朦朧状態」2つを得て「伏せ状態」になる。「身体欠損(超多難)」を被る。\"], [100, \"骨盤粉砕：即死：\"]])}).$freeze());\n        \n        Opal.def(self, '$roll_attack', $Warhammer4_roll_attack$9 = function $$roll_attack(command) {\n          var $a, self = this, m = nil, target_number = nil, total = nil, result = nil, sequence = nil;\n\n          \n          m = /^WH(\\d+)$/.$match(command);\n          if ($truthy(m)) {\n          } else {\n            return nil\n          };\n          target_number = m['$[]'](1).$to_i();\n          total = self.randomizer.$roll_once(100);\n          result = ($a = self.$result_1d100(total, total, \"<=\", target_number), ($a === nil || $a == null) ? nil : $send($a, 'text', []));\n          sequence = [\"\" + \"(\" + (command) + \")\", total, result, self.$additional_result(total, target_number)].$compact();\n          return sequence.$join(\" ＞ \");\n        }, $Warhammer4_roll_attack$9.$$arity = 1);\n        \n        Opal.def(self, '$additional_result', $Warhammer4_additional_result$10 = function $$additional_result(total, target_number) {\n          var $a, $b, self = this, tens = nil, ones = nil, $ret_or_5 = nil;\n\n          \n          $b = self.$split_d100(total), $a = Opal.to_ary($b), (tens = ($a[0] == null ? nil : $a[0])), (ones = ($a[1] == null ? nil : $a[1])), $b;\n          if ($truthy((function() {if ($truthy(($ret_or_5 = $rb_gt(total, target_number)))) {\n            return $ret_or_5\n          } else {\n            \n            return $rb_gt(total, 95);\n          }; return nil; })())) {\n            if (ones['$=='](tens)) {\n              return \"ファンブル\"\n            } else {\n              return \"\" + \"(\" + ($$($nesting, 'HIT_PARTS_TABLE').$fetch(self.$merge_d100(ones, tens)).$content()) + \")\"\n            }\n          } else if (ones['$=='](tens)) {\n            return \"クリティカル\"\n          } else {\n            return $$($nesting, 'HIT_PARTS_TABLE').$fetch(self.$merge_d100(ones, tens)).$content()\n          };\n        }, $Warhammer4_additional_result$10.$$arity = 2);\n        \n        Opal.def(self, '$split_d100', $Warhammer4_split_d100$11 = function $$split_d100(dice) {\n          var self = this;\n\n          if (dice['$=='](100)) {\n            return [0, 0]\n          } else {\n            return [$rb_divide(dice, 10).$to_i(), dice['$%'](10)]\n          }\n        }, $Warhammer4_split_d100$11.$$arity = 1);\n        \n        Opal.def(self, '$merge_d100', $Warhammer4_merge_d100$12 = function $$merge_d100(tens, ones) {\n          var self = this, $ret_or_6 = nil;\n\n          if ($truthy((function() {if ($truthy(($ret_or_6 = tens['$=='](0)))) {\n            return ones['$=='](0)\n          } else {\n            return $ret_or_6\n          }; return nil; })())) {\n            return 100\n          } else {\n            return $rb_plus($rb_times(tens, 10), ones)\n          }\n        }, $Warhammer4_merge_d100$12.$$arity = 2);\n        Opal.const_set($nesting[0], 'HIT_PARTS_TABLE', $$$($$($nesting, 'DiceTable'), 'RangeTable').$new(\"命中部位表\", \"1D100\", [[$range(1, 9, false), \"頭部\"], [$range(10, 24, false), \"左腕(逆腕)\"], [$range(25, 44, false), \"右腕(利腕)\"], [$range(45, 79, false), \"胴体\"], [$range(80, 89, false), \"左脚\"], [$range(90, 100, false), \"右脚\"]]));\n        return Opal.const_set($nesting[0], 'TABLES', $hash2([\"WHLT\", \"WHFT\"], {\"WHLT\": $$($nesting, 'HIT_PARTS_TABLE'), \"WHFT\": $$$($$($nesting, 'DiceTable'), 'RangeTable').$new(\"やっちまった！表\", \"1D100\", [[$range(1, 20, false), \"君は自分の体の一部に当ててしまった。「耐久度」1点を失う。\"], [$range(21, 40, false), \"君の武器が1ダメージを受ける。次のラウンドの行動順が一番最後になる。\"], [$range(41, 60, false), \"君は身体動作の目算を誤る。次のラウンドのアクションに-10。\"], [$range(61, 70, false), \"君はひどく躓きバランスを回復するのに手間取る。次の「移動」を失う。\"], [$range(71, 80, false), \"君は武器を取り回しを誤る。次の「アクション」を失う。\"], [$range(81, 90, false), \"君は筋を違えるか、足首をひねってしまう。「筋断裂(軽度)」の負傷を得る。「致命的負傷」としてカウントされる。\"], [$range(91, 100, false), \"君は射程内のランダムな味方を攻撃してしまう。命中判定の出目の1の位をSLとして用いること。攻撃可能な味方が居ない場合は、自己を攻撃してしまい「朦朧状態」1つを得る。\"]])}).$freeze());\n      })($nesting[0], $$($nesting, 'Base'), $nesting)\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting)\n})(Opal);\n"],"sourceRoot":"webpack:///"}