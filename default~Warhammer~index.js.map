{"version":3,"sources":["./node_modules/bcdice/lib/bcdice/game_system/Warhammer.js"],"names":["require","Opal","$rb_le","lhs","rhs","$rb_divide","$rb_minus","$rb_gt","$rb_lt","$rb_times","$rb_plus","$rb_ge","self","top","$nesting","nil","$$$","$$","$module","module","$klass","klass","$send2","send2","$truthy","truthy","$send","send","$base","$parent_nesting","concat","$super","$Warhammer_initialize$1","$Warhammer_eval_game_system_specific_command$2","$Warhammer_result_1d100$3","$Warhammer_result_1d100_text$4","$Warhammer_getCriticalResult$5","$Warhammer_wh_atpos$6","$Warhammer_get_wh_atpos_message$8","$Warhammer_getAttackResult$10","$$prototype","randomizer","const_set","$register_prefix","def","$$initialize","command","$iter","$$p","$yield","find_super_dispatcher","round_type","$$arity","$$eval_game_system_specific_command","output_msg","$case","attackCommand","criticalCommand","$upcase","$last_match","$getAttackResult","$getCriticalResult","$$result_1d100","total","_dice_total","cmp_op","target","$nothing","$success","$to_i","$failure","$$result_1d100_text","dice_total","$a","result","$result_1d100","$$getCriticalResult","string","whh","wha","whb","whl","whw","criticalTable","partsWord","criticalValue","whpp","whppp","dice_now","crit_no","crit_num","resultText","output","$roll_once","$$wh_atpos","pos_num","pos_type","$$7","pos_2l","pos_2lw","pos_4l","pos_4la","pos_4lw","pos_b","wh_pos","pos_t","pos_i","$debug","$$s","$get_wh_atpos_message","$$get_wh_atpos_message","$$9","$brk","new_brk","$length","i","brk","$$brk","err","$v","$$getAttackResult","diff","total_n","$result_1d100_text","$wh_atpos"],"mappings":"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","file":"default~Warhammer~index.js","sourcesContent":["require('./../opal');\n\n/* Generated by Opal 1.1.1 */\n(function(Opal) {\n  function $rb_le(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs <= rhs : lhs['$<='](rhs);\n  }\n  function $rb_divide(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs / rhs : lhs['$/'](rhs);\n  }\n  function $rb_minus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);\n  }\n  function $rb_gt(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);\n  }\n  function $rb_lt(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);\n  }\n  function $rb_times(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs * rhs : lhs['$*'](rhs);\n  }\n  function $rb_plus(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);\n  }\n  function $rb_ge(lhs, rhs) {\n    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs >= rhs : lhs['$>='](rhs);\n  }\n  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$, $$ = Opal.$$, $module = Opal.module, $klass = Opal.klass, $send2 = Opal.send2, $truthy = Opal.truthy, $send = Opal.send;\n\n  return (function($base, $parent_nesting) {\n    var self = $module($base, 'BCDice');\n\n    var $nesting = [self].concat($parent_nesting);\n\n    (function($base, $parent_nesting) {\n      var self = $module($base, 'GameSystem');\n\n      var $nesting = [self].concat($parent_nesting);\n\n      (function($base, $super, $parent_nesting) {\n        var self = $klass($base, $super, 'Warhammer');\n\n        var $nesting = [self].concat($parent_nesting), $Warhammer_initialize$1, $Warhammer_eval_game_system_specific_command$2, $Warhammer_result_1d100$3, $Warhammer_result_1d100_text$4, $Warhammer_getCriticalResult$5, $Warhammer_wh_atpos$6, $Warhammer_get_wh_atpos_message$8, $Warhammer_getAttackResult$10;\n\n        self.$$prototype.randomizer = nil;\n        \n        Opal.const_set($nesting[0], 'ID', \"Warhammer\");\n        Opal.const_set($nesting[0], 'NAME', \"ウォーハンマー\");\n        Opal.const_set($nesting[0], 'SORT_KEY', \"うおおはんまあ\");\n        Opal.const_set($nesting[0], 'HELP_MESSAGE', \"\" + \"・クリティカル表(whHxx/whAxx/whBxx/whLxx)\\n\" + \"　\\\"WH部位 クリティカル値\\\"の形で指定します。部位は「H(頭部)」「A(腕)」「B(胴体)」「L(足)」の４カ所です。\\n\" + \"　例）whH10 whA5 WHL4\\n\" + \"・命中判定(WHx@t)\\n\" + \"　\\\"WH(命中値)@(種別)\\\"の形で指定します。\\n\" + \"　種別は脚の数を数字、翼が付いているものは「W」、手が付いているものは「H」で書きます。\\n\" + \"　「2H(二足)」「2W(有翼二足)」「4(四足)」「4H(半人四足)」「4W(有翼四足)」「W(鳥類)」となります。\\n\" + \"　命中判定を行って、当たれば部位も表示します。\\n\" + \"　なお、種別指定を省略すると「二足」、「@」だけにすると全種別の命中部位を表示します。(コマンドを忘れた時の対応です)\\n\" + \"　例）wh60　　wh43@4W　　WH65@\\n\");\n        self.$register_prefix(\"WH\");\n        \n        Opal.def(self, '$initialize', $Warhammer_initialize$1 = function $$initialize(command) {\n          var $iter = $Warhammer_initialize$1.$$p, $yield = $iter || nil, self = this;\n\n          if ($iter) $Warhammer_initialize$1.$$p = null;\n          \n          $send2(self, Opal.find_super_dispatcher(self, 'initialize', $Warhammer_initialize$1, false, true), 'initialize', [command], null);\n          return (self.round_type = $$$($$($nesting, 'RoundType'), 'CEIL'));\n        }, $Warhammer_initialize$1.$$arity = 1);\n        \n        Opal.def(self, '$eval_game_system_specific_command', $Warhammer_eval_game_system_specific_command$2 = function $$eval_game_system_specific_command(command) {\n          var self = this, output_msg = nil, $case = nil, attackCommand = nil, criticalCommand = nil;\n\n          \n          output_msg = nil;\n          $case = command.$upcase();\n          if (/^(WH\\d+(@[\\dWH]*)?)/i['$===']($case)) {\n          attackCommand = $$($nesting, 'Regexp').$last_match(1);\n          output_msg = self.$getAttackResult(attackCommand);}\n          else if (/^(WH[HABTLW]\\d+)/i['$===']($case)) {\n          criticalCommand = $$($nesting, 'Regexp').$last_match(1);\n          output_msg = self.$getCriticalResult(criticalCommand);};\n          return output_msg;\n        }, $Warhammer_eval_game_system_specific_command$2.$$arity = 1);\n        \n        Opal.def(self, '$result_1d100', $Warhammer_result_1d100$3 = function $$result_1d100(total, _dice_total, cmp_op, target) {\n          var self = this;\n\n          \n          if (target['$=='](\"?\")) {\n            return $$($nesting, 'Result').$nothing()};\n          if (cmp_op['$=='](\"<=\")) {\n          } else {\n            return nil\n          };\n          if ($truthy($rb_le(total, target))) {\n            return $$($nesting, 'Result').$success(\"\" + \"成功(成功度\" + ($rb_divide($rb_minus(target, total), 10).$to_i()) + \")\")\n          } else {\n            return $$($nesting, 'Result').$failure(\"\" + \"失敗(失敗度\" + ($rb_divide($rb_minus(total, target), 10).$to_i()) + \")\")\n          };\n        }, $Warhammer_result_1d100$3.$$arity = 4);\n        \n        Opal.def(self, '$result_1d100_text', $Warhammer_result_1d100_text$4 = function $$result_1d100_text(total, dice_total, cmp_op, target) {\n          var $a, self = this, result = nil;\n\n          \n          result = ($a = self.$result_1d100(total, dice_total, cmp_op, target), ($a === nil || $a == null) ? nil : $send($a, 'text', []));\n          if ($truthy(result['$nil?']())) {\n            return \"\"\n          } else {\n            return \"\" + \" ＞ \" + (result)\n          };\n        }, $Warhammer_result_1d100_text$4.$$arity = 4);\n        \n        Opal.def(self, '$getCriticalResult', $Warhammer_getCriticalResult$5 = function $$getCriticalResult(string) {\n          var self = this, whh = nil, wha = nil, whb = nil, whl = nil, whw = nil, criticalTable = nil, partsWord = nil, criticalValue = nil, whpp = nil, whppp = nil, $case = nil, dice_now = nil, crit_no = nil, crit_num = nil, resultText = nil, output = nil;\n\n          \n          whh = [\"01:打撃で状況が把握出来なくなる。次ターンは1回の半アクションしか行なえない。\", \"02:耳を強打された為、耳鳴りが酷く目眩がする。1Rに渡って一切のアクションを行なえない。\", \"03:打撃が頭皮を酷く傷つけた。【武器技術度】に-10%。治療を受けるまで継続。\", \"04:鎧が損傷し当該部位のAP-1。修理するには(職能:鎧鍛冶)テスト。鎧を着けていないなら1Rの間アクションを行なえない。\", \"05:転んで倒れ、頭がくらくらする。1Rに渡ってあらゆるテストに-30で、立ち上がるには起立アクションが必要。\", \"06:1d10R気絶。\", \"07:1d10分気絶。以後CTはサドンデス。\", \"08:顔がずたずたになって倒れ、以後無防備状態。治療を受けるまで毎Rの被害者のターン開始時に20%で死亡。以後CTはサドンデスを適用。【頑強】テストに失敗すると片方の視力を失う。\", \"09:凄まじい打撃により頭蓋骨が粉砕される。死は瞬時に訪れる。\", \"10:死亡する。いかに盛大に出血し、どのような死に様を見せたのかを説明してもよい。\"];\n          wha = [\"01:手に握っていたものを落とす。盾はくくりつけられている為、影響なし。\", \"02:打撃で腕が痺れ、1Rの間使えなくなる。\", \"03:手の機能が失われ、治療を受けるまで回復できない。手で握っていたもの(盾を除く)は落ちる。\", \"04:鎧が損傷する。当該部位のAP-1。修理するには(職能:鎧鍛冶)テスト。鎧を着けていないなら腕が痺れ、1Rの間使えなくなる。\", \"05:腕の機能が失われ、治療を受けるまで回復できない。手で握っていたもの(盾を除く)は落ちる。\", \"06:腕が砕かれる。手で握っていたもの(盾を除く)は落ちる。出血がひどく、治療を受けるまで毎Rの被害者のターン開始時に20%で死亡。以後CTはサドンデスを適用。\", \"07:手首から先が血まみれの残骸と化す。手で握っていたもの(盾を除く)は落ちる。出血がひどく、治療を受けるまで毎Rの被害者のターン開始時に20%で死亡。以後CTはサドンデスを適用。【頑健】テストに失敗すると手の機能を失う。\", \"08:腕は血まみれの肉塊がぶら下がっている状態になる。手で握っていたもの(盾を除く)は落ちる。治療を受けるまで毎Rの被害者のターン開始時に20%で死亡。以後CTはサドンデスを適用。【頑健】テストに失敗すると肘から先の機能を失う。\", \"09:大動脈に傷が及んだ。コンマ数秒の内に損傷した肩から血を噴出して倒れる。ショックと失血により、ほぼ即死する。\", \"10:死亡する。いかに盛大に出血し、どのような死に様を見せたのかを説明してもよい。\"];\n          whb = [\"01:打撃で息が詰まる。1Rの間、キャラクターの全てのテストや攻撃に-20%。\", \"02:股間への一撃。苦痛のあまり、1Rに渡って一切のアクションを行なえない。\", \"03:打撃で肋骨がぐちゃぐちゃになる。以後治療を受けるまでの間、【武器技術度】に-10%。\", \"04:鎧が損傷する。当該部位のAP-1。修理するには(職能:鎧鍛冶)テスト。鎧を着けていないなら股間への一撃、1Rに渡って一切のアクションを行なえない。\", \"05:転んで倒れ、息が詰まって悶絶する。1Rに渡ってあらゆるテストに-30の修正、立ち上がるには起立アクションが必要。\", \"06:1d10R気絶。\", \"07:ひどい内出血が起こり、無防備状態。出血がひどく、治療を受けるまで毎Rの被害者のターン開始時に20%で死亡。\", \"08:脊髄が粉砕されて倒れ、以後治療を受けるまで無防備状態。以後CTはサドンデスを適用。【頑強】テストに失敗すると腰から下が不随になる。\", \"09:凄まじい打撃により複数の臓器が破裂し、死は数秒のうちに訪れる。\", \"10:死亡する。いかに盛大に出血し、どのような死に様を見せたのかを説明してもよい。\"];\n          whl = [\"01:よろめく。次のターン、1回の半アクションしか行なえない。\", \"02:脚が痺れる。1Rに渡って【移動】は半減し、脚に関連する【敏捷】テストに-20%。回避が出来なくなる。\", \"03:脚の機能が失われ、治療を受けるまで回復しない。【移動】は半減し、脚に関連する【敏捷】テストに-20%。回避が出来なくなる。\", \"04:鎧が損傷する。当該部位のAP-1。修理するには(職能:鎧鍛冶)テスト。鎧を着けていないなら脚が痺れる、1Rに渡って【移動】は半減し、脚に関連する【敏捷】テストに-20%、回避不可になる。\", \"05:転んで倒れ、頭がくらくらする。1Rに渡ってあらゆるテストに-30の修正、立ち上がるには起立アクションが必要。\", \"06:脚が砕かれ、無防備状態。出血がひどく、治療を受けるまで毎Rの被害者のターン開始時に20%で死亡。以後CTはサドンデスを適用。\", \"07:脚は血まみれの残骸と化し、無防備状態になる。治療を受けるまで毎Rの被害者のターン開始時に20%で死亡。以後CTはサドンデスを適用。【頑強】テストに失敗すると足首から先を失う。\", \"08:脚は血まみれの肉塊がぶらさがっている状態。以後無防備状態。治療を受けるまで毎Rの被害者のターン開始時に20%で死亡。以後CTはサドンデスを適用。【頑強】テストに失敗すると膝から下を失う。\", \"09:大動脈に傷が及ぶ。コンマ数秒の内に脚の残骸から血を噴出して倒れ、ショックと出血で死は瞬時に訪れる。\", \"10:死亡する。いかに盛大に出血し、どのような死に様を見せたのかを説明してもよい。\"];\n          whw = [\"01:軽打。1ラウンドに渡って、あらゆるテストに-10％。\", \"02:かすり傷。+10％の【敏捷】テストを行い、失敗なら直ちに高度を1段階失う。地上にいるクリーチャーは、次のターンには飛び立てない。\", \"03:損傷する。【飛行移動力】が2点低下する。-10％の【敏捷】テストを行い、失敗なら直ちに高度を1段階失う。地上にいるクリーチャーは、次のターンには飛び立てない。\", \"04:酷く損傷する。【飛行移動力】が4点低下する。-30％の【敏捷】テストを行い、失敗なら直ちに高度を1段階失う。地上にいるクリーチャーは、1d10ターンが経過するまで飛び立てない。\", \"05:翼が使えなくなる。【飛行移動力】が0に低下する。飛行中のものは落下し、高度に応じたダメージを受ける。地上にいるクリーチャーは、怪我が癒えるまで飛び立てない。\", \"06:翼の付け根に傷が開く。【飛行移動力】が0に低下する。飛行中のものは落下し、高度に応じたダメージを受ける。地上にいるクリーチャーは、怪我が癒えるまで飛び立てない。治療を受けるまで毎R被害者のターン開始時に20％の確率で死亡。以後CTはサドンデスを適用。\", \"07:翼は血まみれの残骸と化し、無防備状態になる。【飛行移動力】が0に低下する。飛行中のものは落下し、高度に応じたダメージを受ける。地上にいるクリーチャーは、怪我が癒えるまで飛び立てない。治療を受けるまで毎R被害者のターン開始時に20％の確率で死亡。以後CTはサドンデスを適用。【頑強】テストに失敗すると飛行能力を失う。\", \"08:翼が千切れてバラバラになり、無防備状態になる。【飛行移動力】が0に低下する。飛行中のものは落下し、高度に応じたダメージを受ける。地上にいるクリーチャーは、怪我が癒えるまで飛び立てない。治療を受けるまで毎R被害者のターン開始時に20％の確率で死亡。以後CTはサドンデスを適用。飛行能力を失う。\", \"09:大動脈が切断された。コンマ数秒の内に血を噴き上げてくずおれる、ショックと出血で死は瞬時に訪れる。\", \"10:死亡する。いかに盛大に出血し、どのような死に様を見せたのかを説明してもよい。\"];\n          criticalTable = [5, 7, 9, 10, 10, 10, 10, 10, 10, 10, 5, 6, 8, 9, 10, 10, 10, 10, 10, 10, 4, 6, 8, 9, 9, 10, 10, 10, 10, 10, 4, 5, 7, 8, 9, 9, 10, 10, 10, 10, 3, 5, 7, 8, 8, 9, 9, 10, 10, 10, 3, 4, 6, 7, 8, 8, 9, 9, 10, 10, 2, 4, 6, 7, 7, 8, 8, 9, 9, 10, 2, 3, 5, 6, 7, 7, 8, 8, 9, 9, 1, 3, 5, 6, 6, 7, 7, 8, 8, 9, 1, 2, 4, 5, 6, 6, 7, 7, 8, 8];\n          if ($truthy(/WH([HABTLW])(\\d+)/['$=~'](string))) {\n          } else {\n            return \"1\"\n          };\n          partsWord = $$($nesting, 'Regexp').$last_match(1);\n          criticalValue = $$($nesting, 'Regexp').$last_match(2).$to_i();\n          if ($truthy($rb_gt(criticalValue, 10))) {\n            criticalValue = 10};\n          if ($truthy($rb_lt(criticalValue, 1))) {\n            criticalValue = 1};\n          whpp = \"\";\n          whppp = \"\";\n          $case = partsWord;\n          if (/H/i['$===']($case)) {\n          whpp = \"頭部\";\n          whppp = whh;}\n          else if (/A/i['$===']($case)) {\n          whpp = \"腕部\";\n          whppp = wha;}\n          else if (/[TB]/i['$===']($case)) {\n          whpp = \"胴体\";\n          whppp = whb;}\n          else if (/L/i['$===']($case)) {\n          whpp = \"脚部\";\n          whppp = whl;}\n          else if (/W/i['$===']($case)) {\n          whpp = \"翼部\";\n          whppp = whw;};\n          dice_now = self.randomizer.$roll_once(100);\n          crit_no = $rb_times($rb_divide($rb_minus(dice_now, 1), 10).$to_i(), 10);\n          crit_num = criticalTable['$[]']($rb_minus($rb_plus(crit_no, criticalValue), 1));\n          resultText = whppp['$[]']($rb_minus(crit_num, 1));\n          if ($truthy($rb_ge(crit_num, 5))) {\n            resultText = $rb_plus(resultText, \"サドンデス×\")\n          } else {\n            resultText = $rb_plus(resultText, \"サドンデス○\")\n          };\n          output = \"\" + (whpp) + \"CT表(\" + (dice_now) + \"+\" + (criticalValue) + \") ＞ \" + (resultText);\n          return output;\n        }, $Warhammer_getCriticalResult$5.$$arity = 1);\n        \n        Opal.def(self, '$wh_atpos', $Warhammer_wh_atpos$6 = function $$wh_atpos(pos_num, pos_type) {\n          var $$7, self = this, pos_2l = nil, pos_2lw = nil, pos_4l = nil, pos_4la = nil, pos_4lw = nil, pos_b = nil, wh_pos = nil, pos_t = nil, $case = nil, output = nil, pos_i = nil;\n\n          \n          self.$debug(\"wh_atpos begin pos_type\", pos_type);\n          pos_2l = [\"二足\", 15, \"頭部\", 35, \"右腕\", 55, \"左腕\", 80, \"胴体\", 90, \"右脚\", 100, \"左脚\"];\n          pos_2lw = [\"有翼二足\", 15, \"頭部\", 25, \"右腕\", 35, \"左腕\", 45, \"右翼\", 55, \"左翼\", 80, \"胴体\", 90, \"右脚\", 100, \"左脚\"];\n          pos_4l = [\"四足\", 15, \"頭部\", 60, \"胴体\", 70, \"右前脚\", 80, \"左前脚\", 90, \"右後脚\", 100, \"左後脚\"];\n          pos_4la = [\"半人四足\", 10, \"頭部\", 20, \"右腕\", 30, \"左腕\", 60, \"胴体\", 70, \"右前脚\", 80, \"左前脚\", 90, \"右後脚\", 100, \"左後脚\"];\n          pos_4lw = [\"有翼四足\", 10, \"頭部\", 20, \"右翼\", 30, \"左翼\", 60, \"胴体\", 70, \"右前脚\", 80, \"左前脚\", 90, \"右後脚\", 100, \"左後脚\"];\n          pos_b = [\"鳥\", 15, \"頭部\", 35, \"右翼\", 55, \"左翼\", 80, \"胴体\", 90, \"右脚\", 100, \"左脚\"];\n          wh_pos = [pos_2l, pos_2lw, pos_4l, pos_4la, pos_4lw, pos_b];\n          pos_t = 0;\n          self.$debug(\"pos_type\", pos_type);\n          if ($truthy(pos_type['$!='](\"\"))) {\n            $case = pos_type;\n            if (/@(2W|W2)/i['$===']($case)) {pos_t = 1}\n            else if (/@(4W|W4)/i['$===']($case)) {pos_t = 4}\n            else if (/@(4H|H4)/i['$===']($case)) {pos_t = 3}\n            else if (/@4/i['$===']($case)) {pos_t = 2}\n            else if (/@W/i['$===']($case)) {pos_t = 5}\n            else {if ($truthy(/@(2H|H2|2)/i['$=~'](pos_type))) {\n            } else {\n              pos_t = -1\n            }}};\n          output = \"\";\n          self.$debug(\"pos_t\", pos_t);\n          if ($truthy($rb_lt(pos_t, 0))) {\n            $send(wh_pos, 'each', [], ($$7 = function(pos_i){var self = $$7.$$s == null ? this : $$7.$$s;\n\n            \n              \n              if (pos_i == null) {\n                pos_i = nil;\n              };\n              return (output = $rb_plus(output, self.$get_wh_atpos_message(pos_i, pos_num)));}, $$7.$$s = self, $$7.$$arity = 1, $$7))\n          } else {\n            \n            pos_i = wh_pos['$[]'](pos_t);\n            output = $rb_plus(output, self.$get_wh_atpos_message(pos_i, pos_num));\n          };\n          return output;\n        }, $Warhammer_wh_atpos$6.$$arity = 2);\n        \n        Opal.def(self, '$get_wh_atpos_message', $Warhammer_get_wh_atpos_message$8 = function $$get_wh_atpos_message(pos_i, pos_num) {\n          var $$9, self = this, output = nil;\n\n          \n          output = \"\";\n          output = $rb_plus(output, $rb_plus($rb_plus(\" \", pos_i['$[]'](0)), \":\"));\n          (function(){var $brk = Opal.new_brk(); try {return $send((1), 'step', [$rb_plus(pos_i.$length(), 1), 2], ($$9 = function(i){var self = $$9.$$s == null ? this : $$9.$$s;\n\n          \n            \n            if (i == null) {\n              i = nil;\n            };\n            if ($truthy($rb_le(pos_num, pos_i['$[]'](i)))) {\n              \n              output = $rb_plus(output, pos_i['$[]']($rb_plus(i, 1)));\n              \n              Opal.brk(nil, $brk);\n            } else {\n              return nil\n            };}, $$9.$$s = self, $$9.$$brk = $brk, $$9.$$arity = 1, $$9))\n          } catch (err) { if (err === $brk) { return err.$v } else { throw err } }})();\n          return output;\n        }, $Warhammer_get_wh_atpos_message$8.$$arity = 2);\n        return (Opal.def(self, '$getAttackResult', $Warhammer_getAttackResult$10 = function $$getAttackResult(string) {\n          var self = this, pos_type = nil, diff = nil, total_n = nil, output = nil, pos_num = nil;\n\n          \n          self.$debug(\"getAttackResult begin string\", string);\n          pos_type = \"\";\n          if ($truthy(/(.+)(@.*)/['$=~'](string))) {\n            \n            string = $$($nesting, 'Regexp').$last_match(1);\n            pos_type = $$($nesting, 'Regexp').$last_match(2);\n            self.$debug(\"pos_type\", pos_type);};\n          if ($truthy(/WH(\\d+)/i['$=~'](string))) {\n          } else {\n            return \"1\"\n          };\n          diff = $$($nesting, 'Regexp').$last_match(1).$to_i();\n          total_n = self.randomizer.$roll_once(100);\n          output = \"\" + \"(\" + (string) + \") ＞ \" + (total_n);\n          output = $rb_plus(output, self.$result_1d100_text(total_n, total_n, \"<=\", diff));\n          pos_num = $rb_plus($rb_times(total_n['$%'](10), 10), $rb_divide(total_n, 10).$to_i());\n          if ($truthy($rb_ge(total_n, 100))) {\n            pos_num = 100};\n          if ($truthy($rb_le(total_n, diff))) {\n            output = $rb_plus(output, self.$wh_atpos(pos_num, pos_type))};\n          return output;\n        }, $Warhammer_getAttackResult$10.$$arity = 1), nil) && 'getAttackResult';\n      })($nesting[0], $$($nesting, 'Base'), $nesting)\n    })($nesting[0], $nesting)\n  })($nesting[0], $nesting)\n})(Opal);\n"],"sourceRoot":"webpack:///"}